import{c as ge,j as e,u as ve,B as d,C as oe,F as yt,L as de,H as $,T as l,M as Kn,a as Yn,b as R,d as Qn,e as Xn,f as cn,g as dn,h as De,i as un,k as Ue,l as Z,m as hn,n as mn,V as x,o as h,S as Y,D as Le,I as Fe,p as G,q as g,r as b,s as er,t as tr,v as nr,w as ce,x as Ve,y as rr,z as A,A as S,E as pn,G as sr,J as Ne,K as Oe,N as ir,O as ye,P as ar,Q as ne,R as re,U as or,W as lr,X as gn,Y as fn,Z as cr,_ as dr,$ as ur}from"./chakra-Ba8SeCXL.js";import{e as hr,g as xn,u as mr,L as B,c as Pt,a as X,b as vt,f as pr,h as ae,B as gr}from"./vendor-BYoL5dE3.js";import{F as Se,S as fr}from"./forestry-BG1-YQoU.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var Ke={},Rt;function xr(){if(Rt)return Ke;Rt=1;var t=hr();return Ke.createRoot=t.createRoot,Ke.hydrateRoot=t.hydrateRoot,Ke}var jr=xr();const br=xn(jr),yr=ge({d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z",displayName:"CopyIcon"}),vr=ge({viewBox:"0 0 14 14",d:"M14,7.77 L14,6.17 L12.06,5.53 L11.61,4.44 L12.49,2.6 L11.36,1.47 L9.55,2.38 L8.46,1.93 L7.77,0.01 L6.17,0.01 L5.54,1.95 L4.43,2.4 L2.59,1.52 L1.46,2.65 L2.37,4.46 L1.92,5.55 L0,6.23 L0,7.82 L1.94,8.46 L2.39,9.55 L1.51,11.39 L2.64,12.52 L4.45,11.61 L5.54,12.06 L6.23,13.98 L7.82,13.98 L8.45,12.04 L9.56,11.59 L11.4,12.47 L12.53,11.34 L11.61,9.53 L12.08,8.44 L14,7.75 L14,7.77 Z M7,10 C5.34,10 4,8.66 4,7 C4,5.34 5.34,4 7,4 C8.66,4 10,5.34 10,7 C10,8.66 8.66,10 7,10 Z",displayName:"SettingsIcon"}),z=ge({displayName:"CheckCircleIcon",d:"M12,0A12,12,0,1,0,24,12,12.014,12.014,0,0,0,12,0Zm6.927,8.2-6.845,9.289a1.011,1.011,0,0,1-1.43.188L5.764,13.769a1,1,0,1,1,1.25-1.562l4.076,3.261,6.227-8.451A1,1,0,1,1,18.927,8.2Z"}),Sr=ge({d:"M19.5,9.5h-.75V6.75a6.75,6.75,0,0,0-13.5,0V9.5H4.5a2,2,0,0,0-2,2V22a2,2,0,0,0,2,2h15a2,2,0,0,0,2-2V11.5A2,2,0,0,0,19.5,9.5Zm-9.5,6a2,2,0,1,1,3,1.723V19.5a1,1,0,0,1-2,0V17.223A1.994,1.994,0,0,1,10,15.5ZM7.75,6.75a4.25,4.25,0,0,1,8.5,0V9a.5.5,0,0,1-.5.5H8.25a.5.5,0,0,1-.5-.5Z",displayName:"LockIcon"}),wr=ge({displayName:"ChevronDownIcon",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"}),Ae=ge({d:"M23.555,8.729a1.505,1.505,0,0,0-1.406-.98H16.062a.5.5,0,0,1-.472-.334L13.405,1.222a1.5,1.5,0,0,0-2.81,0l-.005.016L8.41,7.415a.5.5,0,0,1-.471.334H1.85A1.5,1.5,0,0,0,.887,10.4l5.184,4.3a.5.5,0,0,1,.155.543L4.048,21.774a1.5,1.5,0,0,0,2.31,1.684l5.346-3.92a.5.5,0,0,1,.591,0l5.344,3.919a1.5,1.5,0,0,0,2.312-1.683l-2.178-6.535a.5.5,0,0,1,.155-.543l5.194-4.306A1.5,1.5,0,0,0,23.555,8.729Z",displayName:"StarIcon"}),Ce=ge({d:"M12,0A12,12,0,1,0,24,12,12.013,12.013,0,0,0,12,0Zm.25,5a1.5,1.5,0,1,1-1.5,1.5A1.5,1.5,0,0,1,12.25,5ZM14.5,18.5h-4a1,1,0,0,1,0-2h.75a.25.25,0,0,0,.25-.25v-4.5a.25.25,0,0,0-.25-.25H10.5a1,1,0,0,1,0-2h1a2,2,0,0,1,2,2v4.75a.25.25,0,0,0,.25.25h.75a1,1,0,1,1,0,2Z"}),be=ge({d:"M11.983,0a12.206,12.206,0,0,0-8.51,3.653A11.8,11.8,0,0,0,0,12.207,11.779,11.779,0,0,0,11.8,24h.214A12.111,12.111,0,0,0,24,11.791h0A11.766,11.766,0,0,0,11.983,0ZM10.5,16.542a1.476,1.476,0,0,1,1.449-1.53h.027a1.527,1.527,0,0,1,1.523,1.47,1.475,1.475,0,0,1-1.449,1.53h-.027A1.529,1.529,0,0,1,10.5,16.542ZM11,12.5v-6a1,1,0,0,1,2,0v6a1,1,0,1,1-2,0Z",displayName:"WarningIcon"}),O=ge({viewBox:"0 0 14 14",path:e.jsx("g",{fill:"currentColor",children:e.jsx("polygon",{points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})})}),zr=()=>{const t=mr(),n=ve("white","gray.800"),r=ve("gray.200","gray.700"),s=a=>t.pathname===a,i={"Getting Started":[{label:"Quick Start",path:"/"},{label:"Why Forestry?",path:"/why"}],"Essential Features":[{label:"Basics",path:"/store"},{label:"Actions",path:"/actions"},{label:"With React",path:"/react"}],"Power Tools":[{label:"Validation",path:"/validation"},{label:"Schema",path:"/schemas"},{label:"Transactions",path:"/transactions"},{label:"RxJS / Immer",path:"/rxjs"}],"Practical Examples":[{label:"Overview",path:"/examples"},{label:"Todo App",path:"/examples/todo-app"},{label:"Shopping Cart",path:"/examples/shopping-cart"},{label:"Form Validation",path:"/examples/form-validation"},{label:"Transaction Demo",path:"/examples/transaction-demo"}],Reference:[{label:"API",path:"/api"},{label:"GitHub Source",path:"https://github.com/bingomanatee/wonderlandlabs-monorepo",external:!0}]};return e.jsx(d,{position:"fixed",top:0,left:0,right:0,zIndex:1e3,bg:n,borderBottom:"1px",borderColor:r,shadow:"sm",children:e.jsx(oe,{maxW:"container.xl",children:e.jsxs(yt,{alignItems:"center",justifyContent:"space-between",children:[e.jsx(de,{as:B,to:"/",_hover:{textDecoration:"none"},children:e.jsxs($,{spacing:2,children:[e.jsx(l,{fontSize:"2xl",fontWeight:"bold",color:"forest.600",children:"🌲"}),e.jsx(l,{fontSize:"xl",fontWeight:"bold",color:"gray.800",children:"Forestry 4.0"})]})}),e.jsx($,{spacing:8,children:Object.entries(i).map(([a,o])=>e.jsxs(Kn,{trigger:"hover",children:[e.jsx(Yn,{as:R,variant:"ghost",colorScheme:"green",_hover:{bg:"green.100"},_active:{bg:"green.200"},rightIcon:e.jsx(wr,{}),children:a}),e.jsx(Qn,{children:o.map(c=>e.jsx(Xn,{as:c.external?de:B,to:c.external?void 0:c.path,href:c.external?c.path:void 0,isExternal:c.external,bg:!c.external&&s(c.path)?"forest.50":"transparent",color:!c.external&&s(c.path)?"forest.600":"gray.700",fontWeight:!c.external&&s(c.path)?"semibold":"normal",_hover:{bg:!c.external&&s(c.path)?"forest.100":"gray.50"},children:c.label},c.path))})]},a))})]})})})};var ht={exports:{}},Vt;function Fr(){return Vt||(Vt=1,(function(t){var n=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var r=(function(s){var i=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,a=0,o={},c={manual:s.Prism&&s.Prism.manual,disableWorkerMessageHandler:s.Prism&&s.Prism.disableWorkerMessageHandler,util:{encode:function f(m){return m instanceof u?new u(m.type,f(m.content),m.alias):Array.isArray(m)?m.map(f):m.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(f){return Object.prototype.toString.call(f).slice(8,-1)},objId:function(f){return f.__id||Object.defineProperty(f,"__id",{value:++a}),f.__id},clone:function f(m,j){j=j||{};var v,w;switch(c.util.type(m)){case"Object":if(w=c.util.objId(m),j[w])return j[w];v={},j[w]=v;for(var _ in m)m.hasOwnProperty(_)&&(v[_]=f(m[_],j));return v;case"Array":return w=c.util.objId(m),j[w]?j[w]:(v=[],j[w]=v,m.forEach(function(P,T){v[T]=f(P,j)}),v);default:return m}},getLanguage:function(f){for(;f;){var m=i.exec(f.className);if(m)return m[1].toLowerCase();f=f.parentElement}return"none"},setLanguage:function(f,m){f.className=f.className.replace(RegExp(i,"gi"),""),f.classList.add("language-"+m)},currentScript:function(){if(typeof document>"u")return null;if(document.currentScript&&document.currentScript.tagName==="SCRIPT")return document.currentScript;try{throw new Error}catch(v){var f=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(v.stack)||[])[1];if(f){var m=document.getElementsByTagName("script");for(var j in m)if(m[j].src==f)return m[j]}return null}},isActive:function(f,m,j){for(var v="no-"+m;f;){var w=f.classList;if(w.contains(m))return!0;if(w.contains(v))return!1;f=f.parentElement}return!!j}},languages:{plain:o,plaintext:o,text:o,txt:o,extend:function(f,m){var j=c.util.clone(c.languages[f]);for(var v in m)j[v]=m[v];return j},insertBefore:function(f,m,j,v){v=v||c.languages;var w=v[f],_={};for(var P in w)if(w.hasOwnProperty(P)){if(P==m)for(var T in j)j.hasOwnProperty(T)&&(_[T]=j[T]);j.hasOwnProperty(P)||(_[P]=w[P])}var q=v[f];return v[f]=_,c.languages.DFS(c.languages,function(se,xe){xe===q&&se!=f&&(this[se]=_)}),_},DFS:function f(m,j,v,w){w=w||{};var _=c.util.objId;for(var P in m)if(m.hasOwnProperty(P)){j.call(m,P,m[P],v||P);var T=m[P],q=c.util.type(T);q==="Object"&&!w[_(T)]?(w[_(T)]=!0,f(T,j,null,w)):q==="Array"&&!w[_(T)]&&(w[_(T)]=!0,f(T,j,P,w))}}},plugins:{},highlightAll:function(f,m){c.highlightAllUnder(document,f,m)},highlightAllUnder:function(f,m,j){var v={callback:j,container:f,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};c.hooks.run("before-highlightall",v),v.elements=Array.prototype.slice.apply(v.container.querySelectorAll(v.selector)),c.hooks.run("before-all-elements-highlight",v);for(var w=0,_;_=v.elements[w++];)c.highlightElement(_,m===!0,v.callback)},highlightElement:function(f,m,j){var v=c.util.getLanguage(f),w=c.languages[v];c.util.setLanguage(f,v);var _=f.parentElement;_&&_.nodeName.toLowerCase()==="pre"&&c.util.setLanguage(_,v);var P=f.textContent,T={element:f,language:v,grammar:w,code:P};function q(xe){T.highlightedCode=xe,c.hooks.run("before-insert",T),T.element.innerHTML=T.highlightedCode,c.hooks.run("after-highlight",T),c.hooks.run("complete",T),j&&j.call(T.element)}if(c.hooks.run("before-sanity-check",T),_=T.element.parentElement,_&&_.nodeName.toLowerCase()==="pre"&&!_.hasAttribute("tabindex")&&_.setAttribute("tabindex","0"),!T.code){c.hooks.run("complete",T),j&&j.call(T.element);return}if(c.hooks.run("before-highlight",T),!T.grammar){q(c.util.encode(T.code));return}if(m&&s.Worker){var se=new Worker(c.filename);se.onmessage=function(xe){q(xe.data)},se.postMessage(JSON.stringify({language:T.language,code:T.code,immediateClose:!0}))}else q(c.highlight(T.code,T.grammar,T.language))},highlight:function(f,m,j){var v={code:f,grammar:m,language:j};if(c.hooks.run("before-tokenize",v),!v.grammar)throw new Error('The language "'+v.language+'" has no grammar.');return v.tokens=c.tokenize(v.code,v.grammar),c.hooks.run("after-tokenize",v),u.stringify(c.util.encode(v.tokens),v.language)},tokenize:function(f,m){var j=m.rest;if(j){for(var v in j)m[v]=j[v];delete m.rest}var w=new C;return V(w,w.head,f),F(f,w,m,w.head,0),U(w)},hooks:{all:{},add:function(f,m){var j=c.hooks.all;j[f]=j[f]||[],j[f].push(m)},run:function(f,m){var j=c.hooks.all[f];if(!(!j||!j.length))for(var v=0,w;w=j[v++];)w(m)}},Token:u};s.Prism=c;function u(f,m,j,v){this.type=f,this.content=m,this.alias=j,this.length=(v||"").length|0}u.stringify=function f(m,j){if(typeof m=="string")return m;if(Array.isArray(m)){var v="";return m.forEach(function(q){v+=f(q,j)}),v}var w={type:m.type,content:f(m.content,j),tag:"span",classes:["token",m.type],attributes:{},language:j},_=m.alias;_&&(Array.isArray(_)?Array.prototype.push.apply(w.classes,_):w.classes.push(_)),c.hooks.run("wrap",w);var P="";for(var T in w.attributes)P+=" "+T+'="'+(w.attributes[T]||"").replace(/"/g,"&quot;")+'"';return"<"+w.tag+' class="'+w.classes.join(" ")+'"'+P+">"+w.content+"</"+w.tag+">"};function y(f,m,j,v){f.lastIndex=m;var w=f.exec(j);if(w&&v&&w[1]){var _=w[1].length;w.index+=_,w[0]=w[0].slice(_)}return w}function F(f,m,j,v,w,_){for(var P in j)if(!(!j.hasOwnProperty(P)||!j[P])){var T=j[P];T=Array.isArray(T)?T:[T];for(var q=0;q<T.length;++q){if(_&&_.cause==P+","+q)return;var se=T[q],xe=se.inside,_t=!!se.lookbehind,$t=!!se.greedy,Hn=se.alias;if($t&&!se.pattern.global){var qn=se.pattern.toString().match(/[imsuy]*$/)[0];se.pattern=RegExp(se.pattern.source,qn+"g")}for(var It=se.pattern||se,ie=v.next,pe=w;ie!==m.tail&&!(_&&pe>=_.reach);pe+=ie.value.length,ie=ie.next){var _e=ie.value;if(m.length>f.length)return;if(!(_e instanceof u)){var He=1,me;if($t){if(me=y(It,pe,f,_t),!me||me.index>=f.length)break;var qe=me.index,Gn=me.index+me[0].length,je=pe;for(je+=ie.value.length;qe>=je;)ie=ie.next,je+=ie.value.length;if(je-=ie.value.length,pe=je,ie.value instanceof u)continue;for(var Re=ie;Re!==m.tail&&(je<Gn||typeof Re.value=="string");Re=Re.next)He++,je+=Re.value.length;He--,_e=f.slice(pe,je),me.index-=pe}else if(me=y(It,0,_e,_t),!me)continue;var qe=me.index,Ge=me[0],ct=_e.slice(0,qe),Et=_e.slice(qe+Ge.length),dt=pe+_e.length;_&&dt>_.reach&&(_.reach=dt);var Je=ie.prev;ct&&(Je=V(m,Je,ct),pe+=ct.length),E(m,Je,He);var Jn=new u(P,xe?c.tokenize(Ge,xe):Ge,Hn,Ge);if(ie=V(m,Je,Jn),Et&&V(m,ie,Et),He>1){var ut={cause:P+","+q,reach:dt};F(f,m,j,ie.prev,pe,ut),_&&ut.reach>_.reach&&(_.reach=ut.reach)}}}}}}function C(){var f={value:null,prev:null,next:null},m={value:null,prev:f,next:null};f.next=m,this.head=f,this.tail=m,this.length=0}function V(f,m,j){var v=m.next,w={value:j,prev:m,next:v};return m.next=w,v.prev=w,f.length++,w}function E(f,m,j){for(var v=m.next,w=0;w<j&&v!==f.tail;w++)v=v.next;m.next=v,v.prev=m,f.length-=w}function U(f){for(var m=[],j=f.head.next;j!==f.tail;)m.push(j.value),j=j.next;return m}if(!s.document)return s.addEventListener&&(c.disableWorkerMessageHandler||s.addEventListener("message",function(f){var m=JSON.parse(f.data),j=m.language,v=m.code,w=m.immediateClose;s.postMessage(c.highlight(v,c.languages[j],j)),w&&s.close()},!1)),c;var H=c.util.currentScript();H&&(c.filename=H.src,H.hasAttribute("data-manual")&&(c.manual=!0));function D(){c.manual||c.highlightAll()}if(!c.manual){var J=document.readyState;J==="loading"||J==="interactive"&&H&&H.defer?document.addEventListener("DOMContentLoaded",D):window.requestAnimationFrame?window.requestAnimationFrame(D):window.setTimeout(D,16)}return c})(n);t.exports&&(t.exports=r),typeof Pt<"u"&&(Pt.Prism=r),r.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},r.languages.markup.tag.inside["attr-value"].inside.entity=r.languages.markup.entity,r.languages.markup.doctype.inside["internal-subset"].inside=r.languages.markup,r.hooks.add("wrap",function(s){s.type==="entity"&&(s.attributes.title=s.content.replace(/&amp;/,"&"))}),Object.defineProperty(r.languages.markup.tag,"addInlined",{value:function(i,a){var o={};o["language-"+a]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:r.languages[a]},o.cdata=/^<!\[CDATA\[|\]\]>$/i;var c={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:o}};c["language-"+a]={pattern:/[\s\S]+/,inside:r.languages[a]};var u={};u[i]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return i}),"i"),lookbehind:!0,greedy:!0,inside:c},r.languages.insertBefore("markup","cdata",u)}}),Object.defineProperty(r.languages.markup.tag,"addAttribute",{value:function(s,i){r.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+s+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[i,"language-"+i],inside:r.languages[i]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),r.languages.html=r.languages.markup,r.languages.mathml=r.languages.markup,r.languages.svg=r.languages.markup,r.languages.xml=r.languages.extend("markup",{}),r.languages.ssml=r.languages.xml,r.languages.atom=r.languages.xml,r.languages.rss=r.languages.xml,(function(s){var i=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;s.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+i.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+i.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+i.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+i.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:i,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},s.languages.css.atrule.inside.rest=s.languages.css;var a=s.languages.markup;a&&(a.tag.addInlined("style","css"),a.tag.addAttribute("style","css"))})(r),r.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},r.languages.javascript=r.languages.extend("clike",{"class-name":[r.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),r.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,r.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:r.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:r.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:r.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:r.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:r.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),r.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:r.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),r.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),r.languages.markup&&(r.languages.markup.tag.addInlined("script","javascript"),r.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),r.languages.js=r.languages.javascript,(function(){if(typeof r>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var s="Loading…",i=function(H,D){return"✖ Error "+H+" while fetching file: "+D},a="✖ Error: File does not exist or is empty",o={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},c="data-src-status",u="loading",y="loaded",F="failed",C="pre[data-src]:not(["+c+'="'+y+'"]):not(['+c+'="'+u+'"])';function V(H,D,J){var f=new XMLHttpRequest;f.open("GET",H,!0),f.onreadystatechange=function(){f.readyState==4&&(f.status<400&&f.responseText?D(f.responseText):f.status>=400?J(i(f.status,f.statusText)):J(a))},f.send(null)}function E(H){var D=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(H||"");if(D){var J=Number(D[1]),f=D[2],m=D[3];return f?m?[J,Number(m)]:[J,void 0]:[J,J]}}r.hooks.add("before-highlightall",function(H){H.selector+=", "+C}),r.hooks.add("before-sanity-check",function(H){var D=H.element;if(D.matches(C)){H.code="",D.setAttribute(c,u);var J=D.appendChild(document.createElement("CODE"));J.textContent=s;var f=D.getAttribute("data-src"),m=H.language;if(m==="none"){var j=(/\.(\w+)$/.exec(f)||[,"none"])[1];m=o[j]||j}r.util.setLanguage(J,m),r.util.setLanguage(D,m);var v=r.plugins.autoloader;v&&v.loadLanguages(m),V(f,function(w){D.setAttribute(c,y);var _=E(D.getAttribute("data-range"));if(_){var P=w.split(/\r\n?|\n/g),T=_[0],q=_[1]==null?P.length:_[1];T<0&&(T+=P.length),T=Math.max(0,Math.min(T-1,P.length)),q<0&&(q+=P.length),q=Math.max(0,Math.min(q,P.length)),w=P.slice(T,q).join(`
`),D.hasAttribute("data-start")||D.setAttribute("data-start",String(T+1))}J.textContent=w,r.highlightElement(J)},function(w){D.setAttribute(c,F),J.textContent=w})}}),r.plugins.fileHighlight={highlight:function(D){for(var J=(D||document).querySelectorAll(C),f=0,m;m=J[f++];)r.highlightElement(m)}};var U=!1;r.fileHighlight=function(){U||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),U=!0),r.plugins.fileHighlight.highlight.apply(this,arguments)}})()})(ht)),ht.exports}var Ar=Fr();const Cr=xn(Ar);var Zt={},Dt;function kr(){return Dt||(Dt=1,(function(t){t.languages.typescript=t.languages.extend("javascript",{"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|type)\s+)(?!keyof\b)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?:\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,lookbehind:!0,greedy:!0,inside:null},builtin:/\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\b/}),t.languages.typescript.keyword.push(/\b(?:abstract|declare|is|keyof|readonly|require)\b/,/\b(?:asserts|infer|interface|module|namespace|type)\b(?=\s*(?:[{_$a-zA-Z\xA0-\uFFFF]|$))/,/\btype\b(?=\s*(?:[\{*]|$))/),delete t.languages.typescript.parameter,delete t.languages.typescript["literal-property"];var n=t.languages.extend("typescript",{});delete n["class-name"],t.languages.typescript["class-name"].inside=n,t.languages.insertBefore("typescript","function",{decorator:{pattern:/@[$\w\xA0-\uFFFF]+/,inside:{at:{pattern:/^@/,alias:"operator"},function:/^[\s\S]+/}},"generic-function":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\s*\()/,greedy:!0,inside:{function:/^#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:n}}}}),t.languages.ts=t.languages.typescript})(Prism)),Zt}kr();(function(t){var n=t.util.clone(t.languages.javascript),r=/(?:\s|\/\/.*(?!.)|\/\*(?:[^*]|\*(?!\/))\*\/)/.source,s=/(?:\{(?:\{(?:\{[^{}]*\}|[^{}])*\}|[^{}])*\})/.source,i=/(?:\{<S>*\.{3}(?:[^{}]|<BRACES>)*\})/.source;function a(u,y){return u=u.replace(/<S>/g,function(){return r}).replace(/<BRACES>/g,function(){return s}).replace(/<SPREAD>/g,function(){return i}),RegExp(u,y)}i=a(i).source,t.languages.jsx=t.languages.extend("markup",n),t.languages.jsx.tag.pattern=a(/<\/?(?:[\w.:-]+(?:<S>+(?:[\w.:$-]+(?:=(?:"(?:\\[\s\S]|[^\\"])*"|'(?:\\[\s\S]|[^\\'])*'|[^\s{'"/>=]+|<BRACES>))?|<SPREAD>))*<S>*\/?)?>/.source),t.languages.jsx.tag.inside.tag.pattern=/^<\/?[^\s>\/]*/,t.languages.jsx.tag.inside["attr-value"].pattern=/=(?!\{)(?:"(?:\\[\s\S]|[^\\"])*"|'(?:\\[\s\S]|[^\\'])*'|[^\s'">]+)/,t.languages.jsx.tag.inside.tag.inside["class-name"]=/^[A-Z]\w*(?:\.[A-Z]\w*)*$/,t.languages.jsx.tag.inside.comment=n.comment,t.languages.insertBefore("inside","attr-name",{spread:{pattern:a(/<SPREAD>/.source),inside:t.languages.jsx}},t.languages.jsx.tag),t.languages.insertBefore("inside","special-attr",{script:{pattern:a(/=<BRACES>/.source),alias:"language-javascript",inside:{"script-punctuation":{pattern:/^=(?=\{)/,alias:"punctuation"},rest:t.languages.jsx}}},t.languages.jsx.tag);var o=function(u){return u?typeof u=="string"?u:typeof u.content=="string"?u.content:u.content.map(o).join(""):""},c=function(u){for(var y=[],F=0;F<u.length;F++){var C=u[F],V=!1;if(typeof C!="string"&&(C.type==="tag"&&C.content[0]&&C.content[0].type==="tag"?C.content[0].content[0].content==="</"?y.length>0&&y[y.length-1].tagName===o(C.content[0].content[1])&&y.pop():C.content[C.content.length-1].content==="/>"||y.push({tagName:o(C.content[0].content[1]),openedBraces:0}):y.length>0&&C.type==="punctuation"&&C.content==="{"?y[y.length-1].openedBraces++:y.length>0&&y[y.length-1].openedBraces>0&&C.type==="punctuation"&&C.content==="}"?y[y.length-1].openedBraces--:V=!0),(V||typeof C=="string")&&y.length>0&&y[y.length-1].openedBraces===0){var E=o(C);F<u.length-1&&(typeof u[F+1]=="string"||u[F+1].type==="plain-text")&&(E+=o(u[F+1]),u.splice(F+1,1)),F>0&&(typeof u[F-1]=="string"||u[F-1].type==="plain-text")&&(E=o(u[F-1])+E,u.splice(F-1,1),F--),u[F]=new t.Token("plain-text",E,null,E)}C.content&&typeof C.content!="string"&&c(C.content)}};t.hooks.add("after-tokenize",function(u){u.language!=="jsx"&&u.language!=="tsx"||c(u.tokens)})})(Prism);(function(t){var n=t.util.clone(t.languages.typescript);t.languages.tsx=t.languages.extend("jsx",n),delete t.languages.tsx.parameter,delete t.languages.tsx["literal-property"];var r=t.languages.tsx.tag;r.pattern=RegExp(/(^|[^\w$]|(?=<\/))/.source+"(?:"+r.pattern.source+")",r.pattern.flags),r.lookbehind=!0})(Prism);const ue=({tabs:t,defaultIndex:n=0})=>{const r=ve("gray.900","gray.800"),[s,i]=X.useState([]);X.useEffect(()=>{(async()=>{const c=await Promise.all(t.map(async u=>{if(u.code)return u.code;if(u.snippet)try{const y=u.ts?".ts":u.tsx?".tsx":u.language==="bash"?".sh":u.language==="tsx"?".tsx":".tsx.txt",F=u.folder?`/snippets/${u.folder}/${u.snippet}${y}`:`/snippets/${u.snippet}${y}`,C=await fetch(F);if(!C.ok)throw new Error(`Failed to load snippet: ${u.snippet}`);return(await C.text()).split(`
`).filter(U=>!U.startsWith("// Auto-generated snippet from:")).filter(U=>!U.startsWith("// Description:")).filter(U=>!U.startsWith("// Last synced:")).filter(U=>!U.startsWith("// DO NOT EDIT")).join(`
`).replace(/^\n+/,"")}catch{return`// Error loading snippet: ${u.snippet}`}return"// No content"}));i(c)})()},[t]);const a=ve("gray.200","gray.600");return X.useEffect(()=>{Cr.highlightAll()},[s]),e.jsx(d,{border:"1px",borderColor:a,borderRadius:"md",overflow:"hidden",my:4,width:"full",children:e.jsxs(cn,{defaultIndex:n,variant:"enclosed",children:[e.jsx(dn,{bg:"gray.100",borderBottom:"1px",borderColor:a,children:t.map((o,c)=>e.jsx(De,{fontSize:"sm",fontWeight:"medium",_selected:{bg:r,color:"white",borderBottomColor:r},children:o.label},c))}),e.jsx(un,{children:t.map((o,c)=>e.jsx(Ue,{p:0,children:e.jsx(d,{as:"pre",bg:r,color:"white",p:4,overflow:"auto",fontSize:"sm",fontFamily:"mono",lineHeight:"1.5",children:e.jsx(Z,{as:"code",className:`language-${o.language}`,bg:"transparent",color:"inherit",p:0,fontSize:"inherit",fontFamily:"inherit",whiteSpace:"pre",children:s[c]||"// Loading..."})})},c))})]})})},I=({children:t,title:n,titleSize:r="lg",spacing:s=6,noVStack:i=!1,...a})=>{const o=n?e.jsx(h,{textAlign:"center",size:r,children:n}):"";return e.jsx(hn,{width:"full",mb:3,children:e.jsxs(mn,{...a,children:[o,i?t:e.jsx(x,{spacing:s,align:"stretch",children:t})]})})};function fe(t,...n){const r=X.useRef(null);r.current||=t(...n);const[s,i]=X.useState(r.current?.value);return X.useEffect(()=>{if(r.current){let a=r.current?.subscribe(i);return()=>{a?.unsubscribe()}}},[]),[s,r.current]}const Tr=()=>new Se({name:"demo-counter",value:{count:0},actions:{increment(t){this.mutate(n=>{n.count+=1})},decrement(t){this.mutate(n=>{n.count-=1})},reset(t){this.mutate(n=>{n.count=0})}}}),_r=()=>{const[t,n]=fe(Tr),{count:r}=t;return e.jsxs(d,{p:6,bg:"gray.100",borderRadius:"md",textAlign:"center",minW:"300px",children:[e.jsx(l,{fontSize:"3xl",fontWeight:"bold",color:"forest.600",mb:4,children:r}),e.jsxs($,{spacing:4,justify:"center",children:[e.jsx(R,{colorScheme:"forest",onClick:n.$.increment,children:"+1"}),e.jsx(R,{variant:"outline",onClick:n.$.decrement,children:"-1"}),e.jsx(R,{colorScheme:"red",variant:"outline",onClick:n.$.reset,children:"Reset"})]})]})},$r=()=>{const t=[{label:"Installation",language:"bash",snippet:"installation",folder:"home"},{label:"Basic Usage",language:"typescript",snippet:"basic-usage",folder:"home",ts:!0}];return e.jsxs(oe,{maxW:"container.xl",py:8,children:[" ",e.jsxs($,{spacing:2,width:"full",justify:"space-between",align:"flex-start",children:[e.jsx(R,{as:B,to:"/why",colorScheme:"forest",size:"lg",children:"Why Forestry?"}),e.jsxs(x,{spacing:2,textAlign:"center",mb:6,children:[e.jsx(h,{size:"2xl",color:"gray.800",children:"🌲 Forestry 4.0"}),e.jsx(l,{fontSize:"xl",color:"gray.600",maxW:"2xl",children:"A simple, powerful state management library for React. Start with the essentials, then unlock advanced features when you need them."})]})," ",e.jsx(R,{as:B,to:"/store",variant:"outline",size:"lg",children:"Get Started"})]}),e.jsxs(Y,{columns:{base:1,lg:2},spacing:8,mb:12,children:[e.jsxs(I,{children:[e.jsxs(x,{spacing:0,children:[e.jsx(h,{size:"lg",color:"forest.700",my:2,children:"Get productive in 5 minutes"}),e.jsx(l,{color:"gray.600",children:"Everything you need to manage state in React applications. Simple, predictable, and powerful."})]}),e.jsxs(x,{align:"start",spacing:2,fontSize:"sm",children:[e.jsxs($,{children:[e.jsx(l,{children:"✅"}),e.jsx(l,{as:B,to:"/store",color:"forest.600",_hover:{textDecoration:"underline"},children:"Create stores with initial state"})]}),e.jsxs($,{children:[e.jsx(l,{children:"✅"}),e.jsx(l,{as:B,to:"/actions",color:"forest.600",_hover:{textDecoration:"underline"},children:"Define actions for state updates"})]}),e.jsxs($,{children:[e.jsx(l,{children:"✅"}),e.jsx(l,{as:B,to:"/react",color:"forest.600",_hover:{textDecoration:"underline"},children:"React hooks integration"})]}),e.jsxs($,{children:[e.jsx(l,{children:"✅"}),e.jsx(l,{as:B,to:"/store",color:"forest.600",_hover:{textDecoration:"underline"},children:"TypeScript support"})]})]})]}),e.jsxs(I,{children:[e.jsxs(x,{spacing:0,align:"start",children:[e.jsx(h,{size:"lg",color:"purple.700",my:2,children:"Advanced capabilities"}),e.jsx(l,{color:"gray.600",children:"Unlock advanced features for complex applications: validation, transactions, and reactive patterns."})]}),e.jsxs(x,{align:"start",spacing:2,fontSize:"sm",children:[e.jsxs($,{children:[e.jsx(l,{children:"🔧"}),e.jsx(l,{as:B,to:"/validation",color:"purple.600",_hover:{textDecoration:"underline"},children:"Built-in validation system"})]}),e.jsxs($,{children:[e.jsx(l,{children:"🔧"}),e.jsx(l,{as:B,to:"/transactions",color:"purple.600",_hover:{textDecoration:"underline"},children:"Atomic transactions with rollback"})]}),e.jsxs($,{children:[e.jsx(l,{children:"🔧"}),e.jsx(l,{as:B,to:"/rxjs",color:"purple.600",_hover:{textDecoration:"underline"},children:"RxJS reactive programming"})]}),e.jsxs($,{children:[e.jsx(l,{children:"🔧"}),e.jsx(l,{as:B,to:"/examples",color:"purple.600",_hover:{textDecoration:"underline"},children:"Advanced patterns & debugging"})]})]})]})]}),e.jsxs(d,{mb:12,children:[e.jsx(h,{size:"lg",mb:6,children:"Quick Start"}),e.jsx(ue,{tabs:t})]}),e.jsxs(I,{title:"Example - basic counter",children:[e.jsx(_r,{}),e.jsx(Le,{}),e.jsx(ue,{tabs:[{label:"Store Factory",language:"typescript",snippet:"demo-store-definition",folder:"home",ts:!0},{label:"Component",language:"tsx",snippet:"demo-jsx-template",folder:"home"}]})]})]})},Ir=()=>e.jsxs(x,{spacing:8,align:"stretch",children:[e.jsxs(d,{textAlign:"center",children:[e.jsx(h,{size:"xl",mb:4,children:"Why Choose Forestry?"}),e.jsx(l,{fontSize:"lg",color:"gray.600",maxW:"3xl",mx:"auto",children:"Forestry provides a powerful, type-safe, and intuitive approach to state management that scales from simple components to complex applications."})]}),e.jsxs(Y,{columns:{base:1,md:2,lg:3},spacing:6,children:[e.jsxs(d,{layerStyle:"card",bg:"blue.50",children:[e.jsx(Fe,{as:Ae,color:"blue.500",boxSize:8,mb:4}),e.jsx(h,{size:"md",mb:3,color:"blue.700",children:"Type Safety First"}),e.jsxs(G,{spacing:2,children:[e.jsxs(g,{children:[e.jsx(b,{as:O,color:"blue.500"}),"Full TypeScript integration"]}),e.jsxs(g,{children:[e.jsx(b,{as:O,color:"blue.500"}),"Compile-time error detection"]}),e.jsxs(g,{children:[e.jsx(b,{as:O,color:"blue.500"}),"IntelliSense support"]}),e.jsxs(g,{children:[e.jsx(b,{as:O,color:"blue.500"}),"Zod schema validation"]})]})]}),e.jsxs(d,{layerStyle:"card",bg:"green.50",children:[e.jsx(Fe,{as:Ae,color:"green.500",boxSize:8,mb:4}),e.jsx(h,{size:"md",mb:3,color:"green.700",children:"Reactive by Design"}),e.jsxs(G,{spacing:2,children:[e.jsxs(g,{children:[e.jsx(b,{as:O,color:"green.500"}),"RxJS-powered reactivity"]}),e.jsxs(g,{children:[e.jsx(b,{as:O,color:"green.500"}),"Automatic UI updates"]}),e.jsxs(g,{children:[e.jsx(b,{as:O,color:"green.500"}),"Efficient change detection"]}),e.jsxs(g,{children:[e.jsx(b,{as:O,color:"green.500"}),"Subscription management"]})]})]}),e.jsxs(d,{layerStyle:"card",bg:"purple.50",children:[e.jsx(Fe,{as:Ae,color:"purple.500",boxSize:8,mb:4}),e.jsx(h,{size:"md",mb:3,color:"purple.700",children:"Developer Experience"}),e.jsxs(G,{spacing:2,children:[e.jsxs(g,{children:[e.jsx(b,{as:O,color:"purple.500"}),"Intuitive API design"]}),e.jsxs(g,{children:[e.jsx(b,{as:O,color:"purple.500"}),"Minimal boilerplate"]}),e.jsxs(g,{children:[e.jsx(b,{as:O,color:"purple.500"}),"Built-in testing tools"]}),e.jsxs(g,{children:[e.jsx(b,{as:O,color:"purple.500"}),"Excellent debugging"]})]})]}),e.jsxs(d,{layerStyle:"card",bg:"orange.50",children:[e.jsx(Fe,{as:Ae,color:"orange.500",boxSize:8,mb:4}),e.jsx(h,{size:"md",mb:3,color:"orange.700",children:"Validation & Quality"}),e.jsxs(G,{spacing:2,children:[e.jsxs(g,{children:[e.jsx(b,{as:O,color:"orange.500"}),"Three-layer validation"]}),e.jsxs(g,{children:[e.jsx(b,{as:O,color:"orange.500"}),"Runtime type checking"]}),e.jsxs(g,{children:[e.jsx(b,{as:O,color:"orange.500"}),"Quality feedback system"]}),e.jsxs(g,{children:[e.jsx(b,{as:O,color:"orange.500"}),"Error boundary support"]})]})]}),e.jsxs(d,{layerStyle:"card",bg:"teal.50",children:[e.jsx(Fe,{as:Ae,color:"teal.500",boxSize:8,mb:4}),e.jsx(h,{size:"md",mb:3,color:"teal.700",children:"Scalable Architecture"}),e.jsxs(G,{spacing:2,children:[e.jsxs(g,{children:[e.jsx(b,{as:O,color:"teal.500"}),"Modular store design"]}),e.jsxs(g,{children:[e.jsx(b,{as:O,color:"teal.500"}),"Forest branching system"]}),e.jsxs(g,{children:[e.jsx(b,{as:O,color:"teal.500"}),"Factory pattern support"]}),e.jsxs(g,{children:[e.jsx(b,{as:O,color:"teal.500"}),"Dependency injection"]})]})]}),e.jsxs(d,{layerStyle:"card",bg:"red.50",children:[e.jsx(Fe,{as:Ae,color:"red.500",boxSize:8,mb:4}),e.jsx(h,{size:"md",mb:3,color:"red.700",children:"React Integration"}),e.jsxs(G,{spacing:2,children:[e.jsxs(g,{children:[e.jsx(b,{as:O,color:"red.500"}),"Custom React hooks"]}),e.jsxs(g,{children:[e.jsx(b,{as:O,color:"red.500"}),"Automatic cleanup"]}),e.jsxs(g,{children:[e.jsx(b,{as:O,color:"red.500"}),"SSR compatibility"]}),e.jsxs(g,{children:[e.jsx(b,{as:O,color:"red.500"}),"DevTools integration"]})]})]})]})]}),Er=()=>e.jsxs(x,{spacing:8,align:"stretch",children:[e.jsxs(d,{children:[e.jsx(h,{size:"xl",mb:4,children:"Yet Another Store System?"}),e.jsxs(l,{fontSize:"lg",color:"gray.600",maxW:"3xl",children:["Forestry grew from a profound disaffection in the status quo. Redux, mainly but also a lot of other alternatives including hooks. I saw the same patterns happening over and over again:",e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("b",{children:"A lack of the ability to synchronously update state"}),". There is no inbuilt reason that local state needs to be forced into async patterns. (as is the case in hooks) like RxJs (the backbone of Forestry) you should be able to change state and see results in real time. hooks for instnace are particularly poor at reflecting the real time state of anything given the large refresh cycle of useState."]}),e.jsxs("li",{children:[e.jsx("b",{children:"Far too much magic"}),". Actions should be straight up javascript code with as little magic as necessary."]}),e.jsxs("li",{children:[e.jsx("b",{children:"Had coded state that is difficult to test"}),". Most state systems are so wed to their context that they are difficult to isolate; this violates separation of concerns and frankly most React testing is so painful that it behooves you to extricate the business logic and enable independent testing."]}),e.jsxs("li",{children:[e.jsx("b",{children:"Abdication of responsibility for schema enforcement"}),'; validation of change values before they are submitted into state is not something to be put in as optional nice to have or assumed to be a "solved problem" with typescript. State data is dynamic and often comes from sources outside the codebase (fetch), so typescript cannot enforce type sanity - state must take that responsibility to heart.']}),e.jsxs("li",{children:[e.jsx("b",{children:"Lack of transactional atomicity"}),"; often you need to make several changes in sequence and have them all succeed or fail; especially important with the use of nested actions. Forestry even allows you to temporarily suspend validation constraints while you change state over several steps as long as the net effect of transactions produce valid data."]}),e.jsxs("li",{children:[e.jsx("b",{children:"Nested Actions"}),"; composition is very difficult or impossible in many state systems; Forestry allows you to drill deep into multiple actions."]})]}),'Foresty has been written to address these features point by point. Many of the solutions are "passive" - some like ',e.jsx(B,{to:"/validation",children:"Validation"}),"require some tooling."]})]}),e.jsxs(d,{layerStyle:"card",bg:"gray.50",children:[e.jsx(h,{size:"lg",mb:6,children:"Feature Comparison"}),e.jsx(er,{children:e.jsxs(tr,{variant:"simple",size:"sm",children:[e.jsx(nr,{children:e.jsxs(ce,{children:[e.jsx(Ve,{children:"Feature"}),e.jsx(Ve,{textAlign:"center",children:"Forestry"}),e.jsx(Ve,{textAlign:"center",children:"Redux"}),e.jsx(Ve,{textAlign:"center",children:"Zustand"}),e.jsx(Ve,{textAlign:"center",children:"Jotai"})]})}),e.jsxs(rr,{children:[e.jsxs(ce,{children:[e.jsx(A,{fontWeight:"semibold",children:"TypeScript Support"}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"green",children:"Excellent"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"yellow",children:"Good"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"green",children:"Excellent"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"green",children:"Excellent"})})]}),e.jsxs(ce,{children:[e.jsx(A,{fontWeight:"semibold",children:"Boilerplate"}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"green",children:"Minimal"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"red",children:"Heavy"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"green",children:"Minimal"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"yellow",children:"Medium"})})]}),e.jsxs(ce,{children:[e.jsx(A,{fontWeight:"semibold",children:"Validation"}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"green",children:"Built-in"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"red",children:"External"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"red",children:"External"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"red",children:"External"})})]}),e.jsxs(ce,{children:[e.jsx(A,{fontWeight:"semibold",children:"Reactivity"}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"green",children:"RxJS"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"yellow",children:"Manual"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"yellow",children:"Manual"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"green",children:"Automatic"})})]}),e.jsxs(ce,{children:[e.jsx(A,{fontWeight:"semibold",children:"DevTools"}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"green",children:"Built-in"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"green",children:"Excellent"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"yellow",children:"Basic"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"yellow",children:"Basic"})})]}),e.jsxs(ce,{children:[e.jsx(A,{fontWeight:"semibold",children:"Learning Curve"}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"green",children:"Gentle"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"red",children:"Steep"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"green",children:"Gentle"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"yellow",children:"Medium"})})]}),e.jsxs(ce,{children:[e.jsx(A,{fontWeight:"semibold",children:"Action Testability"}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"green",children:"Excellent"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"yellow",children:"Complex"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"yellow",children:"Manual"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"yellow",children:"Manual"})})]}),e.jsxs(ce,{children:[e.jsx(A,{fontWeight:"semibold",children:"Atomic Operations"}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"green",children:"Built-in"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"red",children:"Manual"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"red",children:"Manual"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"red",children:"Manual"})})]}),e.jsxs(ce,{children:[e.jsx(A,{fontWeight:"semibold",children:"Context Independence"}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"green",children:"Complete"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"red",children:"Coupled"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"yellow",children:"Partial"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"yellow",children:"Partial"})})]}),e.jsxs(ce,{children:[e.jsx(A,{fontWeight:"semibold",children:"Real-time Feedback"}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"green",children:"Synchronous"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"red",children:"Async Only"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"yellow",children:"Limited"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"yellow",children:"Limited"})})]}),e.jsxs(ce,{children:[e.jsx(A,{fontWeight:"semibold",children:"Bundle Size"}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"yellow",children:"Medium"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"red",children:"Large"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"green",children:"Small"})}),e.jsx(A,{textAlign:"center",children:e.jsx(S,{colorScheme:"green",children:"Small"})})]})]})]})})]}),e.jsxs(d,{layerStyle:"card",bg:"blue.50",children:[e.jsx(h,{size:"lg",mb:6,children:"Code Comparison"}),e.jsx(l,{color:"gray.600",mb:6,children:"Compare how the same functionality looks across different state management solutions."}),e.jsx(ue,{tabs:[{label:"Forestry",language:"typescript",snippet:"forestryExample",folder:"WhyForestry"},{label:"Redux Toolkit",language:"typescript",snippet:"reduxExample",folder:"WhyForestry"},{label:"Zustand",language:"typescript",snippet:"zustandExample",folder:"WhyForestry"}]})]}),e.jsxs(Y,{columns:{base:1,lg:2},spacing:6,children:[e.jsxs(d,{layerStyle:"card",bg:"green.50",children:[e.jsx(h,{size:"md",mb:4,color:"green.700",children:"✅ Forestry Advantages"}),e.jsxs(x,{spacing:3,align:"stretch",children:[e.jsxs(l,{fontSize:"sm",children:[e.jsx("strong",{children:"Built-in Validation:"})," Three-layer validation system with runtime checks"]}),e.jsxs(l,{fontSize:"sm",children:[e.jsx("strong",{children:"RxJS Integration:"})," Powerful reactive programming capabilities"]}),e.jsxs(l,{fontSize:"sm",children:[e.jsx("strong",{children:"Forest Branching:"})," Unique field-level state management for forms"]}),e.jsxs(l,{fontSize:"sm",children:[e.jsx("strong",{children:"Quality Feedback:"})," User-friendly validation messages"]}),e.jsxs(l,{fontSize:"sm",children:[e.jsx("strong",{children:"Factory Pattern:"})," Dependency injection and reusable store creation"]})]})]}),e.jsxs(d,{layerStyle:"card",bg:"orange.50",children:[e.jsx(h,{size:"md",mb:4,color:"orange.700",children:"⚠️ Trade-offs"}),e.jsxs(x,{spacing:3,align:"stretch",children:[e.jsxs(l,{fontSize:"sm",children:[e.jsx("strong",{children:"Learning Curve:"})," New concepts like Forest branching and validation layers"]}),e.jsxs(l,{fontSize:"sm",children:[e.jsx("strong",{children:"Bundle Size:"})," RxJS dependency adds to bundle size"]}),e.jsxs(l,{fontSize:"sm",children:[e.jsx("strong",{children:"Ecosystem:"})," Newer library with smaller community"]}),e.jsxs(l,{fontSize:"sm",children:[e.jsx("strong",{children:"Documentation:"})," Still growing compared to established solutions"]})]})]})]})]}),K=({title:t,language:n,code:r,children:s})=>{const i=ve("gray.900","gray.800"),a=ve("gray.200","gray.600"),o=pn(),[c,u]=X.useState(!1),[y,F]=X.useState(!1),C=X.useRef(null),V=s??r??"",E=async()=>{try{await navigator.clipboard.writeText(V.toString()),o({title:"Copied to clipboard",status:"success",duration:2e3,isClosable:!0})}catch{o({title:"Failed to copy",status:"error",duration:2e3,isClosable:!0})}};return X.useEffect(()=>{if(C.current){const U=C.current.scrollHeight,H=C.current.clientHeight;F(U>H)}},[V]),e.jsxs(d,{border:"1px",borderColor:a,borderRadius:"md",width:"full",overflow:"hidden",my:4,children:[t&&e.jsx(d,{bg:"gray.100",px:4,py:2,borderBottom:"1px",borderColor:a,children:e.jsx(l,{fontSize:"sm",fontWeight:"medium",children:t})}),e.jsxs(d,{position:"relative",children:[e.jsx(sr,{"aria-label":"Copy code",icon:e.jsx(yr,{}),size:"sm",position:"absolute",top:2,right:2,zIndex:1,colorScheme:"gray",variant:"ghost",color:"gray.400",_hover:{color:"white",bg:"gray.700"},onClick:E}),e.jsx(d,{ref:C,as:"pre",bg:i,color:"white",p:4,overflow:"auto",fontSize:"sm",fontFamily:"mono",lineHeight:"1.5",maxHeight:c?"none":"300px",transition:"max-height 0.3s ease",children:e.jsx(Z,{as:"code",className:`language-${n}`,bg:"transparent",color:"inherit",p:0,fontSize:"inherit",fontFamily:"inherit",whiteSpace:"pre",children:s??r})}),y&&e.jsx(d,{position:"absolute",bottom:0,left:0,right:0,bg:c?"transparent":`linear-gradient(transparent, ${i})`,m:6,children:e.jsx(yt,{direction:"row",justify:"flex-end",children:e.jsx(R,{size:"sm",variant:"outline",colorScheme:"blue",onClick:()=>u(!c),bg:i,color:"white",borderColor:"blue.400",_hover:{bg:"blue.600"},children:c?"Show Less":"Show More"})})})]})]})},Pr=(t,n,r)=>new fr({name:`snippet-${n?`${n}-`:""}${t}`,value:{code:"",loading:!0,error:null},actions:{loadSnippet:async function(){this.mutate(s=>{s.loading=!0,s.error=null});try{const s=r?".ts":".tsx.txt",i=n?`/snippets/${n}/${t}${s}`:`/snippets/${t}${s}`,a=await fetch(i);if(!a.ok)throw new Error(`Failed to load snippet: ${t}`);const c=(await a.text()).split(`
`).filter(u=>!u.startsWith("// Auto-generated snippet from:")).filter(u=>!u.startsWith("// Description:")).filter(u=>!u.startsWith("// Last synced:")).filter(u=>!u.startsWith("// DO NOT EDIT")).join(`
`).replace(/^\n+/,"");this.mutate(u=>{u.code=c,u.loading=!1})}catch(s){const i=s instanceof Error?s.message:"Unknown error";console.error("Failed to load snippet:",t,i),this.mutate(a=>{a.error=i,a.code=`// Error loading snippet: ${t}
// Error: ${i}`,a.loading=!1})}}}}),te=({snippetName:t,language:n="typescript",folder:r,ts:s})=>{const[i,a]=fe(Pr,t,r,s);return vt.useEffect(()=>{a.$.loadSnippet()},[a]),i.loading?e.jsx(K,{language:n,children:"// Loading..."}):i.error?e.jsxs(K,{language:n,children:["// Error: ",i.error]}):e.jsx(K,{language:n,children:i.code})};function Ze(){return new Se({name:"user-profile-demo",value:{name:"",age:0,email:"",preferences:{theme:"light"},errors:{}},actions:{handleInputChange:function(t,n){const{name:r,value:s,type:i}=n.target;if(i==="number"){const a=parseInt(s)||0;this.set(r,a)}else this.set(r,s)},handleThemeChange:function(t,n){const r=n.target.value;this.set("preferences.theme",r)},updateProfile:function(t,n){this.mutate(r=>{Object.assign(r,n)})},updatePreferences:function(t,n){this.mutate(r=>{Object.assign(r.preferences,n)})},setupUser:function(t,n){this.$.updateProfile(n.profile),this.$.updatePreferences(n.preferences)},setAge:function(t,n){if(n<0||n>150)throw new Error("Age must be between 0 and 150");this.set("age",n)},validateAndSave:function(t){const n=[];if(t.name.trim()||n.push("Name is required"),t.email.includes("@")||n.push("Valid email is required"),t.age<13&&n.push("Must be at least 13 years old"),n.length>0)throw new Error(`Validation failed: ${n.join(", ")}`);return console.log("Profile saved successfully:",t),"Profile saved successfully!"}},tests:[t=>typeof t.name!="string"?"Name must be a string":null,t=>typeof t.age!="number"?"Age must be a number":null,t=>typeof t.email!="string"?"Email must be a string":null],prep(t){const n={};return t.name.trim()?t.name.trim().length<2?n.name="Name must be at least 2 characters":n.name=null:n.name="Name is required",t.age<0?n.age="Age cannot be negative":t.age>150?n.age="Age cannot exceed 150 years":t.age>0&&t.age<13?n.age="Must be at least 13 years old":n.age=null,t.email&&!t.email.includes("@")?n.email="Please enter a valid email address":n.email=null,{...t,errors:n}}})}const Ye=({name:t,label:n,value:r,type:s="text",error:i,onChange:a,options:o,placeholder:c})=>e.jsxs(Ne,{isInvalid:!!i,children:[e.jsx(Oe,{children:n}),s==="select"?e.jsx(ir,{name:t,value:r,onChange:a,children:o?.map(u=>e.jsx("option",{value:u.value,children:u.label},u.value))}):e.jsx(ye,{name:t,type:s,value:r,onChange:a,placeholder:c}),i&&e.jsx(ar,{children:i})]}),Rr=()=>{const[t,n]=fe(Ze),[r,s]=vt.useState([]),i=()=>{const a=[];try{const o=Ze();o.$.updateProfile({name:"John Doe",age:30}),!o.value.errors.name&&!o.value.errors.age?a.push("✅ Profile update - validation passed"):a.push("❌ Profile update - validation failed")}catch{a.push("❌ Profile update - threw error")}try{const o=Ze();o.$.handleInputChange({target:{name:"age",value:"200",type:"number"}}),o.value.errors.age?a.push("✅ Age validation - correctly caught invalid age"):a.push("❌ Age validation - failed to catch invalid age")}catch{a.push("❌ Age validation - threw error")}try{const o=Ze();o.$.handleInputChange({target:{name:"email",value:"invalid-email",type:"text"}}),o.value.errors.email?a.push("✅ Email validation - correctly caught invalid email"):a.push("❌ Email validation - failed to catch invalid email")}catch{a.push("❌ Email validation - threw error")}try{const o=Ze();o.$.updateProfile({name:"Valid User",age:25,email:"user@example.com"}),o.$.validateAndSave()==="Profile saved successfully!"?a.push("✅ validateAndSave - success case"):a.push("❌ validateAndSave - unexpected result")}catch{a.push("❌ validateAndSave - threw error")}s(a)};return e.jsxs(Y,{columns:{base:1,lg:2},spacing:6,children:[e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsx(l,{fontSize:"lg",fontWeight:"bold",children:"Interactive Demo"}),e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsxs($,{spacing:4,children:[e.jsx(Ye,{name:"name",label:"Name",value:t.name,error:t.errors.name,onChange:n.$.handleInputChange,placeholder:"Enter name"}),e.jsx(Ye,{name:"age",label:"Age",type:"number",value:t.age||"",error:t.errors.age,onChange:n.$.handleInputChange,placeholder:"Enter age"})]}),e.jsx(Ye,{name:"email",label:"Email",type:"email",value:t.email,error:t.errors.email,onChange:n.$.handleInputChange,placeholder:"Enter email"}),e.jsx(Ye,{name:"theme",label:"Theme",type:"select",value:t.preferences.theme,onChange:n.$.handleThemeChange,options:[{value:"light",label:"Light"},{value:"dark",label:"Dark"}]})]}),e.jsxs($,{spacing:4,children:[e.jsx(R,{colorScheme:"blue",onClick:()=>n.$.validateAndSave(),size:"sm",children:"Save Profile"}),e.jsx(R,{colorScheme:"green",onClick:i,size:"sm",children:"Run Tests"})]}),r.length>0&&e.jsxs(d,{children:[e.jsx(l,{fontWeight:"bold",mb:2,children:"Test Results:"}),e.jsx(x,{spacing:1,align:"stretch",children:r.map((a,o)=>e.jsx(l,{fontSize:"sm",fontFamily:"mono",children:a},o))})]})]}),e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsx(l,{fontSize:"lg",fontWeight:"bold",children:"Current State"}),e.jsxs(d,{bg:"gray.50",p:4,borderRadius:"md",fontSize:"sm",fontFamily:"mono",children:[e.jsx(l,{fontWeight:"bold",mb:2,children:"Store Value:"}),e.jsx("pre",{children:JSON.stringify(t,null,2)})]}),e.jsxs(ne,{status:"info",size:"sm",children:[e.jsx(re,{}),e.jsx(d,{children:e.jsx(l,{fontSize:"sm",children:"This demo shows real-time Forestry state management with validation, universal input handlers, and reactive updates."})})]})]})]})},Vr=()=>e.jsx(d,{layerStyle:"card",bg:"blue.50",children:e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsxs(d,{children:[e.jsx(h,{size:"lg",mb:2,children:"Try Forestry Live"}),e.jsx(l,{color:"gray.600",children:"Interact with a real Forestry store. See the source code and try the live demo side by side."})]}),e.jsxs(cn,{variant:"enclosed",colorScheme:"blue",children:[e.jsxs(dn,{children:[e.jsx(De,{children:"Live Demo"}),e.jsx(De,{children:"Store Factory"}),e.jsx(De,{children:"Component Code"}),e.jsx(De,{children:"VITest Tests"})]}),e.jsxs(un,{children:[e.jsx(Ue,{children:e.jsx(Rr,{})}),e.jsx(Ue,{children:e.jsx(K,{language:"typescript",title:"Store Factory (demoStoreFactory.ts)",children:`import { Forest } from '@wonderlandlabs/forestry4';

interface UserProfile {
  name: string;
  age: number;
  email: string;
  preferences: {
    theme: 'light' | 'dark';
  };
  errors: Record<string, string | null>;
}

export default function demoStoreFactory() {
  return new Forest<UserProfile>({
    name: 'user-profile-demo',
    value: {
      name: '',
      age: 0,
      email: '',
      preferences: { theme: 'light' },
      errors: {}
    },
    actions: {
      // Universal input handler - just handles input conversion
      handleInputChange: function(value, event: React.ChangeEvent<HTMLInputElement>) {
        const { name, value: fieldValue, type } = event.target;

        if (type === 'number') {
          const numValue = parseInt(fieldValue) || 0;
          this.set(name, numValue);
        } else {
          this.set(name, fieldValue);
        }
      },

      handleThemeChange: function(value, event: React.ChangeEvent<HTMLSelectElement>) {
        const theme = event.target.value as 'light' | 'dark';
        // Deep set for nested property
        this.set('preferences.theme', theme);
      },

      // Update profile fields
      updateProfile: function(value, updates: Partial<UserProfile>) {
        this.mutate(draft => {
          Object.assign(draft, updates);
        });
      },

      // Update preferences
      updatePreferences: function(value, prefs: Partial<UserProfile['preferences']>) {
        this.mutate(draft => {
          Object.assign(draft.preferences, prefs);
        });
      },

      // Nested action that calls other actions
      setupUser: function(value, userData: {
        profile: Partial<UserProfile>,
        preferences: Partial<UserProfile['preferences']>
      }) {
        this.$.updateProfile(userData.profile);
        this.$.updatePreferences(userData.preferences);
      },

      // Action with validation
      setAge: function(value, age: number) {
        if (age < 0 || age > 150) {
          throw new Error('Age must be between 0 and 150');
        }
        this.mutate(draft => {
          draft.age = age;
        });
      },

      // Complex validation example
      validateAndSave: function(value) {
        const errors: string[] = [];

        if (!value.name.trim()) {
          errors.push('Name is required');
        }
        if (!value.email.includes('@')) {
          errors.push('Valid email is required');
        }
        if (value.age < 13) {
          errors.push('Must be at least 13 years old');
        }

        if (errors.length > 0) {
          throw new Error(\`Validation failed: \${errors.join(', ')}\`);
        }

        return 'Profile saved successfully!';
      }
    },
    tests: [
      (value: UserProfile) => {
        if (typeof value.name !== 'string') {
          return 'Name must be a string';
        }
        return null;
      },
      (value: UserProfile) => {
        if (typeof value.age !== 'number') {
          return 'Age must be a number';
        }
        return null;
      }
    ],
    prep: [
      // Validation prep function - runs after any state change
      function(value: UserProfile) {
        const errors: Record<string, string | null> = {};

        // Validate name
        if (!value.name.trim()) {
          errors.name = 'Name is required';
        } else if (value.name.trim().length < 2) {
          errors.name = 'Name must be at least 2 characters';
        } else {
          errors.name = null;
        }

        // Validate age
        if (value.age < 0) {
          errors.age = 'Age cannot be negative';
        } else if (value.age > 150) {
          errors.age = 'Age cannot exceed 150 years';
        } else if (value.age > 0 && value.age < 13) {
          errors.age = 'Must be at least 13 years old';
        } else {
          errors.age = null;
        }

        // Validate email
        if (value.email && !value.email.includes('@')) {
          errors.email = 'Please enter a valid email address';
        } else {
          errors.email = null;
        }

        // Update errors object using mutate to avoid recursion
        this.mutate(draft => {
          draft.errors = errors;
        });
      }
    ]
  });
}`})}),e.jsx(Ue,{children:e.jsx(te,{snippetName:"InteractiveDemo",language:"typescript",title:"InteractiveDemo Component Source"})}),e.jsx(Ue,{children:e.jsx(te,{snippetName:"demoStoreFactory-tests",language:"typescript",ts:!0})})]})]}),e.jsxs(ne,{status:"info",mt:4,children:[e.jsx(re,{}),e.jsxs(d,{children:[e.jsx(l,{fontWeight:"semibold",children:"Live Forestry Store in Action"}),e.jsx(l,{fontSize:"sm",mt:1,children:"This demo uses useForestryLocal hook for reactive updates. Switch between tabs to see the source code and try the interactive demo."})]})]})]})}),Zr=()=>e.jsx(oe,{maxW:"6xl",py:8,children:e.jsxs(x,{spacing:12,align:"stretch",children:[e.jsxs(d,{textAlign:"center",children:[e.jsx(h,{size:"3xl",mb:6,children:"Why Forestry?"}),e.jsx(l,{textStyle:"hero",children:"Forestry is a next-generation state management library that combines the power of RxJS reactivity with TypeScript safety and an intuitive developer experience."})]}),e.jsx(Er,{}),e.jsx(Le,{}),e.jsx(Ir,{}),e.jsx("iframe",{width:"560",height:"315",src:"https://www.youtube.com/embed/bGzanfKVFeU?si=XVsdcSKOh3CcEYFm",title:"YouTube video player",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",referrerPolicy:"strict-origin-when-cross-origin",allowFullScreen:!0}),e.jsx(l,{children:"the TLDR of the above; "}),e.jsx(Le,{}),e.jsxs(d,{children:[e.jsx(h,{size:"xl",mb:6,textAlign:"center",children:"Try Forestry Live"}),e.jsx(Vr,{})]}),e.jsx(Le,{})]})});function Dr(){return new Se({name:"user-store",value:{name:"John Doe",age:30,email:"john@example.com"},actions:{onChange:function(t,n){const{name:r,value:s,type:i}=n.target,a=i==="number"?parseInt(s)||0:s;this.set(r,a)},setName:function(t,n){this.set("name",n)},setAge:function(t,n){this.set("age",n)},setEmail:function(t,n){this.set("email",n)},updateProfile:function(t,n){this.next({...t,...n})},reset:function(){this.next({name:"John Doe",age:30,email:"john@example.com"})}},tests:[t=>t.age<0?"Age cannot be negative":null,t=>t.age>150?"Age seems unrealistic":null,t=>t.email.includes("@")?null:"Invalid email format",t=>t.name.length===0?"Name cannot be empty":null]})}const Ur=[{label:"Basic Store",language:"typescript",snippet:"basicStore",folder:"StoreBasics"},{label:"With Validation",language:"typescript",snippet:"storeWithValidation",folder:"StoreBasics"},{label:"React Hook",language:"tsx",snippet:"reactHookPattern",folder:"StoreBasics"}],Lr=()=>{const[t,n]=fe(Dr),[r,s]=X.useState("");return e.jsx(oe,{maxW:"container.xl",py:8,children:e.jsxs(x,{spacing:8,align:"stretch",children:[e.jsxs(d,{children:[e.jsx(h,{size:"xl",mb:4,children:"Store Overview"}),e.jsx(l,{fontSize:"lg",color:"gray.600",children:"The Store class is the core of Forestry 4, providing reactive state management with validation and transaction support."})]}),e.jsxs(I,{title:"Store Constructor",children:[e.jsx(l,{color:"gray.600",children:"Create a new Store instance with configuration options. They are all optional except for value"}),e.jsx(d,{bg:"gray.100",p:4,borderRadius:"md",fontFamily:"mono",fontSize:"sm",children:"new Store<T>(config: StoreConfig<T>)"}),e.jsx(h,{size:"sm",children:"Config properties"}),e.jsxs(Y,{columns:{base:1,md:2},spacing:6,children:[e.jsxs(d,{children:[e.jsxs(h,{size:"md",mb:3,children:["name ",e.jsx(S,{colorScheme:"blue",children:"string"})]}),e.jsx(l,{color:"gray.600",mb:3,children:"Unique identifier for the store instance."}),e.jsx(d,{bg:"gray.50",p:3,borderRadius:"md",fontFamily:"mono",fontSize:"sm",children:"name: 'user-store'"})]}),e.jsxs(d,{children:[e.jsxs(h,{size:"md",mb:3,children:["value ",e.jsx(S,{colorScheme:"green",children:"T"})," ",e.jsx(S,{colorScheme:"red",children:"Required"})]}),e.jsx(l,{color:"gray.600",mb:3,children:"Initial state value for the store."}),e.jsx(d,{bg:"gray.50",p:3,borderRadius:"md",fontFamily:"mono",fontSize:"sm",children:`value: { 
  name: 'John', 
  age: 30 
}`})]}),e.jsxs(d,{children:[e.jsxs(h,{size:"md",mb:3,children:["actions ",e.jsx(S,{colorScheme:"purple",children:"Record<string, Function>"})]}),e.jsx(l,{color:"gray.600",mb:3,children:"Object containing action functions for state updates."}),e.jsx(d,{bg:"gray.50",p:3,borderRadius:"md",fontFamily:"mono",fontSize:"sm",children:`actions: {
  setName: (state, name) => ({ ...state, name })
}`})]}),e.jsxs(d,{children:[e.jsxs(h,{size:"md",mb:3,children:["tests ",e.jsx(S,{colorScheme:"orange",children:"Function | Function[]"})]}),e.jsx(l,{color:"gray.600",mb:3,children:"Validation function to ensure state integrity. expects candidateValue as first argument - bound to store."}),e.jsx(d,{bg:"gray.50",p:3,borderRadius:"md",fontFamily:"mono",fontSize:"sm",children:e.jsx(K,{language:"typescript",children:`tests: (candidateValue)  {
  if (candidateValue.age < 0) return 'Invalid age';
  return null; // Valid; 
  // you don't actually have to return ANYTHING for valid candidates
}`})})]})]}),e.jsxs(l,{size:"sm",children:["See ",e.jsx(B,{to:"/validation",children:"Validation"})," for more details on Vaidation parameters"]})]}),e.jsxs(I,{children:[e.jsx(h,{children:"The Forestry Lifecycle"}),e.jsx(or,{src:"/flowchart.svg",width:"full",mx:8,maxHeight:"80vh"}),e.jsx(l,{children:"The forestry state has a deep update cycle; understanding the nuances and order of how values are curated and validated is important to recognize why Forestry is more than a repackaged Redux or a RxJS decorator."})]}),e.jsx(I,{title:"Code Examples",children:e.jsx(ue,{tabs:Ur})}),e.jsxs(I,{title:"Live Example",children:[e.jsx(l,{color:"gray.600",children:"Try updating the user profile below to see validation in action:"}),e.jsxs(Y,{columns:{base:1,lg:2},spacing:8,children:[e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsx(h,{size:"md",children:"Update Profile"}),e.jsxs(Ne,{children:[e.jsx(Oe,{children:"Name"}),e.jsx(ye,{name:"name",value:t.name,onChange:n?.$.onChange})]}),e.jsxs(Ne,{children:[e.jsx(Oe,{children:"Age"}),e.jsx(ye,{name:"age",type:"number",value:t.age.toString(),onChange:n?.$.onChange})]}),e.jsxs(Ne,{children:[e.jsx(Oe,{children:"Email"}),e.jsx(ye,{name:"email",type:"email",value:t.email,onChange:n?.$.onChange})]}),e.jsx($,{children:e.jsx(R,{variant:"outline",onClick:()=>n?.$.reset(),children:"Reset to Defaults"})}),r&&e.jsxs(ne,{status:"error",children:[e.jsx(re,{}),r]})]}),e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsx(h,{size:"md",children:"Current State"}),e.jsx(d,{bg:"gray.50",p:4,borderRadius:"md",children:e.jsx("pre",{children:JSON.stringify(t,null,2)})}),e.jsxs(d,{children:[e.jsx(l,{fontWeight:"semibold",mb:2,children:"Profile Stats:"}),e.jsxs(x,{align:"start",spacing:1,fontSize:"sm",children:[e.jsxs(l,{children:["Name length: ",e.jsx(S,{children:t.name.length})]}),e.jsxs(l,{children:["Valid email:"," ",e.jsx(S,{colorScheme:t.email.includes("@")?"green":"red",children:t.email.includes("@")?"Yes":"No"})]}),e.jsxs(l,{children:["Age range:"," ",e.jsx(S,{colorScheme:t.age>=0&&t.age<=150?"green":"red",children:t.age>=0&&t.age<=150?"Valid":"Invalid"})]})]})]})]})]})]}),e.jsxs(I,{title:"Update Patterns",children:[e.jsx(l,{color:"gray.600",children:"Forestry 4 provides different methods for updating store values efficiently:"}),e.jsx(ue,{tabs:[{label:"Form onChange Handler",language:"typescript",code:`// Tactical form handler using event target name
actions: {
  onChange: function(value, event: React.ChangeEvent<HTMLInputElement>) {
    const { name, value: fieldValue, type } = event.target;
    const processedValue = type === 'number' ? parseInt(fieldValue) || 0 : fieldValue;
    this.set(name, processedValue);  // Uses field name to update correct property
  }
}

// Usage in JSX - actions are pre-bound, no wrapper needed:
<Input name="age" type="number" value={state.age} onChange={store.$.onChange} />
<Input name="email" value={state.email} onChange={store.$.onChange} />`},{label:"Single Field Updates",language:"typescript",code:`// Use set() for single field updates - most efficient
actions: {
  setName: function(value, name: string) {
    this.set('name', name);  // Updates only the name field
  },
  setAge: function(value, age: number) {
    this.set('age', age);    // Updates only the age field
  },
  // For nested paths
  setTheme: function(value, theme: string) {
    this.set('preferences.theme', theme);  // Deep path update
  }
}`},{label:"Multiple Field Updates",language:"typescript",code:`// Use next() for multiple field updates
actions: {
  updateProfile: function(value, updates: Partial<UserState>) {
    this.next({ ...value, ...updates });  // Merge multiple fields
  },
  reset: function() {
    this.next({  // Replace entire value
      name: 'John Doe',
      age: 30,
      email: 'john@example.com'
    });
  }
}`},{label:"Complex Updates",language:"typescript",code:`// Use mutate() for complex transformations
actions: {
  addTag: function(value, tag: string) {
    this.mutate(draft => {
      draft.tags.push(tag);  // Immer-powered mutations
    });
  },
  updateNestedSettings: function(value, settings: any) {
    this.mutate(draft => {
      Object.assign(draft.profile.settings, settings);
    }, 'profile');  // Mutate specific path
  }
}`},{label:"Validation Patterns",language:"typescript",code:`// Use arrays of test functions for clean validation
tests: [
  (value) => value.age < 0 ? 'Age cannot be negative' : null,
  (value) => value.age > 150 ? 'Age seems unrealistic' : null,
  (value) => !value.email.includes('@') ? 'Invalid email format' : null,
  (value) => value.name.length === 0 ? 'Name cannot be empty' : null,
]`}]})]}),e.jsxs(I,{title:"Live Example Source Code",children:[e.jsx(l,{color:"gray.600",children:"Here's the complete source code for the user profile demo above:"}),e.jsx(ue,{tabs:[{label:"Store Definition",language:"typescript",code:`const userStore = new Store<UserState>({
  name: 'user-store',
  value: {
    name: 'John Doe',
    age: 30,
    email: 'john@example.com',
  },
  actions: {
    // Tactical form handler
    onChange: function(value: UserState, event: React.ChangeEvent<HTMLInputElement>) {
      const { name, value: fieldValue, type } = event.target;
      const processedValue = type === 'number' ? parseInt(fieldValue) || 0 : fieldValue;
      this.set(name, processedValue);
    },
    setName: function(value: UserState, name: string) {
      this.set('name', name);
    },
    setAge: function(value: UserState, age: number) {
      this.set('age', age);
    },
    setEmail: function(value: UserState, email: string) {
      this.set('email', email);
    },
    updateProfile: function(value: UserState, profile: Partial<UserState>) {
      this.next({ ...value, ...profile });
    },
    reset: function() {
      this.next({
        name: 'John Doe',
        age: 30,
        email: 'john@example.com',
      });
    },
  },
  tests: [
    (value: UserState) => value.age < 0 ? 'Age cannot be negative' : null,
    (value: UserState) => value.age > 150 ? 'Age seems unrealistic' : null,
    (value: UserState) => !value.email.includes('@') ? 'Invalid email format' : null,
    (value: UserState) => value.name.length === 0 ? 'Name cannot be empty' : null,
  ],
})`},{label:"React Integration",language:"tsx",code:`const [userState, setUserState] = useState<UserState>({ name: '', age: 0, email: '' })
const [error, setError] = useState('')

useEffect(() => {
  const subscription = userStore.subscribe((state) => {
    setUserState(state)
    setError('')
  })

  return () => {
    subscription.unsubscribe()
  }
}, [])

// No separate form state needed - store handles everything!`},{label:"Form Component",language:"tsx",code:`<FormControl>
  <FormLabel>Name</FormLabel>
  <Input
    name="name"
    value={userState.name}
    onChange={store.$.onChange}
  />
</FormControl>

<FormControl>
  <FormLabel>Age</FormLabel>
  <Input
    name="age"
    type="number"
    value={userState.age.toString()}
    onChange={store.$.onChange}
  />
</FormControl>

<FormControl>
  <FormLabel>Email</FormLabel>
  <Input
    name="email"
    type="email"
    value={userState.email}
    onChange={store.$.onChange}
  />
</FormControl>

<Button variant="outline" onClick={() => store?.$.reset()}>
  Reset to Defaults
</Button>

{error && (
  <Alert status="error">
    <AlertIcon />
    {error}
  </Alert>
)}`}]})]})]})})};function p(t,n,r){function s(c,u){var y;Object.defineProperty(c,"_zod",{value:c._zod??{},enumerable:!1}),(y=c._zod).traits??(y.traits=new Set),c._zod.traits.add(t),n(c,u);for(const F in o.prototype)F in c||Object.defineProperty(c,F,{value:o.prototype[F].bind(c)});c._zod.constr=o,c._zod.def=u}const i=r?.Parent??Object;class a extends i{}Object.defineProperty(a,"name",{value:t});function o(c){var u;const y=r?.Parent?new a:this;s(y,c),(u=y._zod).deferred??(u.deferred=[]);for(const F of y._zod.deferred)F();return y}return Object.defineProperty(o,"init",{value:s}),Object.defineProperty(o,Symbol.hasInstance,{value:c=>r?.Parent&&c instanceof r.Parent?!0:c?._zod?.traits?.has(t)}),Object.defineProperty(o,"name",{value:t}),o}class Ee extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class jn extends Error{constructor(n){super(`Encountered unidirectional transform during encode: ${n}`),this.name="ZodEncodeError"}}const bn={};function ke(t){return bn}function Nr(t){const n=Object.values(t).filter(s=>typeof s=="number");return Object.entries(t).filter(([s,i])=>n.indexOf(+s)===-1).map(([s,i])=>i)}function xt(t,n){return typeof n=="bigint"?n.toString():n}function St(t){return{get value(){{const n=t();return Object.defineProperty(this,"value",{value:n}),n}}}}function wt(t){return t==null}function zt(t){const n=t.startsWith("^")?1:0,r=t.endsWith("$")?t.length-1:t.length;return t.slice(n,r)}function Or(t,n){const r=(t.toString().split(".")[1]||"").length,s=n.toString();let i=(s.split(".")[1]||"").length;if(i===0&&/\d?e-\d?/.test(s)){const u=s.match(/\d?e-(\d?)/);u?.[1]&&(i=Number.parseInt(u[1]))}const a=r>i?r:i,o=Number.parseInt(t.toFixed(a).replace(".","")),c=Number.parseInt(n.toFixed(a).replace(".",""));return o%c/10**a}const Ut=Symbol("evaluating");function L(t,n,r){let s;Object.defineProperty(t,n,{get(){if(s!==Ut)return s===void 0&&(s=Ut,s=r()),s},set(i){Object.defineProperty(t,n,{value:i})},configurable:!0})}function Mr(t){return Object.create(Object.getPrototypeOf(t),Object.getOwnPropertyDescriptors(t))}function we(t,n,r){Object.defineProperty(t,n,{value:r,writable:!0,enumerable:!0,configurable:!0})}function Pe(...t){const n={};for(const r of t){const s=Object.getOwnPropertyDescriptors(r);Object.assign(n,s)}return Object.defineProperties({},n)}function Lt(t){return JSON.stringify(t)}const yn="captureStackTrace"in Error?Error.captureStackTrace:(...t)=>{};function nt(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}const Br=St(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const t=Function;return new t(""),!0}catch{return!1}});function Me(t){if(nt(t)===!1)return!1;const n=t.constructor;if(n===void 0)return!0;const r=n.prototype;return!(nt(r)===!1||Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===!1)}function vn(t){return Me(t)?{...t}:Array.isArray(t)?[...t]:t}const Wr=new Set(["string","number","symbol"]);function it(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ze(t,n,r){const s=new t._zod.constr(n??t._zod.def);return(!n||r?.parent)&&(s._zod.parent=t),s}function k(t){const n=t;if(!n)return{};if(typeof n=="string")return{error:()=>n};if(n?.message!==void 0){if(n?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");n.error=n.message}return delete n.message,typeof n.error=="string"?{...n,error:()=>n.error}:n}function Hr(t){return Object.keys(t).filter(n=>t[n]._zod.optin==="optional"&&t[n]._zod.optout==="optional")}const qr={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function Gr(t,n){const r=t._zod.def,s=Pe(t._zod.def,{get shape(){const i={};for(const a in n){if(!(a in r.shape))throw new Error(`Unrecognized key: "${a}"`);n[a]&&(i[a]=r.shape[a])}return we(this,"shape",i),i},checks:[]});return ze(t,s)}function Jr(t,n){const r=t._zod.def,s=Pe(t._zod.def,{get shape(){const i={...t._zod.def.shape};for(const a in n){if(!(a in r.shape))throw new Error(`Unrecognized key: "${a}"`);n[a]&&delete i[a]}return we(this,"shape",i),i},checks:[]});return ze(t,s)}function Kr(t,n){if(!Me(n))throw new Error("Invalid input to extend: expected a plain object");const r=t._zod.def.checks;if(r&&r.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const i=Pe(t._zod.def,{get shape(){const a={...t._zod.def.shape,...n};return we(this,"shape",a),a},checks:[]});return ze(t,i)}function Yr(t,n){if(!Me(n))throw new Error("Invalid input to safeExtend: expected a plain object");const r={...t._zod.def,get shape(){const s={...t._zod.def.shape,...n};return we(this,"shape",s),s},checks:t._zod.def.checks};return ze(t,r)}function Qr(t,n){const r=Pe(t._zod.def,{get shape(){const s={...t._zod.def.shape,...n._zod.def.shape};return we(this,"shape",s),s},get catchall(){return n._zod.def.catchall},checks:[]});return ze(t,r)}function Xr(t,n,r){const s=Pe(n._zod.def,{get shape(){const i=n._zod.def.shape,a={...i};if(r)for(const o in r){if(!(o in i))throw new Error(`Unrecognized key: "${o}"`);r[o]&&(a[o]=t?new t({type:"optional",innerType:i[o]}):i[o])}else for(const o in i)a[o]=t?new t({type:"optional",innerType:i[o]}):i[o];return we(this,"shape",a),a},checks:[]});return ze(n,s)}function es(t,n,r){const s=Pe(n._zod.def,{get shape(){const i=n._zod.def.shape,a={...i};if(r)for(const o in r){if(!(o in a))throw new Error(`Unrecognized key: "${o}"`);r[o]&&(a[o]=new t({type:"nonoptional",innerType:i[o]}))}else for(const o in i)a[o]=new t({type:"nonoptional",innerType:i[o]});return we(this,"shape",a),a},checks:[]});return ze(n,s)}function $e(t,n=0){if(t.aborted===!0)return!0;for(let r=n;r<t.issues.length;r++)if(t.issues[r]?.continue!==!0)return!0;return!1}function Sn(t,n){return n.map(r=>{var s;return(s=r).path??(s.path=[]),r.path.unshift(t),r})}function Qe(t){return typeof t=="string"?t:t?.message}function Te(t,n,r){const s={...t,path:t.path??[]};if(!t.message){const i=Qe(t.inst?._zod.def?.error?.(t))??Qe(n?.error?.(t))??Qe(r.customError?.(t))??Qe(r.localeError?.(t))??"Invalid input";s.message=i}return delete s.inst,delete s.continue,n?.reportInput||delete s.input,s}function Ft(t){return Array.isArray(t)?"array":typeof t=="string"?"string":"unknown"}function Be(...t){const[n,r,s]=t;return typeof n=="string"?{message:n,code:"custom",input:r,inst:s}:{...n}}const wn=(t,n)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:n,enumerable:!1}),t.message=JSON.stringify(n,xt,2),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},zn=p("$ZodError",wn),Fn=p("$ZodError",wn,{Parent:Error});function ts(t,n=r=>r.message){const r={},s=[];for(const i of t.issues)i.path.length>0?(r[i.path[0]]=r[i.path[0]]||[],r[i.path[0]].push(n(i))):s.push(n(i));return{formErrors:s,fieldErrors:r}}function ns(t,n){const r=n||function(a){return a.message},s={_errors:[]},i=a=>{for(const o of a.issues)if(o.code==="invalid_union"&&o.errors.length)o.errors.map(c=>i({issues:c}));else if(o.code==="invalid_key")i({issues:o.issues});else if(o.code==="invalid_element")i({issues:o.issues});else if(o.path.length===0)s._errors.push(r(o));else{let c=s,u=0;for(;u<o.path.length;){const y=o.path[u];u===o.path.length-1?(c[y]=c[y]||{_errors:[]},c[y]._errors.push(r(o))):c[y]=c[y]||{_errors:[]},c=c[y],u++}}};return i(t),s}const At=t=>(n,r,s,i)=>{const a=s?Object.assign(s,{async:!1}):{async:!1},o=n._zod.run({value:r,issues:[]},a);if(o instanceof Promise)throw new Ee;if(o.issues.length){const c=new(i?.Err??t)(o.issues.map(u=>Te(u,a,ke())));throw yn(c,i?.callee),c}return o.value},Ct=t=>async(n,r,s,i)=>{const a=s?Object.assign(s,{async:!0}):{async:!0};let o=n._zod.run({value:r,issues:[]},a);if(o instanceof Promise&&(o=await o),o.issues.length){const c=new(i?.Err??t)(o.issues.map(u=>Te(u,a,ke())));throw yn(c,i?.callee),c}return o.value},at=t=>(n,r,s)=>{const i=s?{...s,async:!1}:{async:!1},a=n._zod.run({value:r,issues:[]},i);if(a instanceof Promise)throw new Ee;return a.issues.length?{success:!1,error:new(t??zn)(a.issues.map(o=>Te(o,i,ke())))}:{success:!0,data:a.value}},rs=at(Fn),ot=t=>async(n,r,s)=>{const i=s?Object.assign(s,{async:!0}):{async:!0};let a=n._zod.run({value:r,issues:[]},i);return a instanceof Promise&&(a=await a),a.issues.length?{success:!1,error:new t(a.issues.map(o=>Te(o,i,ke())))}:{success:!0,data:a.value}},ss=ot(Fn),is=t=>(n,r,s)=>{const i=s?Object.assign(s,{direction:"backward"}):{direction:"backward"};return At(t)(n,r,i)},as=t=>(n,r,s)=>At(t)(n,r,s),os=t=>async(n,r,s)=>{const i=s?Object.assign(s,{direction:"backward"}):{direction:"backward"};return Ct(t)(n,r,i)},ls=t=>async(n,r,s)=>Ct(t)(n,r,s),cs=t=>(n,r,s)=>{const i=s?Object.assign(s,{direction:"backward"}):{direction:"backward"};return at(t)(n,r,i)},ds=t=>(n,r,s)=>at(t)(n,r,s),us=t=>async(n,r,s)=>{const i=s?Object.assign(s,{direction:"backward"}):{direction:"backward"};return ot(t)(n,r,i)},hs=t=>async(n,r,s)=>ot(t)(n,r,s),ms=/^[cC][^\s-]{8,}$/,ps=/^[0-9a-z]+$/,gs=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,fs=/^[0-9a-vA-V]{20}$/,xs=/^[A-Za-z0-9]{27}$/,js=/^[a-zA-Z0-9_-]{21}$/,bs=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,ys=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Nt=t=>t?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${t}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,vs=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,Ss="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function ws(){return new RegExp(Ss,"u")}const zs=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Fs=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,As=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,Cs=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,ks=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,An=/^[A-Za-z0-9_-]*$/,Ts=/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,_s=/^\+(?:[0-9]){6,14}[0-9]$/,Cn="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",$s=new RegExp(`^${Cn}$`);function kn(t){const n="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof t.precision=="number"?t.precision===-1?`${n}`:t.precision===0?`${n}:[0-5]\\d`:`${n}:[0-5]\\d\\.\\d{${t.precision}}`:`${n}(?::[0-5]\\d(?:\\.\\d+)?)?`}function Is(t){return new RegExp(`^${kn(t)}$`)}function Es(t){const n=kn({precision:t.precision}),r=["Z"];t.local&&r.push(""),t.offset&&r.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const s=`${n}(?:${r.join("|")})`;return new RegExp(`^${Cn}T(?:${s})$`)}const Ps=t=>{const n=t?`[\\s\\S]{${t?.minimum??0},${t?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${n}$`)},Rs=/^-?\d+$/,Vs=/^-?\d+(?:\.\d+)?/,Zs=/^[^A-Z]*$/,Ds=/^[^a-z]*$/,le=p("$ZodCheck",(t,n)=>{var r;t._zod??(t._zod={}),t._zod.def=n,(r=t._zod).onattach??(r.onattach=[])}),Tn={number:"number",bigint:"bigint",object:"date"},_n=p("$ZodCheckLessThan",(t,n)=>{le.init(t,n);const r=Tn[typeof n.value];t._zod.onattach.push(s=>{const i=s._zod.bag,a=(n.inclusive?i.maximum:i.exclusiveMaximum)??Number.POSITIVE_INFINITY;n.value<a&&(n.inclusive?i.maximum=n.value:i.exclusiveMaximum=n.value)}),t._zod.check=s=>{(n.inclusive?s.value<=n.value:s.value<n.value)||s.issues.push({origin:r,code:"too_big",maximum:n.value,input:s.value,inclusive:n.inclusive,inst:t,continue:!n.abort})}}),$n=p("$ZodCheckGreaterThan",(t,n)=>{le.init(t,n);const r=Tn[typeof n.value];t._zod.onattach.push(s=>{const i=s._zod.bag,a=(n.inclusive?i.minimum:i.exclusiveMinimum)??Number.NEGATIVE_INFINITY;n.value>a&&(n.inclusive?i.minimum=n.value:i.exclusiveMinimum=n.value)}),t._zod.check=s=>{(n.inclusive?s.value>=n.value:s.value>n.value)||s.issues.push({origin:r,code:"too_small",minimum:n.value,input:s.value,inclusive:n.inclusive,inst:t,continue:!n.abort})}}),Us=p("$ZodCheckMultipleOf",(t,n)=>{le.init(t,n),t._zod.onattach.push(r=>{var s;(s=r._zod.bag).multipleOf??(s.multipleOf=n.value)}),t._zod.check=r=>{if(typeof r.value!=typeof n.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof r.value=="bigint"?r.value%n.value===BigInt(0):Or(r.value,n.value)===0)||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:n.value,input:r.value,inst:t,continue:!n.abort})}}),Ls=p("$ZodCheckNumberFormat",(t,n)=>{le.init(t,n),n.format=n.format||"float64";const r=n.format?.includes("int"),s=r?"int":"number",[i,a]=qr[n.format];t._zod.onattach.push(o=>{const c=o._zod.bag;c.format=n.format,c.minimum=i,c.maximum=a,r&&(c.pattern=Rs)}),t._zod.check=o=>{const c=o.value;if(r){if(!Number.isInteger(c)){o.issues.push({expected:s,format:n.format,code:"invalid_type",continue:!1,input:c,inst:t});return}if(!Number.isSafeInteger(c)){c>0?o.issues.push({input:c,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:s,continue:!n.abort}):o.issues.push({input:c,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:s,continue:!n.abort});return}}c<i&&o.issues.push({origin:"number",input:c,code:"too_small",minimum:i,inclusive:!0,inst:t,continue:!n.abort}),c>a&&o.issues.push({origin:"number",input:c,code:"too_big",maximum:a,inst:t})}}),Ns=p("$ZodCheckMaxLength",(t,n)=>{var r;le.init(t,n),(r=t._zod.def).when??(r.when=s=>{const i=s.value;return!wt(i)&&i.length!==void 0}),t._zod.onattach.push(s=>{const i=s._zod.bag.maximum??Number.POSITIVE_INFINITY;n.maximum<i&&(s._zod.bag.maximum=n.maximum)}),t._zod.check=s=>{const i=s.value;if(i.length<=n.maximum)return;const o=Ft(i);s.issues.push({origin:o,code:"too_big",maximum:n.maximum,inclusive:!0,input:i,inst:t,continue:!n.abort})}}),Os=p("$ZodCheckMinLength",(t,n)=>{var r;le.init(t,n),(r=t._zod.def).when??(r.when=s=>{const i=s.value;return!wt(i)&&i.length!==void 0}),t._zod.onattach.push(s=>{const i=s._zod.bag.minimum??Number.NEGATIVE_INFINITY;n.minimum>i&&(s._zod.bag.minimum=n.minimum)}),t._zod.check=s=>{const i=s.value;if(i.length>=n.minimum)return;const o=Ft(i);s.issues.push({origin:o,code:"too_small",minimum:n.minimum,inclusive:!0,input:i,inst:t,continue:!n.abort})}}),Ms=p("$ZodCheckLengthEquals",(t,n)=>{var r;le.init(t,n),(r=t._zod.def).when??(r.when=s=>{const i=s.value;return!wt(i)&&i.length!==void 0}),t._zod.onattach.push(s=>{const i=s._zod.bag;i.minimum=n.length,i.maximum=n.length,i.length=n.length}),t._zod.check=s=>{const i=s.value,a=i.length;if(a===n.length)return;const o=Ft(i),c=a>n.length;s.issues.push({origin:o,...c?{code:"too_big",maximum:n.length}:{code:"too_small",minimum:n.length},inclusive:!0,exact:!0,input:s.value,inst:t,continue:!n.abort})}}),lt=p("$ZodCheckStringFormat",(t,n)=>{var r,s;le.init(t,n),t._zod.onattach.push(i=>{const a=i._zod.bag;a.format=n.format,n.pattern&&(a.patterns??(a.patterns=new Set),a.patterns.add(n.pattern))}),n.pattern?(r=t._zod).check??(r.check=i=>{n.pattern.lastIndex=0,!n.pattern.test(i.value)&&i.issues.push({origin:"string",code:"invalid_format",format:n.format,input:i.value,...n.pattern?{pattern:n.pattern.toString()}:{},inst:t,continue:!n.abort})}):(s=t._zod).check??(s.check=()=>{})}),Bs=p("$ZodCheckRegex",(t,n)=>{lt.init(t,n),t._zod.check=r=>{n.pattern.lastIndex=0,!n.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:n.pattern.toString(),inst:t,continue:!n.abort})}}),Ws=p("$ZodCheckLowerCase",(t,n)=>{n.pattern??(n.pattern=Zs),lt.init(t,n)}),Hs=p("$ZodCheckUpperCase",(t,n)=>{n.pattern??(n.pattern=Ds),lt.init(t,n)}),qs=p("$ZodCheckIncludes",(t,n)=>{le.init(t,n);const r=it(n.includes),s=new RegExp(typeof n.position=="number"?`^.{${n.position}}${r}`:r);n.pattern=s,t._zod.onattach.push(i=>{const a=i._zod.bag;a.patterns??(a.patterns=new Set),a.patterns.add(s)}),t._zod.check=i=>{i.value.includes(n.includes,n.position)||i.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:n.includes,input:i.value,inst:t,continue:!n.abort})}}),Gs=p("$ZodCheckStartsWith",(t,n)=>{le.init(t,n);const r=new RegExp(`^${it(n.prefix)}.*`);n.pattern??(n.pattern=r),t._zod.onattach.push(s=>{const i=s._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(r)}),t._zod.check=s=>{s.value.startsWith(n.prefix)||s.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:n.prefix,input:s.value,inst:t,continue:!n.abort})}}),Js=p("$ZodCheckEndsWith",(t,n)=>{le.init(t,n);const r=new RegExp(`.*${it(n.suffix)}$`);n.pattern??(n.pattern=r),t._zod.onattach.push(s=>{const i=s._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(r)}),t._zod.check=s=>{s.value.endsWith(n.suffix)||s.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:n.suffix,input:s.value,inst:t,continue:!n.abort})}}),Ks=p("$ZodCheckOverwrite",(t,n)=>{le.init(t,n),t._zod.check=r=>{r.value=n.tx(r.value)}});class Ys{constructor(n=[]){this.content=[],this.indent=0,this&&(this.args=n)}indented(n){this.indent+=1,n(this),this.indent-=1}write(n){if(typeof n=="function"){n(this,{execution:"sync"}),n(this,{execution:"async"});return}const s=n.split(`
`).filter(o=>o),i=Math.min(...s.map(o=>o.length-o.trimStart().length)),a=s.map(o=>o.slice(i)).map(o=>" ".repeat(this.indent*2)+o);for(const o of a)this.content.push(o)}compile(){const n=Function,r=this?.args,i=[...(this?.content??[""]).map(a=>`  ${a}`)];return new n(...r,i.join(`
`))}}const Qs={major:4,minor:1,patch:8},Q=p("$ZodType",(t,n)=>{var r;t??(t={}),t._zod.def=n,t._zod.bag=t._zod.bag||{},t._zod.version=Qs;const s=[...t._zod.def.checks??[]];t._zod.traits.has("$ZodCheck")&&s.unshift(t);for(const i of s)for(const a of i._zod.onattach)a(t);if(s.length===0)(r=t._zod).deferred??(r.deferred=[]),t._zod.deferred?.push(()=>{t._zod.run=t._zod.parse});else{const i=(o,c,u)=>{let y=$e(o),F;for(const C of c){if(C._zod.def.when){if(!C._zod.def.when(o))continue}else if(y)continue;const V=o.issues.length,E=C._zod.check(o);if(E instanceof Promise&&u?.async===!1)throw new Ee;if(F||E instanceof Promise)F=(F??Promise.resolve()).then(async()=>{await E,o.issues.length!==V&&(y||(y=$e(o,V)))});else{if(o.issues.length===V)continue;y||(y=$e(o,V))}}return F?F.then(()=>o):o},a=(o,c,u)=>{if($e(o))return o.aborted=!0,o;const y=i(c,s,u);if(y instanceof Promise){if(u.async===!1)throw new Ee;return y.then(F=>t._zod.parse(F,u))}return t._zod.parse(y,u)};t._zod.run=(o,c)=>{if(c.skipChecks)return t._zod.parse(o,c);if(c.direction==="backward"){const y=t._zod.parse({value:o.value,issues:[]},{...c,skipChecks:!0});return y instanceof Promise?y.then(F=>a(F,o,c)):a(y,o,c)}const u=t._zod.parse(o,c);if(u instanceof Promise){if(c.async===!1)throw new Ee;return u.then(y=>i(y,s,c))}return i(u,s,c)}}t["~standard"]={validate:i=>{try{const a=rs(t,i);return a.success?{value:a.data}:{issues:a.error?.issues}}catch{return ss(t,i).then(o=>o.success?{value:o.data}:{issues:o.error?.issues})}},vendor:"zod",version:1}}),kt=p("$ZodString",(t,n)=>{Q.init(t,n),t._zod.pattern=[...t?._zod.bag?.patterns??[]].pop()??Ps(t._zod.bag),t._zod.parse=(r,s)=>{if(n.coerce)try{r.value=String(r.value)}catch{}return typeof r.value=="string"||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:t}),r}}),M=p("$ZodStringFormat",(t,n)=>{lt.init(t,n),kt.init(t,n)}),Xs=p("$ZodGUID",(t,n)=>{n.pattern??(n.pattern=ys),M.init(t,n)}),ei=p("$ZodUUID",(t,n)=>{if(n.version){const s={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[n.version];if(s===void 0)throw new Error(`Invalid UUID version: "${n.version}"`);n.pattern??(n.pattern=Nt(s))}else n.pattern??(n.pattern=Nt());M.init(t,n)}),ti=p("$ZodEmail",(t,n)=>{n.pattern??(n.pattern=vs),M.init(t,n)}),ni=p("$ZodURL",(t,n)=>{M.init(t,n),t._zod.check=r=>{try{const s=r.value.trim(),i=new URL(s);n.hostname&&(n.hostname.lastIndex=0,n.hostname.test(i.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:Ts.source,input:r.value,inst:t,continue:!n.abort})),n.protocol&&(n.protocol.lastIndex=0,n.protocol.test(i.protocol.endsWith(":")?i.protocol.slice(0,-1):i.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:n.protocol.source,input:r.value,inst:t,continue:!n.abort})),n.normalize?r.value=i.href:r.value=s;return}catch{r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:t,continue:!n.abort})}}}),ri=p("$ZodEmoji",(t,n)=>{n.pattern??(n.pattern=ws()),M.init(t,n)}),si=p("$ZodNanoID",(t,n)=>{n.pattern??(n.pattern=js),M.init(t,n)}),ii=p("$ZodCUID",(t,n)=>{n.pattern??(n.pattern=ms),M.init(t,n)}),ai=p("$ZodCUID2",(t,n)=>{n.pattern??(n.pattern=ps),M.init(t,n)}),oi=p("$ZodULID",(t,n)=>{n.pattern??(n.pattern=gs),M.init(t,n)}),li=p("$ZodXID",(t,n)=>{n.pattern??(n.pattern=fs),M.init(t,n)}),ci=p("$ZodKSUID",(t,n)=>{n.pattern??(n.pattern=xs),M.init(t,n)}),di=p("$ZodISODateTime",(t,n)=>{n.pattern??(n.pattern=Es(n)),M.init(t,n)}),ui=p("$ZodISODate",(t,n)=>{n.pattern??(n.pattern=$s),M.init(t,n)}),hi=p("$ZodISOTime",(t,n)=>{n.pattern??(n.pattern=Is(n)),M.init(t,n)}),mi=p("$ZodISODuration",(t,n)=>{n.pattern??(n.pattern=bs),M.init(t,n)}),pi=p("$ZodIPv4",(t,n)=>{n.pattern??(n.pattern=zs),M.init(t,n),t._zod.onattach.push(r=>{const s=r._zod.bag;s.format="ipv4"})}),gi=p("$ZodIPv6",(t,n)=>{n.pattern??(n.pattern=Fs),M.init(t,n),t._zod.onattach.push(r=>{const s=r._zod.bag;s.format="ipv6"}),t._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:t,continue:!n.abort})}}}),fi=p("$ZodCIDRv4",(t,n)=>{n.pattern??(n.pattern=As),M.init(t,n)}),xi=p("$ZodCIDRv6",(t,n)=>{n.pattern??(n.pattern=Cs),M.init(t,n),t._zod.check=r=>{const s=r.value.split("/");try{if(s.length!==2)throw new Error;const[i,a]=s;if(!a)throw new Error;const o=Number(a);if(`${o}`!==a)throw new Error;if(o<0||o>128)throw new Error;new URL(`http://[${i}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:t,continue:!n.abort})}}});function In(t){if(t==="")return!0;if(t.length%4!==0)return!1;try{return atob(t),!0}catch{return!1}}const ji=p("$ZodBase64",(t,n)=>{n.pattern??(n.pattern=ks),M.init(t,n),t._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64"}),t._zod.check=r=>{In(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:t,continue:!n.abort})}});function bi(t){if(!An.test(t))return!1;const n=t.replace(/[-_]/g,s=>s==="-"?"+":"/"),r=n.padEnd(Math.ceil(n.length/4)*4,"=");return In(r)}const yi=p("$ZodBase64URL",(t,n)=>{n.pattern??(n.pattern=An),M.init(t,n),t._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64url"}),t._zod.check=r=>{bi(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:t,continue:!n.abort})}}),vi=p("$ZodE164",(t,n)=>{n.pattern??(n.pattern=_s),M.init(t,n)});function Si(t,n=null){try{const r=t.split(".");if(r.length!==3)return!1;const[s]=r;if(!s)return!1;const i=JSON.parse(atob(s));return!("typ"in i&&i?.typ!=="JWT"||!i.alg||n&&(!("alg"in i)||i.alg!==n))}catch{return!1}}const wi=p("$ZodJWT",(t,n)=>{M.init(t,n),t._zod.check=r=>{Si(r.value,n.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:t,continue:!n.abort})}}),En=p("$ZodNumber",(t,n)=>{Q.init(t,n),t._zod.pattern=t._zod.bag.pattern??Vs,t._zod.parse=(r,s)=>{if(n.coerce)try{r.value=Number(r.value)}catch{}const i=r.value;if(typeof i=="number"&&!Number.isNaN(i)&&Number.isFinite(i))return r;const a=typeof i=="number"?Number.isNaN(i)?"NaN":Number.isFinite(i)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:i,inst:t,...a?{received:a}:{}}),r}}),zi=p("$ZodNumber",(t,n)=>{Ls.init(t,n),En.init(t,n)}),Fi=p("$ZodUnknown",(t,n)=>{Q.init(t,n),t._zod.parse=r=>r}),Ai=p("$ZodNever",(t,n)=>{Q.init(t,n),t._zod.parse=(r,s)=>(r.issues.push({expected:"never",code:"invalid_type",input:r.value,inst:t}),r)});function Ot(t,n,r){t.issues.length&&n.issues.push(...Sn(r,t.issues)),n.value[r]=t.value}const Ci=p("$ZodArray",(t,n)=>{Q.init(t,n),t._zod.parse=(r,s)=>{const i=r.value;if(!Array.isArray(i))return r.issues.push({expected:"array",code:"invalid_type",input:i,inst:t}),r;r.value=Array(i.length);const a=[];for(let o=0;o<i.length;o++){const c=i[o],u=n.element._zod.run({value:c,issues:[]},s);u instanceof Promise?a.push(u.then(y=>Ot(y,r,o))):Ot(u,r,o)}return a.length?Promise.all(a).then(()=>r):r}});function rt(t,n,r,s){t.issues.length&&n.issues.push(...Sn(r,t.issues)),t.value===void 0?r in s&&(n.value[r]=void 0):n.value[r]=t.value}function Pn(t){const n=Object.keys(t.shape);for(const s of n)if(!t.shape?.[s]?._zod?.traits?.has("$ZodType"))throw new Error(`Invalid element at key "${s}": expected a Zod schema`);const r=Hr(t.shape);return{...t,keys:n,keySet:new Set(n),numKeys:n.length,optionalKeys:new Set(r)}}function Rn(t,n,r,s,i,a){const o=[],c=i.keySet,u=i.catchall._zod,y=u.def.type;for(const F of Object.keys(n)){if(c.has(F))continue;if(y==="never"){o.push(F);continue}const C=u.run({value:n[F],issues:[]},s);C instanceof Promise?t.push(C.then(V=>rt(V,r,F,n))):rt(C,r,F,n)}return o.length&&r.issues.push({code:"unrecognized_keys",keys:o,input:n,inst:a}),t.length?Promise.all(t).then(()=>r):r}const ki=p("$ZodObject",(t,n)=>{Q.init(t,n);const r=St(()=>Pn(n));L(t._zod,"propValues",()=>{const o=n.shape,c={};for(const u in o){const y=o[u]._zod;if(y.values){c[u]??(c[u]=new Set);for(const F of y.values)c[u].add(F)}}return c});const s=nt,i=n.catchall;let a;t._zod.parse=(o,c)=>{a??(a=r.value);const u=o.value;if(!s(u))return o.issues.push({expected:"object",code:"invalid_type",input:u,inst:t}),o;o.value={};const y=[],F=a.shape;for(const C of a.keys){const E=F[C]._zod.run({value:u[C],issues:[]},c);E instanceof Promise?y.push(E.then(U=>rt(U,o,C,u))):rt(E,o,C,u)}return i?Rn(y,u,o,c,r.value,t):y.length?Promise.all(y).then(()=>o):o}}),Ti=p("$ZodObjectJIT",(t,n)=>{ki.init(t,n);const r=t._zod.parse,s=St(()=>Pn(n)),i=V=>{const E=new Ys(["shape","payload","ctx"]),U=s.value,H=m=>{const j=Lt(m);return`shape[${j}]._zod.run({ value: input[${j}], issues: [] }, ctx)`};E.write("const input = payload.value;");const D=Object.create(null);let J=0;for(const m of U.keys)D[m]=`key_${J++}`;E.write("const newResult = {};");for(const m of U.keys){const j=D[m],v=Lt(m);E.write(`const ${j} = ${H(m)};`),E.write(`
        if (${j}.issues.length) {
          payload.issues = payload.issues.concat(${j}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${v}, ...iss.path] : [${v}]
          })));
        }
        
        
        if (${j}.value === undefined) {
          if (${v} in input) {
            newResult[${v}] = undefined;
          }
        } else {
          newResult[${v}] = ${j}.value;
        }
        
      `)}E.write("payload.value = newResult;"),E.write("return payload;");const f=E.compile();return(m,j)=>f(V,m,j)};let a;const o=nt,c=!bn.jitless,y=c&&Br.value,F=n.catchall;let C;t._zod.parse=(V,E)=>{C??(C=s.value);const U=V.value;return o(U)?c&&y&&E?.async===!1&&E.jitless!==!0?(a||(a=i(n.shape)),V=a(V,E),F?Rn([],U,V,E,C,t):V):r(V,E):(V.issues.push({expected:"object",code:"invalid_type",input:U,inst:t}),V)}});function Mt(t,n,r,s){for(const a of t)if(a.issues.length===0)return n.value=a.value,n;const i=t.filter(a=>!$e(a));return i.length===1?(n.value=i[0].value,i[0]):(n.issues.push({code:"invalid_union",input:n.value,inst:r,errors:t.map(a=>a.issues.map(o=>Te(o,s,ke())))}),n)}const _i=p("$ZodUnion",(t,n)=>{Q.init(t,n),L(t._zod,"optin",()=>n.options.some(i=>i._zod.optin==="optional")?"optional":void 0),L(t._zod,"optout",()=>n.options.some(i=>i._zod.optout==="optional")?"optional":void 0),L(t._zod,"values",()=>{if(n.options.every(i=>i._zod.values))return new Set(n.options.flatMap(i=>Array.from(i._zod.values)))}),L(t._zod,"pattern",()=>{if(n.options.every(i=>i._zod.pattern)){const i=n.options.map(a=>a._zod.pattern);return new RegExp(`^(${i.map(a=>zt(a.source)).join("|")})$`)}});const r=n.options.length===1,s=n.options[0]._zod.run;t._zod.parse=(i,a)=>{if(r)return s(i,a);let o=!1;const c=[];for(const u of n.options){const y=u._zod.run({value:i.value,issues:[]},a);if(y instanceof Promise)c.push(y),o=!0;else{if(y.issues.length===0)return y;c.push(y)}}return o?Promise.all(c).then(u=>Mt(u,i,t,a)):Mt(c,i,t,a)}}),$i=p("$ZodIntersection",(t,n)=>{Q.init(t,n),t._zod.parse=(r,s)=>{const i=r.value,a=n.left._zod.run({value:i,issues:[]},s),o=n.right._zod.run({value:i,issues:[]},s);return a instanceof Promise||o instanceof Promise?Promise.all([a,o]).then(([u,y])=>Bt(r,u,y)):Bt(r,a,o)}});function jt(t,n){if(t===n)return{valid:!0,data:t};if(t instanceof Date&&n instanceof Date&&+t==+n)return{valid:!0,data:t};if(Me(t)&&Me(n)){const r=Object.keys(n),s=Object.keys(t).filter(a=>r.indexOf(a)!==-1),i={...t,...n};for(const a of s){const o=jt(t[a],n[a]);if(!o.valid)return{valid:!1,mergeErrorPath:[a,...o.mergeErrorPath]};i[a]=o.data}return{valid:!0,data:i}}if(Array.isArray(t)&&Array.isArray(n)){if(t.length!==n.length)return{valid:!1,mergeErrorPath:[]};const r=[];for(let s=0;s<t.length;s++){const i=t[s],a=n[s],o=jt(i,a);if(!o.valid)return{valid:!1,mergeErrorPath:[s,...o.mergeErrorPath]};r.push(o.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}function Bt(t,n,r){if(n.issues.length&&t.issues.push(...n.issues),r.issues.length&&t.issues.push(...r.issues),$e(t))return t;const s=jt(n.value,r.value);if(!s.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(s.mergeErrorPath)}`);return t.value=s.data,t}const Ii=p("$ZodEnum",(t,n)=>{Q.init(t,n);const r=Nr(n.entries),s=new Set(r);t._zod.values=s,t._zod.pattern=new RegExp(`^(${r.filter(i=>Wr.has(typeof i)).map(i=>typeof i=="string"?it(i):i.toString()).join("|")})$`),t._zod.parse=(i,a)=>{const o=i.value;return s.has(o)||i.issues.push({code:"invalid_value",values:r,input:o,inst:t}),i}}),Ei=p("$ZodTransform",(t,n)=>{Q.init(t,n),t._zod.parse=(r,s)=>{if(s.direction==="backward")throw new jn(t.constructor.name);const i=n.transform(r.value,r);if(s.async)return(i instanceof Promise?i:Promise.resolve(i)).then(o=>(r.value=o,r));if(i instanceof Promise)throw new Ee;return r.value=i,r}});function Wt(t,n){return t.issues.length&&n===void 0?{issues:[],value:void 0}:t}const Pi=p("$ZodOptional",(t,n)=>{Q.init(t,n),t._zod.optin="optional",t._zod.optout="optional",L(t._zod,"values",()=>n.innerType._zod.values?new Set([...n.innerType._zod.values,void 0]):void 0),L(t._zod,"pattern",()=>{const r=n.innerType._zod.pattern;return r?new RegExp(`^(${zt(r.source)})?$`):void 0}),t._zod.parse=(r,s)=>{if(n.innerType._zod.optin==="optional"){const i=n.innerType._zod.run(r,s);return i instanceof Promise?i.then(a=>Wt(a,r.value)):Wt(i,r.value)}return r.value===void 0?r:n.innerType._zod.run(r,s)}}),Ri=p("$ZodNullable",(t,n)=>{Q.init(t,n),L(t._zod,"optin",()=>n.innerType._zod.optin),L(t._zod,"optout",()=>n.innerType._zod.optout),L(t._zod,"pattern",()=>{const r=n.innerType._zod.pattern;return r?new RegExp(`^(${zt(r.source)}|null)$`):void 0}),L(t._zod,"values",()=>n.innerType._zod.values?new Set([...n.innerType._zod.values,null]):void 0),t._zod.parse=(r,s)=>r.value===null?r:n.innerType._zod.run(r,s)}),Vi=p("$ZodDefault",(t,n)=>{Q.init(t,n),t._zod.optin="optional",L(t._zod,"values",()=>n.innerType._zod.values),t._zod.parse=(r,s)=>{if(s.direction==="backward")return n.innerType._zod.run(r,s);if(r.value===void 0)return r.value=n.defaultValue,r;const i=n.innerType._zod.run(r,s);return i instanceof Promise?i.then(a=>Ht(a,n)):Ht(i,n)}});function Ht(t,n){return t.value===void 0&&(t.value=n.defaultValue),t}const Zi=p("$ZodPrefault",(t,n)=>{Q.init(t,n),t._zod.optin="optional",L(t._zod,"values",()=>n.innerType._zod.values),t._zod.parse=(r,s)=>(s.direction==="backward"||r.value===void 0&&(r.value=n.defaultValue),n.innerType._zod.run(r,s))}),Di=p("$ZodNonOptional",(t,n)=>{Q.init(t,n),L(t._zod,"values",()=>{const r=n.innerType._zod.values;return r?new Set([...r].filter(s=>s!==void 0)):void 0}),t._zod.parse=(r,s)=>{const i=n.innerType._zod.run(r,s);return i instanceof Promise?i.then(a=>qt(a,t)):qt(i,t)}});function qt(t,n){return!t.issues.length&&t.value===void 0&&t.issues.push({code:"invalid_type",expected:"nonoptional",input:t.value,inst:n}),t}const Ui=p("$ZodCatch",(t,n)=>{Q.init(t,n),L(t._zod,"optin",()=>n.innerType._zod.optin),L(t._zod,"optout",()=>n.innerType._zod.optout),L(t._zod,"values",()=>n.innerType._zod.values),t._zod.parse=(r,s)=>{if(s.direction==="backward")return n.innerType._zod.run(r,s);const i=n.innerType._zod.run(r,s);return i instanceof Promise?i.then(a=>(r.value=a.value,a.issues.length&&(r.value=n.catchValue({...r,error:{issues:a.issues.map(o=>Te(o,s,ke()))},input:r.value}),r.issues=[]),r)):(r.value=i.value,i.issues.length&&(r.value=n.catchValue({...r,error:{issues:i.issues.map(a=>Te(a,s,ke()))},input:r.value}),r.issues=[]),r)}}),Li=p("$ZodPipe",(t,n)=>{Q.init(t,n),L(t._zod,"values",()=>n.in._zod.values),L(t._zod,"optin",()=>n.in._zod.optin),L(t._zod,"optout",()=>n.out._zod.optout),L(t._zod,"propValues",()=>n.in._zod.propValues),t._zod.parse=(r,s)=>{if(s.direction==="backward"){const a=n.out._zod.run(r,s);return a instanceof Promise?a.then(o=>Xe(o,n.in,s)):Xe(a,n.in,s)}const i=n.in._zod.run(r,s);return i instanceof Promise?i.then(a=>Xe(a,n.out,s)):Xe(i,n.out,s)}});function Xe(t,n,r){return t.issues.length?(t.aborted=!0,t):n._zod.run({value:t.value,issues:t.issues},r)}const Ni=p("$ZodReadonly",(t,n)=>{Q.init(t,n),L(t._zod,"propValues",()=>n.innerType._zod.propValues),L(t._zod,"values",()=>n.innerType._zod.values),L(t._zod,"optin",()=>n.innerType._zod.optin),L(t._zod,"optout",()=>n.innerType._zod.optout),t._zod.parse=(r,s)=>{if(s.direction==="backward")return n.innerType._zod.run(r,s);const i=n.innerType._zod.run(r,s);return i instanceof Promise?i.then(Gt):Gt(i)}});function Gt(t){return t.value=Object.freeze(t.value),t}const Oi=p("$ZodCustom",(t,n)=>{le.init(t,n),Q.init(t,n),t._zod.parse=(r,s)=>r,t._zod.check=r=>{const s=r.value,i=n.fn(s);if(i instanceof Promise)return i.then(a=>Jt(a,r,s,t));Jt(i,r,s,t)}});function Jt(t,n,r,s){if(!t){const i={code:"custom",input:r,inst:s,path:[...s._zod.def.path??[]],continue:!s._zod.def.abort};s._zod.def.params&&(i.params=s._zod.def.params),n.issues.push(Be(i))}}class Mi{constructor(){this._map=new WeakMap,this._idmap=new Map}add(n,...r){const s=r[0];if(this._map.set(n,s),s&&typeof s=="object"&&"id"in s){if(this._idmap.has(s.id))throw new Error(`ID ${s.id} already exists in the registry`);this._idmap.set(s.id,n)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(n){const r=this._map.get(n);return r&&typeof r=="object"&&"id"in r&&this._idmap.delete(r.id),this._map.delete(n),this}get(n){const r=n._zod.parent;if(r){const s={...this.get(r)??{}};delete s.id;const i={...s,...this._map.get(n)};return Object.keys(i).length?i:void 0}return this._map.get(n)}has(n){return this._map.has(n)}}function Bi(){return new Mi}const et=Bi();function Wi(t,n){return new t({type:"string",...k(n)})}function Hi(t,n){return new t({type:"string",format:"email",check:"string_format",abort:!1,...k(n)})}function Kt(t,n){return new t({type:"string",format:"guid",check:"string_format",abort:!1,...k(n)})}function qi(t,n){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,...k(n)})}function Gi(t,n){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...k(n)})}function Ji(t,n){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...k(n)})}function Ki(t,n){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...k(n)})}function Yi(t,n){return new t({type:"string",format:"url",check:"string_format",abort:!1,...k(n)})}function Qi(t,n){return new t({type:"string",format:"emoji",check:"string_format",abort:!1,...k(n)})}function Xi(t,n){return new t({type:"string",format:"nanoid",check:"string_format",abort:!1,...k(n)})}function ea(t,n){return new t({type:"string",format:"cuid",check:"string_format",abort:!1,...k(n)})}function ta(t,n){return new t({type:"string",format:"cuid2",check:"string_format",abort:!1,...k(n)})}function na(t,n){return new t({type:"string",format:"ulid",check:"string_format",abort:!1,...k(n)})}function ra(t,n){return new t({type:"string",format:"xid",check:"string_format",abort:!1,...k(n)})}function sa(t,n){return new t({type:"string",format:"ksuid",check:"string_format",abort:!1,...k(n)})}function ia(t,n){return new t({type:"string",format:"ipv4",check:"string_format",abort:!1,...k(n)})}function aa(t,n){return new t({type:"string",format:"ipv6",check:"string_format",abort:!1,...k(n)})}function oa(t,n){return new t({type:"string",format:"cidrv4",check:"string_format",abort:!1,...k(n)})}function la(t,n){return new t({type:"string",format:"cidrv6",check:"string_format",abort:!1,...k(n)})}function ca(t,n){return new t({type:"string",format:"base64",check:"string_format",abort:!1,...k(n)})}function da(t,n){return new t({type:"string",format:"base64url",check:"string_format",abort:!1,...k(n)})}function ua(t,n){return new t({type:"string",format:"e164",check:"string_format",abort:!1,...k(n)})}function ha(t,n){return new t({type:"string",format:"jwt",check:"string_format",abort:!1,...k(n)})}function ma(t,n){return new t({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...k(n)})}function pa(t,n){return new t({type:"string",format:"date",check:"string_format",...k(n)})}function ga(t,n){return new t({type:"string",format:"time",check:"string_format",precision:null,...k(n)})}function fa(t,n){return new t({type:"string",format:"duration",check:"string_format",...k(n)})}function xa(t,n){return new t({type:"number",checks:[],...k(n)})}function ja(t,n){return new t({type:"number",check:"number_format",abort:!1,format:"safeint",...k(n)})}function ba(t){return new t({type:"unknown"})}function ya(t,n){return new t({type:"never",...k(n)})}function Yt(t,n){return new _n({check:"less_than",...k(n),value:t,inclusive:!1})}function mt(t,n){return new _n({check:"less_than",...k(n),value:t,inclusive:!0})}function Qt(t,n){return new $n({check:"greater_than",...k(n),value:t,inclusive:!1})}function pt(t,n){return new $n({check:"greater_than",...k(n),value:t,inclusive:!0})}function Xt(t,n){return new Us({check:"multiple_of",...k(n),value:t})}function Vn(t,n){return new Ns({check:"max_length",...k(n),maximum:t})}function st(t,n){return new Os({check:"min_length",...k(n),minimum:t})}function Zn(t,n){return new Ms({check:"length_equals",...k(n),length:t})}function va(t,n){return new Bs({check:"string_format",format:"regex",...k(n),pattern:t})}function Sa(t){return new Ws({check:"string_format",format:"lowercase",...k(t)})}function wa(t){return new Hs({check:"string_format",format:"uppercase",...k(t)})}function za(t,n){return new qs({check:"string_format",format:"includes",...k(n),includes:t})}function Fa(t,n){return new Gs({check:"string_format",format:"starts_with",...k(n),prefix:t})}function Aa(t,n){return new Js({check:"string_format",format:"ends_with",...k(n),suffix:t})}function We(t){return new Ks({check:"overwrite",tx:t})}function Ca(t){return We(n=>n.normalize(t))}function ka(){return We(t=>t.trim())}function Ta(){return We(t=>t.toLowerCase())}function _a(){return We(t=>t.toUpperCase())}function $a(t,n,r){return new t({type:"array",element:n,...k(r)})}function Ia(t,n,r){return new t({type:"custom",check:"custom",fn:n,...k(r)})}function Ea(t){const n=Pa(r=>(r.addIssue=s=>{if(typeof s=="string")r.issues.push(Be(s,r.value,n._zod.def));else{const i=s;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=r.value),i.inst??(i.inst=n),i.continue??(i.continue=!n._zod.def.abort),r.issues.push(Be(i))}},t(r.value,r)));return n}function Pa(t,n){const r=new le({check:"custom",...k(n)});return r._zod.check=t,r}const Ra=p("ZodISODateTime",(t,n)=>{di.init(t,n),W.init(t,n)});function Va(t){return ma(Ra,t)}const Za=p("ZodISODate",(t,n)=>{ui.init(t,n),W.init(t,n)});function Da(t){return pa(Za,t)}const Ua=p("ZodISOTime",(t,n)=>{hi.init(t,n),W.init(t,n)});function La(t){return ga(Ua,t)}const Na=p("ZodISODuration",(t,n)=>{mi.init(t,n),W.init(t,n)});function Oa(t){return fa(Na,t)}const Ma=(t,n)=>{zn.init(t,n),t.name="ZodError",Object.defineProperties(t,{format:{value:r=>ns(t,r)},flatten:{value:r=>ts(t,r)},addIssue:{value:r=>{t.issues.push(r),t.message=JSON.stringify(t.issues,xt,2)}},addIssues:{value:r=>{t.issues.push(...r),t.message=JSON.stringify(t.issues,xt,2)}},isEmpty:{get(){return t.issues.length===0}}})},he=p("ZodError",Ma,{Parent:Error}),Ba=At(he),Wa=Ct(he),Ha=at(he),qa=ot(he),Ga=is(he),Ja=as(he),Ka=os(he),Ya=ls(he),Qa=cs(he),Xa=ds(he),eo=us(he),to=hs(he),ee=p("ZodType",(t,n)=>(Q.init(t,n),t.def=n,t.type=n.type,Object.defineProperty(t,"_def",{value:n}),t.check=(...r)=>t.clone({...n,checks:[...n.checks??[],...r.map(s=>typeof s=="function"?{_zod:{check:s,def:{check:"custom"},onattach:[]}}:s)]}),t.clone=(r,s)=>ze(t,r,s),t.brand=()=>t,t.register=((r,s)=>(r.add(t,s),t)),t.parse=(r,s)=>Ba(t,r,s,{callee:t.parse}),t.safeParse=(r,s)=>Ha(t,r,s),t.parseAsync=async(r,s)=>Wa(t,r,s,{callee:t.parseAsync}),t.safeParseAsync=async(r,s)=>qa(t,r,s),t.spa=t.safeParseAsync,t.encode=(r,s)=>Ga(t,r,s),t.decode=(r,s)=>Ja(t,r,s),t.encodeAsync=async(r,s)=>Ka(t,r,s),t.decodeAsync=async(r,s)=>Ya(t,r,s),t.safeEncode=(r,s)=>Qa(t,r,s),t.safeDecode=(r,s)=>Xa(t,r,s),t.safeEncodeAsync=async(r,s)=>eo(t,r,s),t.safeDecodeAsync=async(r,s)=>to(t,r,s),t.refine=(r,s)=>t.check(qo(r,s)),t.superRefine=r=>t.check(Go(r)),t.overwrite=r=>t.check(We(r)),t.optional=()=>an(t),t.nullable=()=>on(t),t.nullish=()=>an(on(t)),t.nonoptional=r=>Lo(t,r),t.array=()=>Ln(t),t.or=r=>To([t,r]),t.and=r=>$o(t,r),t.transform=r=>ln(t,Po(r)),t.default=r=>Zo(t,r),t.prefault=r=>Uo(t,r),t.catch=r=>Oo(t,r),t.pipe=r=>ln(t,r),t.readonly=()=>Wo(t),t.describe=r=>{const s=t.clone();return et.add(s,{description:r}),s},Object.defineProperty(t,"description",{get(){return et.get(t)?.description},configurable:!0}),t.meta=(...r)=>{if(r.length===0)return et.get(t);const s=t.clone();return et.add(s,r[0]),s},t.isOptional=()=>t.safeParse(void 0).success,t.isNullable=()=>t.safeParse(null).success,t)),Dn=p("_ZodString",(t,n)=>{kt.init(t,n),ee.init(t,n);const r=t._zod.bag;t.format=r.format??null,t.minLength=r.minimum??null,t.maxLength=r.maximum??null,t.regex=(...s)=>t.check(va(...s)),t.includes=(...s)=>t.check(za(...s)),t.startsWith=(...s)=>t.check(Fa(...s)),t.endsWith=(...s)=>t.check(Aa(...s)),t.min=(...s)=>t.check(st(...s)),t.max=(...s)=>t.check(Vn(...s)),t.length=(...s)=>t.check(Zn(...s)),t.nonempty=(...s)=>t.check(st(1,...s)),t.lowercase=s=>t.check(Sa(s)),t.uppercase=s=>t.check(wa(s)),t.trim=()=>t.check(ka()),t.normalize=(...s)=>t.check(Ca(...s)),t.toLowerCase=()=>t.check(Ta()),t.toUpperCase=()=>t.check(_a())}),no=p("ZodString",(t,n)=>{kt.init(t,n),Dn.init(t,n),t.email=r=>t.check(Hi(ro,r)),t.url=r=>t.check(Yi(so,r)),t.jwt=r=>t.check(ha(yo,r)),t.emoji=r=>t.check(Qi(io,r)),t.guid=r=>t.check(Kt(tn,r)),t.uuid=r=>t.check(qi(tt,r)),t.uuidv4=r=>t.check(Gi(tt,r)),t.uuidv6=r=>t.check(Ji(tt,r)),t.uuidv7=r=>t.check(Ki(tt,r)),t.nanoid=r=>t.check(Xi(ao,r)),t.guid=r=>t.check(Kt(tn,r)),t.cuid=r=>t.check(ea(oo,r)),t.cuid2=r=>t.check(ta(lo,r)),t.ulid=r=>t.check(na(co,r)),t.base64=r=>t.check(ca(xo,r)),t.base64url=r=>t.check(da(jo,r)),t.xid=r=>t.check(ra(uo,r)),t.ksuid=r=>t.check(sa(ho,r)),t.ipv4=r=>t.check(ia(mo,r)),t.ipv6=r=>t.check(aa(po,r)),t.cidrv4=r=>t.check(oa(go,r)),t.cidrv6=r=>t.check(la(fo,r)),t.e164=r=>t.check(ua(bo,r)),t.datetime=r=>t.check(Va(r)),t.date=r=>t.check(Da(r)),t.time=r=>t.check(La(r)),t.duration=r=>t.check(Oa(r))});function en(t){return Wi(no,t)}const W=p("ZodStringFormat",(t,n)=>{M.init(t,n),Dn.init(t,n)}),ro=p("ZodEmail",(t,n)=>{ti.init(t,n),W.init(t,n)}),tn=p("ZodGUID",(t,n)=>{Xs.init(t,n),W.init(t,n)}),tt=p("ZodUUID",(t,n)=>{ei.init(t,n),W.init(t,n)}),so=p("ZodURL",(t,n)=>{ni.init(t,n),W.init(t,n)}),io=p("ZodEmoji",(t,n)=>{ri.init(t,n),W.init(t,n)}),ao=p("ZodNanoID",(t,n)=>{si.init(t,n),W.init(t,n)}),oo=p("ZodCUID",(t,n)=>{ii.init(t,n),W.init(t,n)}),lo=p("ZodCUID2",(t,n)=>{ai.init(t,n),W.init(t,n)}),co=p("ZodULID",(t,n)=>{oi.init(t,n),W.init(t,n)}),uo=p("ZodXID",(t,n)=>{li.init(t,n),W.init(t,n)}),ho=p("ZodKSUID",(t,n)=>{ci.init(t,n),W.init(t,n)}),mo=p("ZodIPv4",(t,n)=>{pi.init(t,n),W.init(t,n)}),po=p("ZodIPv6",(t,n)=>{gi.init(t,n),W.init(t,n)}),go=p("ZodCIDRv4",(t,n)=>{fi.init(t,n),W.init(t,n)}),fo=p("ZodCIDRv6",(t,n)=>{xi.init(t,n),W.init(t,n)}),xo=p("ZodBase64",(t,n)=>{ji.init(t,n),W.init(t,n)}),jo=p("ZodBase64URL",(t,n)=>{yi.init(t,n),W.init(t,n)}),bo=p("ZodE164",(t,n)=>{vi.init(t,n),W.init(t,n)}),yo=p("ZodJWT",(t,n)=>{wi.init(t,n),W.init(t,n)}),Un=p("ZodNumber",(t,n)=>{En.init(t,n),ee.init(t,n),t.gt=(s,i)=>t.check(Qt(s,i)),t.gte=(s,i)=>t.check(pt(s,i)),t.min=(s,i)=>t.check(pt(s,i)),t.lt=(s,i)=>t.check(Yt(s,i)),t.lte=(s,i)=>t.check(mt(s,i)),t.max=(s,i)=>t.check(mt(s,i)),t.int=s=>t.check(rn(s)),t.safe=s=>t.check(rn(s)),t.positive=s=>t.check(Qt(0,s)),t.nonnegative=s=>t.check(pt(0,s)),t.negative=s=>t.check(Yt(0,s)),t.nonpositive=s=>t.check(mt(0,s)),t.multipleOf=(s,i)=>t.check(Xt(s,i)),t.step=(s,i)=>t.check(Xt(s,i)),t.finite=()=>t;const r=t._zod.bag;t.minValue=Math.max(r.minimum??Number.NEGATIVE_INFINITY,r.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,t.maxValue=Math.min(r.maximum??Number.POSITIVE_INFINITY,r.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,t.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),t.isFinite=!0,t.format=r.format??null});function nn(t){return xa(Un,t)}const vo=p("ZodNumberFormat",(t,n)=>{zi.init(t,n),Un.init(t,n)});function rn(t){return ja(vo,t)}const So=p("ZodUnknown",(t,n)=>{Fi.init(t,n),ee.init(t,n)});function sn(){return ba(So)}const wo=p("ZodNever",(t,n)=>{Ai.init(t,n),ee.init(t,n)});function zo(t){return ya(wo,t)}const Fo=p("ZodArray",(t,n)=>{Ci.init(t,n),ee.init(t,n),t.element=n.element,t.min=(r,s)=>t.check(st(r,s)),t.nonempty=r=>t.check(st(1,r)),t.max=(r,s)=>t.check(Vn(r,s)),t.length=(r,s)=>t.check(Zn(r,s)),t.unwrap=()=>t.element});function Ln(t,n){return $a(Fo,t,n)}const Ao=p("ZodObject",(t,n)=>{Ti.init(t,n),ee.init(t,n),L(t,"shape",()=>n.shape),t.keyof=()=>Io(Object.keys(t._zod.def.shape)),t.catchall=r=>t.clone({...t._zod.def,catchall:r}),t.passthrough=()=>t.clone({...t._zod.def,catchall:sn()}),t.loose=()=>t.clone({...t._zod.def,catchall:sn()}),t.strict=()=>t.clone({...t._zod.def,catchall:zo()}),t.strip=()=>t.clone({...t._zod.def,catchall:void 0}),t.extend=r=>Kr(t,r),t.safeExtend=r=>Yr(t,r),t.merge=r=>Qr(t,r),t.pick=r=>Gr(t,r),t.omit=r=>Jr(t,r),t.partial=(...r)=>Xr(Nn,t,r[0]),t.required=(...r)=>es(On,t,r[0])});function Co(t,n){const r={type:"object",get shape(){return we(this,"shape",t?Mr(t):{}),this.shape},...k(n)};return new Ao(r)}const ko=p("ZodUnion",(t,n)=>{_i.init(t,n),ee.init(t,n),t.options=n.options});function To(t,n){return new ko({type:"union",options:t,...k(n)})}const _o=p("ZodIntersection",(t,n)=>{$i.init(t,n),ee.init(t,n)});function $o(t,n){return new _o({type:"intersection",left:t,right:n})}const bt=p("ZodEnum",(t,n)=>{Ii.init(t,n),ee.init(t,n),t.enum=n.entries,t.options=Object.values(n.entries);const r=new Set(Object.keys(n.entries));t.extract=(s,i)=>{const a={};for(const o of s)if(r.has(o))a[o]=n.entries[o];else throw new Error(`Key ${o} not found in enum`);return new bt({...n,checks:[],...k(i),entries:a})},t.exclude=(s,i)=>{const a={...n.entries};for(const o of s)if(r.has(o))delete a[o];else throw new Error(`Key ${o} not found in enum`);return new bt({...n,checks:[],...k(i),entries:a})}});function Io(t,n){const r=Array.isArray(t)?Object.fromEntries(t.map(s=>[s,s])):t;return new bt({type:"enum",entries:r,...k(n)})}const Eo=p("ZodTransform",(t,n)=>{Ei.init(t,n),ee.init(t,n),t._zod.parse=(r,s)=>{if(s.direction==="backward")throw new jn(t.constructor.name);r.addIssue=a=>{if(typeof a=="string")r.issues.push(Be(a,r.value,n));else{const o=a;o.fatal&&(o.continue=!1),o.code??(o.code="custom"),o.input??(o.input=r.value),o.inst??(o.inst=t),r.issues.push(Be(o))}};const i=n.transform(r.value,r);return i instanceof Promise?i.then(a=>(r.value=a,r)):(r.value=i,r)}});function Po(t){return new Eo({type:"transform",transform:t})}const Nn=p("ZodOptional",(t,n)=>{Pi.init(t,n),ee.init(t,n),t.unwrap=()=>t._zod.def.innerType});function an(t){return new Nn({type:"optional",innerType:t})}const Ro=p("ZodNullable",(t,n)=>{Ri.init(t,n),ee.init(t,n),t.unwrap=()=>t._zod.def.innerType});function on(t){return new Ro({type:"nullable",innerType:t})}const Vo=p("ZodDefault",(t,n)=>{Vi.init(t,n),ee.init(t,n),t.unwrap=()=>t._zod.def.innerType,t.removeDefault=t.unwrap});function Zo(t,n){return new Vo({type:"default",innerType:t,get defaultValue(){return typeof n=="function"?n():vn(n)}})}const Do=p("ZodPrefault",(t,n)=>{Zi.init(t,n),ee.init(t,n),t.unwrap=()=>t._zod.def.innerType});function Uo(t,n){return new Do({type:"prefault",innerType:t,get defaultValue(){return typeof n=="function"?n():vn(n)}})}const On=p("ZodNonOptional",(t,n)=>{Di.init(t,n),ee.init(t,n),t.unwrap=()=>t._zod.def.innerType});function Lo(t,n){return new On({type:"nonoptional",innerType:t,...k(n)})}const No=p("ZodCatch",(t,n)=>{Ui.init(t,n),ee.init(t,n),t.unwrap=()=>t._zod.def.innerType,t.removeCatch=t.unwrap});function Oo(t,n){return new No({type:"catch",innerType:t,catchValue:typeof n=="function"?n:()=>n})}const Mo=p("ZodPipe",(t,n)=>{Li.init(t,n),ee.init(t,n),t.in=n.in,t.out=n.out});function ln(t,n){return new Mo({type:"pipe",in:t,out:n})}const Bo=p("ZodReadonly",(t,n)=>{Ni.init(t,n),ee.init(t,n),t.unwrap=()=>t._zod.def.innerType});function Wo(t){return new Bo({type:"readonly",innerType:t})}const Ho=p("ZodCustom",(t,n)=>{Oi.init(t,n),ee.init(t,n)});function qo(t,n={}){return Ia(Ho,t,n)}function Go(t){return Ea(t)}const Jo=Co({count:nn().int(),history:Ln(en()),multiplier:nn().int().min(1),qualityMessage:en()});function Ko(){return new Se({name:"actions-demo",value:{count:0,history:[],multiplier:1,qualityMessage:""},schema:Jo,actions:{increment:function(){this.mutate(t=>{const n=t.count+t.multiplier;t.count=n,t.history.push(`Incremented to ${n}`)})},decrement:function(){this.mutate(t=>{const n=t.count-t.multiplier;t.count=n,t.history.push(`Decremented to ${n}`)})},setMultiplier:function(t,n){this.set("multiplier",n)},doubleAndLog:function(){this.mutate(t=>{const n=t.count;t.count=n*2,t.history.push(`Doubled from ${n} to ${t.count}`)})},incrementTwice:function(){this.$.increment(),this.$.increment()},reset:function(){this.next({count:0,history:["Reset to 0"],multiplier:1,qualityMessage:""})},clearHistory:function(){this.mutate(t=>{t.history.length=0})}},prep:function(t,n){const r={...n,...t};let s="";return r.count<-100?s="Count is getting very low":r.count>100?s="Count is getting very high":r.multiplier<1&&(s="Multiplier works best at 1 or higher"),{...r,qualityMessage:s}},tests:[]})}const Yo=()=>{const[t,n]=fe(Ko);return e.jsxs(Y,{columns:{base:1,lg:2},spacing:6,children:[e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsxs(d,{children:[e.jsx(l,{fontSize:"lg",fontWeight:"semibold",mb:3,children:"Counter Controls"}),e.jsxs(x,{spacing:3,align:"stretch",children:[e.jsxs($,{children:[e.jsxs(R,{colorScheme:"forest",onClick:()=>n.$.increment(),children:["+",t.multiplier]}),e.jsxs(R,{colorScheme:"forest",variant:"outline",onClick:()=>n.$.decrement(),children:["-",t.multiplier]}),e.jsx(R,{colorScheme:"blue",onClick:()=>n.$.doubleAndLog(),children:"Double"})]}),e.jsxs($,{children:[e.jsxs(R,{colorScheme:"purple",onClick:()=>n.$.incrementTwice(),children:["+",t.multiplier*2," (Twice)"]}),e.jsx(R,{variant:"outline",onClick:()=>n.$.reset(),children:"Reset"})]})]})]}),e.jsx(d,{children:e.jsxs(Ne,{children:[e.jsx(Oe,{children:"Multiplier"}),e.jsx(ye,{type:"number",value:t.multiplier,onChange:r=>n.$.setMultiplier(parseInt(r.target.value)||1)})]})}),t.qualityMessage&&e.jsxs(ne,{status:"info",children:[e.jsx(re,{}),t.qualityMessage]})]}),e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsxs(d,{children:[e.jsx(l,{fontSize:"lg",fontWeight:"semibold",mb:3,children:"Current State"}),e.jsxs(d,{p:4,bg:"gray.50",borderRadius:"md",children:[e.jsxs($,{mb:2,children:[e.jsx(l,{fontWeight:"semibold",children:"Count:"}),e.jsx(S,{colorScheme:t.count===0?"gray":t.count>0?"green":"red",fontSize:"lg",children:t.count})]}),e.jsxs($,{children:[e.jsx(l,{fontWeight:"semibold",children:"Multiplier:"}),e.jsx(S,{colorScheme:"blue",children:t.multiplier})]})]})]}),e.jsxs(d,{children:[e.jsxs($,{justify:"space-between",align:"center",mb:3,children:[e.jsx(l,{fontSize:"lg",fontWeight:"semibold",children:"Action History"}),e.jsx(R,{size:"sm",variant:"ghost",onClick:()=>n.$.clearHistory(),isDisabled:t.history.length===0,children:"Clear"})]}),e.jsx(d,{maxH:"200px",overflowY:"auto",border:"1px solid",borderColor:"gray.200",borderRadius:"md",p:3,children:t.history.length===0?e.jsx(l,{color:"gray.500",fontStyle:"italic",textAlign:"center",children:"No actions yet"}):e.jsx(x,{spacing:1,align:"stretch",children:t.history.map((r,s)=>e.jsxs(l,{fontSize:"sm",fontFamily:"mono",children:[s+1,". ",r]},s))})})]}),e.jsx(d,{children:e.jsxs(l,{fontSize:"sm",color:"gray.600",children:[e.jsx("strong",{children:"Try:"})," Use different multipliers, try to exceed limits (-100 to +100), or set multiplier below 1 to see validation in action."]})})]})]})},N=({title:t,children:n,code:r,snippetName:s,snippetFolder:i,language:a="typescript",codeTitle:o,titleSize:c="sm",titleAsCode:u=!1,codeColorScheme:y="",ts:F=!1})=>{const C=r||s;return X.useEffect(()=>{C&&typeof window<"u"&&window.Prism&&setTimeout(()=>{window.Prism.highlightAll()},100)},[C,s,r]),e.jsxs(d,{children:[e.jsx(h,{size:c,layerStyle:"methodSignature",children:u?e.jsx(Z,{fontSize:"sm",colorScheme:y,mb:1,children:t}):t}),e.jsx(l,{textStyle:"body",fontSize:u?"sm":void 0,color:u?"gray.600":void 0,mt:u?1:3,children:n}),C&&e.jsx(d,{mt:4,children:s?e.jsxs(d,{children:[o&&e.jsx(l,{fontSize:"sm",fontWeight:"medium",mb:2,color:"gray.700",children:o}),e.jsx(te,{snippetName:s,folder:i,language:a,ts:F})]}):e.jsx(K,{language:a,title:o,children:r})})]})},Qo=()=>e.jsx(oe,{maxW:"container.xl",py:8,children:e.jsxs(x,{spacing:8,align:"stretch",children:[e.jsxs(d,{children:[e.jsxs(h,{size:"xl",mb:4,children:["Actions & State Management",e.jsx(S,{ml:3,colorScheme:"forest",children:"Essential"})]}),e.jsx(l,{fontSize:"lg",color:"gray.600",children:"Learn how to define actions and manage state updates in Forestry 4."})]}),e.jsxs(I,{title:"Action Principles",children:[e.jsx(l,{color:"gray.600",children:"Understanding the core principles of actions will help you write better, more maintainable state management code."}),e.jsxs(ne,{status:"warning",children:[e.jsx(re,{}),e.jsxs(x,{spacing:2,align:"stretch",children:[e.jsx(l,{fontSize:"sm",fontWeight:"bold",children:"🚨 Forestry is NOT Redux!"}),e.jsxs(l,{fontSize:"sm",children:["Actions don't return the next state iteration. State is changed imperatively with",e.jsx("code",{children:"next"}),", ",e.jsx("code",{children:"set"}),", and ",e.jsx("code",{children:"mutate"}),". Actions don't even have to return anything. When they do return values, it's useful data for the caller (summaries, composites, reporting) - not values that Forestry itself uses."]})]})]}),e.jsxs(ne,{status:"info",children:[e.jsx(re,{}),e.jsxs(l,{fontSize:"sm",children:[e.jsx("strong",{children:"Key Rule:"})," Actions must be functions or object methods - NOT arrow functions/lambdas. Arrow functions cannot be properly bound with ",e.jsx("code",{children:"call"})," and will lose their ",e.jsx("code",{children:"this"})," context."]})]}),e.jsx(h,{size:"md",children:"Why not use general functions?"}),e.jsx(x,{spacing:2,align:"stretch",children:e.jsxs(d,{layerStyle:"card",children:[`Actions are not "magic" - they are bound to the state's context like class instance methods but you can if you prefer use `,e.jsx("i",{children:"external functions"})," instead of actions and just pass state as an argument and modify the state from the outside."]})}),e.jsx(h,{size:"md",children:"Can actions be async?"}),e.jsx(x,{spacing:2,align:"stretch",children:e.jsxs(d,{layerStyle:"card",children:["Yes - even external ones can be async. However a few considerations:",e.jsxs("ul",{children:[e.jsxs("li",{children:["Transactions cannot contain async actions. Its just not tenable to implement rollback and async behavior in the same system. however you can call (sync) transactions from ",e.jsx("i",{children:"inside"})," an async function."]}),e.jsx("li",{children:"You may find it slightly more work to test external functions."}),e.jsx("li",{children:'You can use external "helper functions" like lodash utilities, inside an action provided they can handle immutable inputs'})]})]})}),e.jsx(h,{size:"md",children:"What is an action?"}),e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsxs(d,{layerStyle:"card",children:[e.jsx(l,{fontWeight:"semibold",mb:2,children:"Actions Have Two Purposes"}),e.jsxs("ul",{children:[e.jsxs(l,{fontSize:"sm",as:"li",children:[e.jsx("strong",{children:"State Mutation:"})," Update the store's value using mutate, set, or next"]}),e.jsxs(l,{fontSize:"sm",as:"li",children:[e.jsx("strong",{children:"Selectors/Computed Values:"})," you can express summary or portions of state out of actions and return it to the calling context."]})]})]}),e.jsxs(d,{layerStyle:"card",bg:"gray.50",children:[e.jsx(l,{fontWeight:"semibold",mb:2,children:"Actions are bound to the Store"}),e.jsxs(l,{fontSize:"sm",children:[e.jsx("code",{children:"this"})," in actions refers to the store itself. You can use"," ",e.jsx("code",{children:"this.$"}),",",e.jsx("code",{children:"this.set"}),", ",e.jsx("code",{children:"this.next"}),","," ",e.jsx("code",{children:"this.value"}),", etc."]})]})]}),e.jsx(h,{size:"md",children:"The Value parameter"}),e.jsx(x,{spacing:2,align:"stretch",children:e.jsx(d,{layerStyle:"card",children:e.jsxs(l,{fontSize:"sm",children:["The first parameter ",e.jsx("code",{children:"value"})," is the state's value property,"," ",e.jsx("i",{children:"when the action started"})," . If your action changes state and you want to get the most current version of state, examine ",e.jsx("code",{children:"this.value"})," or"," ",e.jsx("code",{children:"this.get('path')"})," to get the latest state value.",e.jsx("br",{}),e.jsx("br",{}),"You ",e.jsx("i",{children:"must"})," add it as the first parameter in your action, but when you"," ",e.jsx("i",{children:"call"})," your action, you don't have to add it in - Forestry will automatically prepend it to any input arguments internally.",e.jsx(te,{snippetName:"counter-example",folder:"actions-state",language:"typescript",ts:!0})]})})}),e.jsx(h,{size:"md",children:"How to update state"}),e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsxs(ne,{status:"info",children:[e.jsx(re,{}),e.jsxs(l,{fontSize:"sm",children:["Unlike Redux, ",e.jsx("strong",{children:"the return value of actions does NOT update state"}),". Updating state is done imperatively by calling state methods."]})]}),e.jsx(N,{title:"set(path: string | string[], value: any): void",titleAsCode:!0,snippetName:"set-examples",snippetFolder:"actions-state",language:"typescript",ts:!0,children:"Sets a property in the state structure with a new value. Path can be a string or dot-separated deep path."}),e.jsx(N,{title:"mutate(updater: (draft: T) => void | T): void",titleAsCode:!0,snippetName:"mutate-examples",snippetFolder:"actions-state",language:"typescript",ts:!0,children:"Allows you to edit the state as a normal mutable JavaScript object using Immer's produce function."}),e.jsx(N,{title:"next(value: T): void",titleAsCode:!0,snippetName:"next-examples",snippetFolder:"actions-state",language:"typescript",ts:!0,children:"Replaces the entire state with a new value. Generally the least useful method - prefer set() or mutate() for most cases."})]})]}),e.jsxs(I,{title:"Action Patterns in Practice",children:[e.jsx(d,{layerStyle:"card",children:e.jsx(l,{children:"Practical examples showing the recommended patterns for different types of state updates."})}),e.jsxs(Y,{columns:{base:1,lg:2},spacing:6,children:[e.jsxs(d,{children:[e.jsx(h,{size:"md",mb:3,children:"Actions can call othe ractions"}),e.jsx(l,{color:"gray.600",mb:4,children:"High-level actions that orchestrate multiple tactical operations."}),e.jsx(te,{snippetName:"strategicActions",folder:"ActionsState"})]}),e.jsxs(d,{children:[e.jsx(h,{size:"md",mb:3,children:"Tactical Actions"}),e.jsx(l,{color:"gray.600",mb:4,children:"Low-level, reusable utilities that handle specific mutations."}),e.jsx(te,{snippetName:"tacticalActions",folder:"ActionsState"})]})]})]}),e.jsxs(I,{title:"Interactive Actions Demo",children:[e.jsx(l,{color:"gray.600",children:"Try different action patterns and see how they update the state:"}),e.jsx(Yo,{})]}),e.jsxs(I,{title:"Complete Source Code",children:[e.jsx(l,{color:"gray.600",children:"Here's the complete implementation of the actions demo above:"}),e.jsx(ue,{tabs:[{label:"Store Definition",language:"typescript",snippet:"storeDefinition",folder:"ActionsState"},{label:"React Integration",language:"tsx",snippet:"reactIntegrationDemo",folder:"ActionsState"},{label:"Action Patterns",language:"typescript",snippet:"actionPatterns",folder:"ActionsState"}]})]}),e.jsx(I,{title:"Action Best Practices",children:e.jsxs(Y,{columns:{base:1,lg:2},spacing:6,children:[e.jsxs(d,{children:[e.jsx(h,{size:"md",mb:3,color:"green.600",children:"✅ Best Practices for Actions"}),e.jsxs(x,{spacing:3,align:"stretch",children:[e.jsxs(d,{p:3,bg:"green.50",borderRadius:"md",children:[e.jsx(l,{fontWeight:"semibold",children:"Keep actions focused"}),e.jsx(l,{fontSize:"sm",color:"gray.600",children:"One action should do one thing well; take advantage of nested actions to break up complex behaviors into several small helpers"})]}),e.jsxs(d,{p:3,bg:"green.50",borderRadius:"md",children:[e.jsx(l,{fontWeight:"semibold",children:"Compose with nested actions"}),e.jsxs(l,{fontSize:"sm",color:"gray.600",children:[e.jsx("code",{children:"this.$.otherAction()"})," for reusability"]})]}),e.jsxs(d,{p:3,bg:"green.50",borderRadius:"md",children:[e.jsx(l,{fontWeight:"semibold",children:"Use actions in place of hooks or wrappers"}),e.jsxs(l,{fontSize:"sm",color:"gray.600",children:["Because actions are bound to store context you can use them directly to respond to events - you don't have to wrap them in lambdas or ",e.jsx("code",{children:"useCallback"}),". You can write actions to deconstruct events and pass them directly to"," ",e.jsx("code",{children:"onChange(state.$.onFieldChange"}),". You can even attach data-keys to qualify the behavior of the actions to reduce having to write new handlers for each event use case."]})]})]})]}),e.jsxs(d,{children:[e.jsx(h,{size:"md",mb:3,color:"red.600",children:"❌ Things that won't work"}),e.jsxs(x,{spacing:3,align:"stretch",children:[e.jsxs(d,{p:3,bg:"red.50",borderRadius:"md",children:[e.jsx(l,{fontWeight:"semibold",children:"You cannot edit the value parameter"}),e.jsxs(l,{fontSize:"sm",color:"gray.600",children:["the value parameter ",e.jsx("i",{children:"and"})," ",e.jsx("code",{children:"this.value"})," are both",e.jsx("a",{href:"https://immerjs.github.io/immer/",children:"Immer"})," immutables that"," ",e.jsx("i",{children:"cannot be edited"}),' - this is even "more const than const";',e.jsx("code",{children:"Map.set"})," or ",e.jsx("code",{children:"array.push/pop/etc"})," do not work on values. (this by the way is also true of Redux Toolkit actions).",e.jsx("br",{}),e.jsx("br",{}),"The ",e.jsx("code",{children:".mutate(lambda)"})," method is how you can directly edit state value."]})]}),e.jsxs(d,{p:3,bg:"red.50",borderRadius:"md",children:[e.jsx(l,{fontWeight:"semibold",children:"Actions cannot be arrow functions (lambdas)"}),e.jsxs(l,{fontSize:"sm",color:"gray.600",children:["you cannot bind or change a lambdas' definiton of this so actions cannot be bound to state from the constructor definitions: eg.,",e.jsx(te,{snippetName:"arrow-function-antipattern",folder:"actions-state",language:"typescript",ts:!0}),'will not give you the desired result as "this" will not be the store.']})]})]})]})]})})]})}),Xo=()=>e.jsx(I,{children:e.jsxs(x,{layerStyle:"section",children:[e.jsx(h,{size:"lg",children:"Integration Patterns"}),e.jsx(l,{textStyle:"body",children:"Forestry 4 integrates seamlessly with React using standard hooks and patterns."}),e.jsxs(d,{width:"full",children:[e.jsx(h,{size:"md",mb:3,children:"Hook Usage"}),e.jsx(l,{textStyle:"body",children:"Use Forestry hooks to connect stores to React components."}),e.jsx(te,{snippetName:"forestryHooks",folder:"ReactIntegration"})]})]})}),el=()=>{const t=[{id:1,text:"Learn Forestry 4",completed:!0},{id:2,text:"Build a React app",completed:!1},{id:3,text:"Master state management",completed:!1}];return new Se({name:"todo-app",value:{todos:t,filter:"all",newTodoText:""},actions:{filteredTodos:function(n){switch(n.filter){case"active":return n.todos.filter(r=>!r.completed);case"completed":return n.todos.filter(r=>r.completed);default:return n.todos}},completedCount:function(n){return n.todos.filter(r=>r.completed).length},activeCount:function(n){return n.todos.filter(r=>!r.completed).length},isAddDisabled:function(n){return!n.newTodoText.trim()},setFilterAll:function(n){this.$.setFilter("all")},setFilterActive:function(n){this.$.setFilter("active")},setFilterCompleted:function(n){this.$.setFilter("completed")},handleKeyPress:function(n,r){r.key==="Enter"&&this.$.addTodo()},createToggleTodo:function(n,r){return()=>this.$.toggleTodo(r)},createRemoveTodo:function(n,r){return()=>this.$.removeTodo(r)},onChange:function(n,r){const{name:s,value:i}=r.target;this.set(s,i)},addTodo:function(n){if(!n.newTodoText.trim())return;const r={id:Date.now(),text:n.newTodoText.trim(),completed:!1};this.mutate(s=>{s.todos.push(r),s.newTodoText=""})},toggleTodo:function(n,r){const s=n.todos.map(i=>i.id===r?{...i,completed:!i.completed}:i);this.set("todos",s)},removeTodo:function(n,r){const s=n.todos.filter(i=>i.id!==r);this.set("todos",s)},setFilter:function(n,r){this.set("filter",r)},clearCompleted:function(n){const r=n.todos.filter(s=>!s.completed);this.set("todos",r)}},tests:[n=>n.newTodoText.length>100?"Todo text too long":null]})},Mn=()=>{const[t,n]=fe(el);return t?e.jsxs(Y,{columns:{base:1,lg:2},spacing:6,children:[e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsxs(d,{children:[e.jsx(h,{size:"md",mb:4,children:"Add New Todo"}),e.jsxs($,{children:[e.jsx(ye,{name:"newTodoText",placeholder:"What needs to be done?",value:t.newTodoText,onChange:n.$.onChange,onKeyPress:n.$.handleKeyPress}),e.jsx(R,{colorScheme:"forest",onClick:n.$.addTodo,isDisabled:n.$.isAddDisabled(),children:"Add"})]})]}),e.jsxs(d,{children:[e.jsx(h,{size:"md",mb:4,children:"Filter Todos"}),e.jsxs($,{children:[e.jsxs(R,{size:"sm",variant:t.filter==="all"?"solid":"outline",colorScheme:"forest",onClick:n.$.setFilterAll,children:["All (",t.todos.length,")"]}),e.jsxs(R,{size:"sm",variant:t.filter==="active"?"solid":"outline",colorScheme:"forest",onClick:n.$.setFilterActive,children:["Active (",n.$.activeCount(),")"]}),e.jsxs(R,{size:"sm",variant:t.filter==="completed"?"solid":"outline",colorScheme:"forest",onClick:n.$.setFilterCompleted,children:["Completed (",n.$.completedCount(),")"]})]})]}),n.$.completedCount()>0&&e.jsx(d,{children:e.jsxs(R,{size:"sm",colorScheme:"red",variant:"outline",onClick:n.$.clearCompleted,children:["Clear Completed (",n.$.completedCount(),")"]})})]}),e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsx(h,{size:"md",children:"Todo List"}),e.jsx(d,{maxH:"400px",overflowY:"auto",border:"1px solid",borderColor:"gray.200",borderRadius:"md",p:4,children:n.$.filteredTodos().length===0?e.jsx(l,{color:"gray.500",fontStyle:"italic",textAlign:"center",children:t.filter==="all"?"No todos yet!":t.filter==="active"?"No active todos!":"No completed todos!"}):e.jsx(x,{spacing:3,align:"stretch",children:n.$.filteredTodos().map(r=>e.jsxs($,{p:3,bg:"gray.50",borderRadius:"md",children:[e.jsx(lr,{isChecked:r.completed,onChange:n.$.createToggleTodo(r.id)}),e.jsx(l,{flex:1,textDecoration:r.completed?"line-through":"none",color:r.completed?"gray.500":"inherit",children:r.text}),e.jsx(R,{size:"sm",colorScheme:"red",variant:"ghost",onClick:n.$.createRemoveTodo(r.id),children:"×"})]},r.id))})})]})]}):e.jsx(l,{children:"Loading..."})},tl=()=>e.jsx(I,{children:e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsx(h,{size:"lg",children:"Live Todo App Demo"}),e.jsx(l,{color:"gray.600",children:"A complete todo app showing React + Forestry 4 integration patterns:"}),e.jsx(Mn,{})]})}),nl=()=>e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsx(I,{title:"React Hook Patterns",children:e.jsxs(d,{children:[e.jsx(h,{size:"md",mb:3,children:"Forestry Hook Source Code"}),e.jsx(l,{textStyle:"body",children:"Here are the complete implementations of Forestry's React integration hooks:"}),e.jsxs(x,{layerStyle:"section",align:"stretch",width:"full",children:[e.jsxs(d,{children:[e.jsx(l,{fontWeight:"bold",mb:2,children:"useForestryLocal - Local Store Management"}),e.jsx(l,{textStyle:"description",children:"Creates and manages a store instance using useRef pattern, returns [value, store]"}),e.jsx(te,{snippetName:"useForestryLocalSource",folder:"ReactIntegration"})]}),e.jsxs(d,{children:[e.jsx(l,{fontWeight:"bold",mb:2,children:"useObserveForest - External Store Observation"}),e.jsx(l,{textStyle:"description",children:"Observes an existing store/forest instance, returns just the value"}),e.jsx(te,{snippetName:"useObserveForestSource",folder:"ReactIntegration"})]})]})]})}),e.jsxs(I,{title:"Referential Integrity with Immer",children:[e.jsx(l,{textStyle:"body",children:"Forestry uses Immer internally, which ensures that any changed value is always referentially unique. This means you can trust any component of state to drive useEffect dependencies correctly."}),e.jsx(te,{snippetName:"referentialIntegrity",folder:"ReactIntegration"}),e.jsxs(ne,{status:"info",mt:4,children:[e.jsx(re,{}),e.jsxs(d,{children:[e.jsx(l,{fontWeight:"bold",children:"Key Benefit:"}),e.jsx(l,{children:"Unlike manual state management where you might accidentally mutate objects and break React's dependency system, Forestry eliminates this entire class of bugs through Immer's referential integrity."})]})]})]})]}),rl=()=>e.jsx(I,{children:e.jsxs(x,{layerStyle:"section",children:[e.jsx(h,{size:"lg",children:"Complete Source Code"}),e.jsx(l,{textStyle:"body",children:"Here's the complete implementation of the todo app above:"}),e.jsx(ue,{tabs:[{label:"Store Factory",language:"typescript",snippet:"todoStoreFactory",folder:"ReactIntegration"},{label:"React Component",language:"tsx",snippet:"todoAppComponent",folder:"ReactIntegration"}]})]})}),sl=()=>e.jsx(I,{children:e.jsxs(x,{layerStyle:"section",children:[e.jsx(h,{size:"lg",children:"React Integration Best Practices"}),e.jsx(l,{children:'React is "quirky" about some features; the hooks above take care of all these concerns but if you plan to integrate Forestry with your own code or custom hooks follow these guidelines.'}),e.jsxs(Y,{columns:{base:1,lg:2},spacing:6,children:[e.jsxs(d,{children:[e.jsx(h,{size:"md",mb:3,color:"green.600",children:"✅ Best Practices"}),e.jsxs(x,{layerStyle:"section",spacing:3,align:"stretch",children:[e.jsxs(d,{p:3,bg:"green.50",borderRadius:"md",children:[e.jsx(l,{fontWeight:"semibold",children:"Use Forestry hooks to reduce blend boilerplate"}),e.jsx(l,{fontSize:"sm",color:"gray.600",children:"You can subscribe in useEffect and store stores in ref -- but the hooks take care of a lot of housekeeping. At this point the hooks are not in the component - you'll have to bring the in, because it frees you to use your current react version (or Preact or whatever)"})]}),e.jsxs(d,{p:3,bg:"green.50",borderRadius:"md",children:[e.jsx(l,{fontWeight:"semibold",children:"Trust referential integrity"}),e.jsx(l,{fontSize:"sm",color:"gray.600",children:"given all parts of a store changes when part of it changes, you can trust any part of the store in dependency arrays to properly trigger useEffect"})]}),e.jsxs(d,{p:3,bg:"green.50",borderRadius:"md",children:[e.jsx(l,{fontWeight:"semibold",children:"Diminish Hooks whenever possible"}),e.jsx(l,{fontSize:"sm",color:"gray.600",children:"Using store values or selector actions reduces the number of callbacks or memos you have to put in your component body."})]}),e.jsxs(d,{p:3,bg:"green.50",borderRadius:"md",children:[e.jsx(l,{fontWeight:"semibold",children:"Pass whole stores via context or params"}),e.jsx(l,{fontSize:"sm",color:"gray.600",children:"Rather than deconstructing actions or values down deep paths, pass the whole store and its value down or through context."})]})]})]}),e.jsxs(d,{children:[e.jsx(h,{size:"md",mb:3,color:"red.600",children:"❌ Things that will not work well"}),e.jsxs(x,{layerStyle:"section",spacing:3,align:"stretch",children:[e.jsxs(d,{p:3,bg:"red.50",borderRadius:"md",children:[e.jsx(l,{fontWeight:"semibold",children:"Mutate store values directly"}),e.jsx(l,{fontSize:"sm",color:"gray.600",children:"Immer won't let you do that - use mutate or set to alter parts or all of the store value."})]}),e.jsxs(d,{p:3,bg:"red.50",borderRadius:"md",children:[e.jsx(l,{fontWeight:"semibold",children:"Create stores in component function body"}),e.jsx(l,{fontSize:"sm",color:"gray.600",children:"If you don't use the factory hooks, create stores in memos or via careful use of refs."})]})]})]})]})]})}),il=()=>e.jsx(oe,{maxW:"container.xl",py:8,children:e.jsxs(x,{layerStyle:"section",spacing:8,children:[e.jsxs(d,{children:[e.jsx(h,{size:"xl",mb:4,children:"React Integration"}),e.jsx(l,{fontSize:"lg",color:"gray.600",children:"Learn how to integrate Forestry 4 stores with React components and hooks."})]}),e.jsx(Xo,{}),e.jsx(tl,{}),e.jsx(nl,{}),e.jsx(rl,{}),e.jsx(sl,{})]})});function Tt(){const t=pn(),n=X.useCallback((i,a)=>{const o=typeof i=="string"?i:i.message;t({title:a||"Validation Error",description:o,status:"error",duration:4e3,isClosable:!0})},[t]),r=X.useCallback((i,a)=>{t({title:a||"Success",description:i,status:"success",duration:3e3,isClosable:!0})},[t]),s=X.useCallback((i,a)=>{t({title:a||"Warning",description:i,status:"warning",duration:4e3,isClosable:!0})},[t]);return{handleError:n,handleSuccess:r,handleWarning:s}}const Ie=[{id:"laptop",name:"Gaming Laptop",price:1299.99,inStock:5},{id:"mouse",name:"Wireless Mouse",price:49.99,inStock:20},{id:"keyboard",name:"Mechanical Keyboard",price:129.99,inStock:8}];function al(t){return new Se({name:"shopping-cart",value:{items:[],totalCost:0},actions:{addItem:function(n,r,s){const i=n.items.findIndex(o=>o.productId===r);let a;i>=0?a=n.items.map((o,c)=>c===i?{...o,quantity:o.quantity+s}:o):a=[...n.items,{productId:r,quantity:s}],this.next({...n,items:a})},addItemFromEvent:function(n,r){const s=r.currentTarget,i=s.dataset.productId,a=parseInt(s.dataset.quantity||"1");if(!i){console.error("addItemFromEvent: missing data-product-id attribute");return}this.$.addItem(i,a)},removeItem:function(n,r){const s=n.items.filter(i=>i.productId!==r);this.next({...n,items:s})},updateQuantity:function(n,r,s){const i=n.items.map(a=>a.productId===r?{...a,quantity:s}:a);this.next({...n,items:i})},updateProduct:function(n,r,s){this.$.updateQuantity(r,s)},clearCart:function(){this.next({items:[],totalCost:0})},...t?{safeAddItemFromEvent:function(n,r){try{this.$.addItemFromEvent(r)}catch(s){t(s,"Cannot Add Item")}},safeUpdateQuantity:function(n,r,s){try{this.$.updateQuantity(r,s)}catch(i){t(i,"Cannot Update Quantity")}},safeAddItem:function(n,r,s){try{this.$.addItem(r,s)}catch(i){t(i,"Cannot Add Item")}}}:{}},prep:function(n,r){const s=n.items||r.items,i=s.reduce((a,o)=>{const c=Ie.find(u=>u.id===o.productId);return a+(c?c.price*o.quantity:0)},0);return{items:s,totalCost:i}},tests:[n=>{const r=n.items.map(i=>i.productId),s=new Set(r);return r.length!==s.size?"Cannot have the same product multiple times in cart - use quantity instead":null},n=>n.items.filter(s=>s.quantity<=0).length>0?"Cart cannot contain items with zero or negative quantities":null,n=>n.items.filter(s=>!Ie.find(i=>i.id===s.productId)).length>0?"Cart contains products that no longer exist":null,n=>n.items.filter(s=>{const i=Ie.find(a=>a.id===s.productId);return i&&s.quantity>i.inStock}).length>0?"Cannot add more items than available in stock":null,n=>{const r=n.items.reduce((s,i)=>{const a=Ie.find(o=>o.id===i.productId);return s+(a?a.price*i.quantity:0)},0);return Math.abs(n.totalCost-r)>.01?"Total cost calculation is incorrect - financial integrity violation":null},n=>n.items.reduce((s,i)=>s+i.quantity,0)>100?"Cart cannot contain more than 100 total items":null]})}const Bn=()=>{const{handleError:t}=Tt(),[n,r]=fe(()=>al(t)),[s,i]=X.useState([]);return e.jsx(I,{children:e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsx(h,{size:"lg",children:"Shopping Cart - Critical Business Rules"}),e.jsx(l,{color:"gray.600",children:'This example demonstrates validation for critical business rules that should prevent invalid states from being saved. These are "quantum constraints" and system limits that protect data integrity.'}),e.jsxs(d,{p:4,bg:"orange.50",borderRadius:"md",children:[e.jsx(l,{fontWeight:"semibold",mb:2,children:"🔒 Critical Rules (Tests):"}),e.jsxs(x,{spacing:1,align:"start",fontSize:"sm",children:[e.jsxs(l,{children:["• ",e.jsx("strong",{children:"No duplicates"})," - Same product can't appear twice (use quantity instead)"]}),e.jsxs(l,{children:["• ",e.jsx("strong",{children:"No negative quantities"})," - Quantities must be positive integers"]}),e.jsxs(l,{children:["• ",e.jsx("strong",{children:"Stock limits"})," - Cannot exceed available inventory"]}),e.jsxs(l,{children:["• ",e.jsx("strong",{children:"Valid products only"})," - Products must exist in catalog"]}),e.jsxs(l,{children:["• ",e.jsx("strong",{children:"System limits"})," - Maximum 100 total items per cart"]})]})]}),e.jsxs(Y,{columns:{base:1,lg:2},spacing:6,children:[e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsx(h,{size:"md",children:"Available Products"}),Ie.map(a=>e.jsx(d,{p:3,border:"1px",borderColor:"gray.200",borderRadius:"md",children:e.jsxs($,{justify:"space-between",children:[e.jsxs(x,{align:"start",spacing:1,children:[e.jsx(l,{fontWeight:"semibold",children:a.name}),e.jsxs(l,{fontSize:"sm",color:"gray.600",children:["$",a.price]}),e.jsxs(l,{fontSize:"xs",color:"gray.500",children:["Stock: ",a.inStock]})]}),e.jsx(R,{size:"sm",colorScheme:"forest","data-product-id":a.id,"data-quantity":"1",onClick:r.$.safeAddItemFromEvent,children:"Add to Cart"})]})},a.id)),e.jsxs(Y,{columns:{base:1,md:2},spacing:3,children:[e.jsx(R,{colorScheme:"red",variant:"outline",size:"sm","data-product-id":"invalid-product","data-quantity":"1",onClick:r.$.safeAddItemFromEvent,children:"Add Invalid Product"}),e.jsx(R,{colorScheme:"red",variant:"outline",size:"sm","data-product-id":"laptop","data-quantity":"10",onClick:r.$.safeAddItemFromEvent,children:"Exceed Stock"})]})]}),e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsxs($,{justify:"space-between",children:[e.jsx(h,{size:"md",children:"Shopping Cart"}),e.jsxs(S,{colorScheme:"blue",children:["Total: $",n.totalCost.toFixed(2)]})]}),s.length>0&&e.jsxs(ne,{status:"error",children:[e.jsx(re,{}),e.jsx(x,{align:"start",spacing:1,children:s.map((a,o)=>e.jsx(l,{fontSize:"sm",children:a},o))})]}),n.items.length===0?e.jsx(l,{color:"gray.500",textAlign:"center",py:4,children:"Cart is empty"}):e.jsx(x,{spacing:3,align:"stretch",children:n.items.map(a=>{const o=Ie.find(c=>c.id===a.productId);return e.jsx(d,{p:3,border:"1px",borderColor:"gray.200",borderRadius:"md",children:e.jsxs($,{justify:"space-between",children:[e.jsxs(x,{align:"start",spacing:1,children:[e.jsx(l,{fontWeight:"semibold",children:o?o.name:`Unknown (${a.productId})`}),e.jsxs(l,{fontSize:"sm",color:"gray.600",children:["$",o?o.price:0," each"]})]}),e.jsxs($,{spacing:2,children:[e.jsx(gn,{size:"sm",value:a.quantity,min:0,onChange:c=>{r.$.updateProduct(a.productId,parseInt(c)||0)},children:e.jsx(fn,{})}),e.jsx(R,{size:"sm",colorScheme:"red",variant:"outline",onClick:()=>r.$.removeItem(a.productId),children:"Remove"})]})]})},a.productId)})}),e.jsx(R,{colorScheme:"red",variant:"outline",onClick:()=>r.$.clearCart(),children:"Clear Cart"})]})]}),e.jsxs(d,{children:[e.jsx(h,{size:"md",mb:4,children:"Source Code - Error Handling with Toasts"}),e.jsx(l,{color:"gray.600",mb:4,children:"Here's how to implement global error handling with Chakra UI toasts for validation errors:"}),e.jsx(ue,{tabs:[{label:"Error Handler Hook",language:"typescript",code:`// hooks/useErrorHandler.ts
import { useToast } from '@chakra-ui/react';
import { useCallback } from 'react';

export function useErrorHandler() {
  const toast = useToast();

  const handleError = useCallback((error: Error | string, title?: string) => {
    const errorMessage = typeof error === 'string' ? error : error.message;

    toast({
      title: title || 'Validation Error',
      description: errorMessage,
      status: 'error',
      duration: 4000,
      isClosable: true,
    });
  }, [toast]);

  const handleSuccess = useCallback((message: string, title?: string) => {
    toast({
      title: title || 'Success',
      description: message,
      status: 'success',
      duration: 3000,
      isClosable: true,
    });
  }, [toast]);

  return { handleError, handleSuccess };
}`},{label:"Component Usage",language:"tsx",code:`// Component with error handling - pass handleError to factory
import useErrorHandler from '@/hooks/useErrorHandler';

const ShoppingCartDemo: React.FC = () => {
  const { handleError } = useErrorHandler();
  // Pass error handler to factory function
  const [cartState, cartStore] = useForestryLocal(() =>
    shoppingCartStoreFactory(handleError)
  );

  return (
    <Button
      data-product-id="invalid-product"
      data-quantity="1"
      onClick={cartStore.$.safeAddItemFromEvent}  // Use safe action directly
    >
      Add Invalid Product
    </Button>
  );
};`},{label:"Store Factory with Safe Actions",language:"typescript",code:`// Store factory that accepts error handler and creates safe actions
type ErrorHandler = (error: Error | string, title?: string) => void;

export default function shoppingCartStoreFactory(handleError?: ErrorHandler) {
  return new Store({
    value: { items: [], totalCost: 0 },

    actions: {
      addItemFromEvent: function(value, event) {
        // Regular action that can throw validation errors
        const productId = event.currentTarget.dataset.productId;
        this.$.addItem(productId, 1);
      },

      // Safe actions that catch validation errors and show toasts
      ...(handleError ? {
        safeAddItemFromEvent: function(value, event) {
          try {
            this.$.addItemFromEvent(event);
          } catch (error) {
            handleError(error as Error, 'Cannot Add Item');
          }
        },

        safeUpdateQuantity: function(value, productId, quantity) {
          try {
            this.$.updateQuantity(productId, quantity);
          } catch (error) {
            handleError(error as Error, 'Cannot Update Quantity');
          }
        }
      } : {})
    },

    tests: [
      // Critical business rules that throw errors
      (value: ShoppingCart) => {
        const invalidItems = value.items.filter(item =>
          !PRODUCTS.find(p => p.id === item.productId)
        )
        return invalidItems.length > 0
          ? 'Cart contains products that no longer exist'
          : null
      }
    ]
  })
}`},{label:"Global Toast Setup",language:"tsx",code:`// main.tsx - Global toast configuration
import { ChakraProvider } from '@chakra-ui/react'

ReactDOM.createRoot(document.getElementById('root')!).render(
  <ChakraProvider
    theme={theme}
    toastOptions={{
      defaultOptions: {
        position: 'top-right',
        duration: 4000
      }
    }}
  >
    <App />
  </ChakraProvider>
)`}]})]})]})})};function gt(t,n,r){const s=X.useRef(null);!s.current&&t&&typeof t.branch=="function"&&(s.current=t.branch(n,r));const[i,a]=X.useState(s.current?.value);return X.useEffect(()=>{if(s.current){const o=s.current.subscribe(a);return()=>{o?.unsubscribe()}}},[s.current]),[i,s.current]}function ol(){return new Se({name:"advanced-form",value:{username:{value:"",isValid:!0,errorString:""},email:{value:"",isValid:!0,errorString:""},age:{value:0,isValid:!0,errorString:""},isSubmitting:!1,canSubmit:!1,submitError:"Please fill out all fields"},actions:{setSubmitting:function(n,r){this.set("isSubmitting",r)}},prep:function(n,r){const s={...r,...n},i=s.username.isValid&&s.email.isValid&&s.age.isValid;return s.username.value.length>0&&s.email.value.length>0&&s.age.value>0?i?s.isSubmitting?(s.canSubmit=!1,s.submitError="Submitting..."):(s.canSubmit=!0,s.submitError=""):(s.canSubmit=!1,s.submitError="Please fix validation errors before submitting"):(s.canSubmit=!1,s.submitError="Please fill out all fields"),s},tests:[n=>n.username.value==="admin"&&n.email.value.includes("admin")?"Username and email combination already exists":null]})}function ll(t){return{value:{value:"",isValid:!0,errorString:"",dirty:!1},actions:{setValue:function(n,r){this.next({...n,value:r,dirty:!0})},setValueFromEvent:function(n,r){this.$.setValue(r.target.value)}},prep:function(n,r){const s={...r,...n};let i=!0,a="";return s.dirty&&s.value.length>0&&(s.value.length<3?(i=!1,a="Username too short (min 3 characters)"):s.value.length>20?(i=!1,a="Username too long (max 20 characters)"):s.value.includes(" ")?(i=!1,a="Username cannot contain spaces"):(["admin","root","system","api","null","undefined"].includes(s.value.toLowerCase())&&(i=!1,a="Username is reserved and cannot be used"),["spam","test123","delete","hack"].some(u=>s.value.toLowerCase().includes(u))&&(i=!1,a="Username contains inappropriate content"))),{...s,isValid:i,errorString:a}},res:new Map([["validationStatus",function(n){return{isValid:n.isValid,errorMessage:n.errorString,hasError:!n.isValid,fieldType:"username"}}],["usernameQuality",function(n){return{length:n.value.length,hasMinLength:n.value.length>=3,hasMaxLength:n.value.length<=20,isAvailable:!["admin","root","system"].includes(n.value.toLowerCase())}}],["characterAnalysis",function(n){return{hasLetters:/[a-zA-Z]/.test(n.value),hasNumbers:/[0-9]/.test(n.value),hasSpecialChars:/[^a-zA-Z0-9]/.test(n.value),isAlphanumeric:/^[a-zA-Z0-9]+$/.test(n.value)}}]]),tests:[]}}function cl(t){return{value:{value:"",isValid:!0,errorString:"",dirty:!1},actions:{setValue:function(n,r){this.next({...n,value:r,dirty:!0})},setValueFromEvent:function(n,r){this.$.setValue(r.target.value)}},prep:function(n,r){const s={...r,...n};let i=!0,a="";if(s.dirty&&s.value.length>0){const o=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if(s.value.length>100)i=!1,a="Email too long (max 100 characters)";else if(!o.test(s.value))i=!1,a="Invalid email format";else{const c=s.value.split("@")[1]?.toLowerCase();c&&["10minutemail.com","tempmail.org","guerrillamail.com","mailinator.com"].includes(c)&&(i=!1,a="Disposable email addresses are not allowed"),c&&["competitor.com","blocked-company.com"].includes(c)&&(i=!1,a="Email domain is not allowed for registration")}}return{...s,isValid:i,errorString:a}},res:new Map([["validationStatus",function(n){return{isValid:n.isValid,errorMessage:n.errorString,hasError:!n.isValid,fieldType:"email"}}],["domainAnalysis",function(n){const r=n.value.split("@")[1]?.toLowerCase()||"";return{domain:r,isGmail:r==="gmail.com",isOutlook:r.includes("outlook")||r.includes("hotmail"),isCorporate:!["gmail.com","yahoo.com","hotmail.com","outlook.com"].includes(r),isDisposable:["10minutemail.com","tempmail.org"].includes(r)}}],["formatQuality",function(n){return{hasAtSymbol:n.value.includes("@"),hasDomain:n.value.split("@").length===2,hasValidFormat:/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.value),length:n.value.length}}]]),tests:[]}}function dl(t){return{value:{value:0,isValid:!0,errorString:"",isDirty:!1},actions:{setValue:function(n,r){this.next({...n,value:r})},setValueFromEvent:function(n,r){const s=parseInt(r)||0;this.$.setValue(s)}},prep:function(n,r){const s={...r,...n};this.res.has("initialValue")||this.res.set("initialValue",s.value);const i=this.res.get("initialValue"),a=s.isDirty||s.value!==i;a&&(s.isDirty=!0);let o=!0,c="";return a&&(Number.isFinite(s.value)?s.value<0?(o=!1,c="Age cannot be negative"):Number.isInteger(s.value)?s.value<13?(o=!1,c="Users under 13 cannot create accounts due to COPPA regulations"):s.value>120&&(o=!1,c="Age must be realistic (max 120)"):(o=!1,c="Age must be a whole number"):(o=!1,c="Please enter a valid number")),{...s,isValid:o,errorString:c,isDirty:a}},res:new Map([["validationStatus",function(n){return{isValid:n.isValid,errorMessage:n.errorString,hasError:!n.isValid,fieldType:"age"}}],["coppaCompliant",function(n){return n.value>=13}],["dataQuality",function(n){return{isComplete:n.value>0,isRealistic:n.value<=120,isLegal:n.value>=13}}]]),tests:[]}}const ft=({field:t,branch:n,fieldType:r})=>{if(!t.value)return null;const s=()=>{const c=n.res.get("usernameQuality")?.(t),u=n.res.get("characterAnalysis")?.(t);return e.jsxs(e.Fragment,{children:[e.jsxs(l,{fontSize:"xs",color:"green.600",children:["✓ Length: ",c?.length," characters ",c?.hasMinLength&&c?.hasMaxLength?"(good)":"(needs 3-20)"]}),e.jsx(l,{fontSize:"xs",color:c?.isAvailable?"green.600":"red.500",children:c?.isAvailable?"✓ Username available":"✗ Username reserved"}),e.jsxs(l,{fontSize:"xs",color:"blue.600",children:["Format: ",u?.hasLetters?"Letters":""," ",u?.hasNumbers?"+ Numbers":""," ",u?.isAlphanumeric?"(clean)":"(special chars)"]})]})},i=()=>{if(!t.value.includes("@"))return null;const c=n.res.get("domainAnalysis")?.(t),u=n.res.get("formatQuality")?.(t);return e.jsxs(e.Fragment,{children:[e.jsxs(l,{fontSize:"xs",color:"blue.600",children:["Provider: ",c?.isGmail?"Gmail":c?.isOutlook?"Outlook":c?.isCorporate?"Corporate":"Other"," (",c?.domain,")"]}),e.jsx(l,{fontSize:"xs",color:c?.isDisposable?"red.500":"green.600",children:c?.isDisposable?"⚠️ Disposable email detected":"✓ Permanent email provider"}),e.jsxs(l,{fontSize:"xs",color:u?.hasValidFormat?"green.600":"orange.500",children:["Format: ",u?.hasValidFormat?"✓ Valid email format":"⚠️ Check email format"]})]})},a=()=>{if(t.value<=0)return null;const c=n.res.get("coppaCompliant")?.(t),u=n.res.get("dataQuality")?.(t);return e.jsxs(e.Fragment,{children:[e.jsx(l,{fontSize:"xs",color:c?"green.600":"red.500",children:c?"✓ COPPA compliant (13+)":"❌ Under 13 - COPPA restricted"}),e.jsx(l,{fontSize:"xs",color:u?.isRealistic?"green.600":"orange.500",children:u?.isRealistic?"✓ Realistic age":"⚠️ Age seems unrealistic"}),e.jsxs(l,{fontSize:"xs",color:"blue.600",children:["Status: ",u?.isComplete?"Complete":"Incomplete"," • ",u?.isLegal?"Legal":"Restricted"]})]})},o=()=>{switch(r){case"username":return s();case"email":return i();case"age":return a();default:return null}};return e.jsx(x,{align:"start",mt:2,spacing:1,children:o()})},Wn=()=>{const{handleSuccess:t}=Tt(),[n,r]=fe(ol),[s,i]=gt(r,"username",ll()),[a,o]=gt(r,"email",cl()),[c,u]=gt(r,"age",dl());return e.jsx(I,{children:e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsx(h,{size:"lg",children:"Advanced Form - Using Forest with Branches"}),e.jsxs(l,{color:"gray.600",children:["This example showcases Forestry 4's branch system. Only ",e.jsx("strong",{children:"Forests"})," can create branches - each form field is managed by its own branch with independent validation, while the parent forest coordinates overall form state."]}),e.jsxs(d,{p:4,bg:"blue.50",borderRadius:"md",children:[e.jsx(l,{fontWeight:"semibold",mb:2,children:"🌿 Branch Benefits:"}),e.jsxs(x,{spacing:1,align:"start",fontSize:"sm",children:[e.jsxs(l,{children:["• ",e.jsx("strong",{children:"Independent validation"})," - Each field has its own validation logic"]}),e.jsxs(l,{children:["• ",e.jsx("strong",{children:"Focused actions"})," - Field-specific actions like setValue()"]}),e.jsxs(l,{children:["• ",e.jsx("strong",{children:"Isolated state"})," - Changes to one field don't affect others"]}),e.jsxs(l,{children:["• ",e.jsx("strong",{children:"Coordinated updates"})," - Parent store sees all field changes"]}),e.jsxs(l,{children:["• ",e.jsx("strong",{children:"Modular design"})," - Easy to add/remove fields without affecting others"]})]})]}),e.jsxs(ne,{status:"info",children:[e.jsx(re,{}),e.jsxs(l,{fontSize:"sm",children:[e.jsx("strong",{children:"Key Points:"})," Only ",e.jsx("code",{children:"Forest"})," instances can create branches. Form submission state (",e.jsx("code",{children:"canSubmit"}),", ",e.jsx("code",{children:"submitError"}),") is calculated in prep functions as data state, not validation errors. This allows the UI to show why submission is disabled without throwing exceptions."]})]}),e.jsxs(Y,{columns:{base:1,lg:2},spacing:6,children:[e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsx(h,{size:"md",children:"Form Fields"}),e.jsxs(d,{children:[e.jsx(l,{mb:2,fontWeight:"semibold",children:"Username"}),e.jsx(ye,{value:s.value,onChange:i.$.setValueFromEvent,borderColor:s.isValid?"gray.200":"red.300"}),!s.isValid&&e.jsx(l,{fontSize:"sm",color:"red.500",mt:1,children:s.errorString}),e.jsx(ft,{field:s,branch:i,fieldType:"username"})]}),e.jsxs(d,{children:[e.jsx(l,{mb:2,fontWeight:"semibold",children:"Email"}),e.jsx(ye,{type:"email",value:a.value,onChange:o.$.setValueFromEvent,borderColor:a.isValid?"gray.200":"red.300"}),!a.isValid&&e.jsx(l,{fontSize:"sm",color:"red.500",mt:1,children:a.errorString}),e.jsx(ft,{field:a,branch:o,fieldType:"email"})]}),e.jsxs(d,{children:[e.jsx(l,{mb:2,fontWeight:"semibold",children:"Age"}),e.jsx(gn,{value:c.value,onChange:u.$.setValueFromEvent,children:e.jsx(fn,{borderColor:c.isValid?"gray.200":"red.300"})}),!c.isValid&&e.jsx(l,{fontSize:"sm",color:"red.500",mt:1,children:c.errorString}),e.jsx(ft,{field:c,branch:u,fieldType:"age"})]}),e.jsxs(x,{spacing:3,align:"stretch",children:[e.jsx(R,{colorScheme:"forest",isDisabled:!n.canSubmit,onClick:()=>{n.canSubmit&&(r.$.setSubmitting(!0),setTimeout(()=>{r.$.setSubmitting(!1),t("Form submitted successfully!","Registration Complete")},1e3))},isLoading:n.isSubmitting,children:"Submit Form"}),!n.canSubmit&&e.jsx(l,{fontSize:"sm",color:"orange.600",textAlign:"center",children:n.submitError})]})]}),e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsx(h,{size:"md",children:"Form State"}),e.jsxs(d,{p:4,bg:"gray.50",borderRadius:"md",fontFamily:"mono",fontSize:"sm",children:[e.jsx(l,{mb:2,fontWeight:"semibold",children:"Current Values:"}),e.jsxs(l,{children:['Username: "',n.username.value,'"']}),e.jsxs(l,{children:['Email: "',n.email.value,'"']}),e.jsxs(l,{children:["Age: ",n.age.value]})]}),e.jsxs(d,{p:4,bg:"gray.50",borderRadius:"md",fontFamily:"mono",fontSize:"sm",children:[e.jsx(l,{mb:2,fontWeight:"semibold",children:"Validation Status:"}),e.jsxs($,{children:[e.jsx(l,{children:"Username:"}),e.jsx(S,{colorScheme:n.username.isValid?"green":"red",children:n.username.isValid?"Valid":"Invalid"})]}),e.jsxs($,{children:[e.jsx(l,{children:"Email:"}),e.jsx(S,{colorScheme:n.email.isValid?"green":"red",children:n.email.isValid?"Valid":"Invalid"})]}),e.jsxs($,{children:[e.jsx(l,{children:"Age:"}),e.jsx(S,{colorScheme:n.age.isValid?"green":"red",children:n.age.isValid?"Valid":"Invalid"})]})]}),e.jsxs(d,{p:4,bg:"gray.50",borderRadius:"md",fontFamily:"mono",fontSize:"sm",children:[e.jsx(l,{mb:2,fontWeight:"semibold",children:"Form Status:"}),e.jsxs($,{children:[e.jsx(l,{children:"Can Submit:"}),e.jsx(S,{colorScheme:n.canSubmit?"green":"orange",children:n.canSubmit?"Yes":"No"})]}),e.jsxs($,{children:[e.jsx(l,{children:"Submitting:"}),e.jsx(S,{colorScheme:n.isSubmitting?"blue":"gray",children:n.isSubmitting?"Yes":"No"})]})]})]})]}),e.jsxs(d,{children:[e.jsx(h,{size:"md",mb:4,children:"Source Code - Forest Branches & Field Validation"}),e.jsx(l,{color:"gray.600",mb:4,children:"Here's how to implement advanced form validation using Forest branches with individual field state management:"}),e.jsx(ue,{tabs:[{label:"useForestBranch Hook",language:"typescript",code:`// hooks/useForestBranch.ts
import { useEffect, useState } from 'react';
import type { StoreIF } from '@wonderlandlabs/forestry4';

export default function useForestBranch<T>(
  store: StoreIF<any>,
  path: string,
  storeParams: Partial<StoreParams<T>>
): [T, StoreIF<T>] {
  const [branchStore, setBranchStore] = useState<StoreIF<T> | null>(null);
  const [branchValue, setBranchValue] = useState<T>();

  useEffect(() => {
    // Create branch from Forest (only Forest instances can branch)
    const branch = store.branch(path, storeParams);
    setBranchStore(branch);
    setBranchValue(branch.value);

    // Subscribe to branch changes
    const subscription = branch.subscribe((newValue: T) => {
      setBranchValue(newValue);
    });

    return () => {
      subscription.unsubscribe();
    };
  }, [store, path]);

  return [branchValue!, branchStore!];
}`},{label:"Form Component",language:"tsx",code:`// Advanced form with branches
const AdvancedFormDemo: React.FC = () => {
  // Main form Forest
  const [formValue, formForest] = useForestryLocal(formStateFactory);

  // Individual field branches
  const [usernameValue, usernameStore] = useForestBranch(
    formForest, 'username', usernameBranchConfig
  );
  const [emailValue, emailStore] = useForestBranch(
    formForest, 'email', emailBranchConfig
  );
  const [ageValue, ageStore] = useForestBranch(
    formForest, 'age', ageBranchConfig
  );

  return (
    <VStack spacing={4}>
      <Input
        placeholder="Username"
        value={usernameValue.value}
        onChange={usernameStore.$.setValueFromEvent}
        isInvalid={!usernameValue.isValid}
      />
      {!usernameValue.isValid && (
        <Text color="red.500" fontSize="sm">
          {usernameValue.errorString}
        </Text>
      )}
    </VStack>
  );
};`},{label:"Branch Configuration",language:"typescript",code:`// storeFactories/ValidationSystem/usernameBranch.ts
import type { FormField } from '@/types';

export const usernameBranchConfig = {
  value: { value: '', isValid: true, errorString: '' },

  actions: {
    setValueFromEvent: function(value: FormField<string>, event: React.ChangeEvent<HTMLInputElement>) {
      this.$.setValue(event.target.value)
    }
  },

  // UI validation in prep function (not critical business rules)
  prep: function(input: FormField<string>, current: FormField<string>) {
    const result = { ...current, ...input }

    // UI validation for user feedback
    if (result.value.length < 3) {
      result.isValid = false
      result.errorString = 'Username must be at least 3 characters'
    } else if (result.value.length > 20) {
      result.isValid = false
      result.errorString = 'Username cannot exceed 20 characters'
    } else {
      result.isValid = true
      result.errorString = ''
    }

    return result
  }
}`},{label:"Forest Factory",language:"typescript",code:`// storeFactories/ValidationSystem/formState.ts
import { Forest } from '@wonderlandlabs/forestry4';
import type { AdvancedForm } from '@/types';

export default function formStateFactory() {
  return new Forest<AdvancedForm>({
    name: 'advanced-form',
    value: {
      username: { value: '', isValid: true, errorString: '' },
      email: { value: '', isValid: true, errorString: '' },
      age: { value: 0, isValid: true, errorString: '' },
      isSubmitting: false,
      canSubmit: false,
      submitError: ''
    },

    actions: {
      setSubmitting: function (value: AdvancedForm, isSubmitting: boolean) {
        this.set('isSubmitting', isSubmitting);
      }
    },

    // Calculate form-level state from field states
    prep: function(input: AdvancedForm, current: AdvancedForm) {
      const result = { ...current, ...input }

      // Form can submit if all fields are valid and not currently submitting
      result.canSubmit = result.username.isValid &&
                        result.email.isValid &&
                        result.age.isValid &&
                        !result.isSubmitting

      // Set submit error message
      if (!result.canSubmit && !result.isSubmitting) {
        result.submitError = 'Please fix validation errors before submitting'
      } else {
        result.submitError = ''
      }

      return result
    }
  })
}`}]})]})]})})},ul=()=>e.jsx(I,{children:e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsx(h,{size:"lg",children:"Deeper Thoughts - Validation Troubleshooting Guide"}),e.jsx(l,{children:'There are basically two modes of validation - "hard" validation that prevents certain patterns from ever appearing in state and "soft" validation in which errors and gates change based on the validity of certain field(s).'}),e.jsxs(l,{as:"ul",size:"sm",children:[e.jsxs("li",{children:[e.jsx("b",{children:"Hard Validation"})," is managed in three different ways in Forest. Every new value candidate goes through these",e.jsxs("ol",{children:[e.jsxs("li",{children:[e.jsx("code",{children:".pre"}),' - a function that "filters" or fixes bad data; it occurs before tests are ran. It accepts a candidate value and returns a (potentially fixed) value. The purpose of pre is to catch "correctable" errors like data sorting, stringy numbers, or other minor flaws in prospective data. it is not ',e.jsx("i",{children:"technically"}),' a validator but it may prevent "mostly good" changes from being blocked on correctable issues']}),e.jsxs("li",{children:[e.jsx("code",{children:".schema"})," - managed by she schema property in the constructor params, it defines a Zod instance to define a schema that the state must follow; its basically parametric typescript - but unlike TS it is actually an enforced ruleset in React that dynamically blocks bad data from being entered in state."]}),e.jsxs("li",{children:[e.jsx("code",{children:".tests"})," - a function or array of functions that if they return a string or throw, prevent bad data from being saved into state; these test errors will throw to the outer scope; you may want to put catchers around code that might trigger tests. if tests is an array of functions, they are executed in order and any failure blocks subsequent tests from running."]})]})]}),e.jsxs("li",{children:[e.jsx("b",{children:"Soft Validation"}),' is encoded in pre or in actions to assert "annotation" on the state as a whole or specific fields; it is the sort of thing you expect to work with forms where the user is not prevented from entering a bad data, but they are'," ",e.jsx("i",{children:"infrormed"})," about the state of their field or form with error messages. Obviously, for this to work both the bad data and the error message (and potentially an isValid boolean) exist for every field and potentially the form as a whole. there are two ways of doing this - embedding these properties in state or writing actions such as",e.jsxs("code",{children:["isValid(value, fieldName, fieldValue): ","{isValid: boolean, error? string}"," "]}),"or ",e.jsxs("code",{children:["isEmailValid(): ","{isValid: boolean, error? string}"]})]})]}),e.jsxs(d,{layerStyle:"infoBox",bg:"blue.50",children:[e.jsx(h,{size:"sm",children:"🤔 In short:"}),e.jsxs(x,{spacing:2,align:"start",fontSize:"sm",children:[e.jsxs(l,{children:[e.jsx("strong",{children:'Transient ("soft") UI Feedback/ data correction'})," → Use"," ",e.jsx(Z,{children:"prep"}),"functions or feedback actions."]}),e.jsxs(l,{children:[e.jsx("strong",{children:"Type Safety, data prefiltering / sanitation?"})," → Use ",e.jsx(Z,{children:"Zod"})," ",'schema validation for "dynamic typescript like" format enforcement']}),e.jsxs(l,{children:[e.jsx("strong",{children:"Complex Business Rules?"})," → Use ",e.jsx(Z,{children:"tests"})," function(s)"]})]}),e.jsxs(l,{size:"sm",children:["again - data updating occurs ",e.jsx("b",{children:"in this order"}),"; if it matters, for instance, you can trust that your candidates conform to your schema before executing your tests."]})]}),e.jsxs(d,{layerStyle:"infoBox",bg:"gray.50",children:[e.jsx(h,{size:"sm",children:"📚 Complete Example - All Three Layers:"}),e.jsx(l,{fontSize:"sm",mb:3,children:"A shopping cart that uses Zod for structure, tests for business rules, and prep for UI state:"}),e.jsx(te,{snippetName:"shoppingCartValidation",folder:"ValidationSystem"})]}),e.jsxs(d,{layerStyle:"infoBox",bg:"gray.50",children:[e.jsx(h,{size:"sm",children:"Do I have to use Zod?"}),e.jsx(l,{children:"Technically the schema parameter expects an object with a parse(value) method that throws on bad code. If you don't want to pull in Zod you can put any other / a custom parser in to schema as long as it exposes a parse method; if it doesn't create an object and a parse method and enclose your validator inside of it. (FWIW Zod is not bundled with Forestry so this option may appeal if you are fanatic about bundle size reduction.)"})]})]})}),hl=()=>e.jsx(oe,{maxW:"container.xl",py:8,children:e.jsxs(x,{spacing:8,align:"stretch",children:[e.jsxs(d,{children:[e.jsx(h,{size:"xl",mb:4,children:"Validation System"}),e.jsx(l,{fontSize:"lg",color:"gray.600",children:"Learn about Forestry 4's comprehensive validation system with practical examples of schema validation, business logic tests, and UI state management."})]}),e.jsxs(ne,{status:"info",children:[e.jsx(re,{}),e.jsxs(l,{fontSize:"sm",children:[e.jsx("strong",{children:"Three-Layer Validation:"})," Use Zod for type safety, test functions for critical business rules, and prep functions for UI state. Each component below demonstrates these patterns in action."]})]}),e.jsx(Bn,{}),e.jsx(Wn,{}),e.jsx(ul,{})]})}),ml=()=>e.jsx(d,{maxW:"6xl",mx:"auto",p:6,children:e.jsxs(x,{spacing:8,align:"stretch",children:[e.jsxs(d,{textAlign:"center",children:[e.jsx(h,{size:"2xl",mb:4,children:"Schema Validation with Zod"}),e.jsx(l,{fontSize:"xl",color:"gray.600",maxW:"3xl",mx:"auto",children:"Use Zod schemas for runtime type validation and enhanced type safety in Forestry stores. Schemas provide structural validation, constraint enforcement, and clear error messages."})]}),e.jsx(I,{children:e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsx(h,{size:"lg",children:"Why Use Zod Schemas?"}),e.jsxs(Y,{columns:{base:1,md:2},spacing:6,children:[e.jsxs(d,{layerStyle:"card",bg:"green.50",children:[e.jsx(h,{size:"md",mb:2,color:"green.700",children:"Runtime Validation"}),e.jsx(l,{fontSize:"sm",children:"Catch invalid state structures at runtime, preventing bugs from malformed data that TypeScript alone cannot detect."})]}),e.jsxs(d,{layerStyle:"card",bg:"blue.50",children:[e.jsx(h,{size:"md",mb:2,color:"blue.700",children:"Type Safety"}),e.jsxs(l,{fontSize:"sm",children:["Generate TypeScript types directly from schemas using ",e.jsx(Z,{children:"z.infer"}),", ensuring perfect alignment between runtime and compile-time validation."]})]}),e.jsxs(d,{layerStyle:"card",bg:"purple.50",children:[e.jsx(h,{size:"md",mb:2,color:"purple.700",children:"Constraint Enforcement"}),e.jsx(l,{fontSize:"sm",children:"Define business rules like min/max values, string patterns, and array lengths directly in the schema for automatic validation."})]}),e.jsxs(d,{layerStyle:"card",bg:"orange.50",children:[e.jsx(h,{size:"md",mb:2,color:"orange.700",children:"Clear Error Messages"}),e.jsx(l,{fontSize:"sm",children:"Zod provides detailed, human-readable error messages that help developers quickly identify and fix validation issues."})]})]})]})}),e.jsx(I,{children:e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsx(h,{size:"lg",children:"Basic Schema Setup"}),e.jsxs(l,{color:"gray.600",children:["Define your state schema and use it as the ",e.jsx(Z,{children:"schema"})," property in Store constructor. Forestry will automatically validate state changes against this schema."]}),e.jsx(te,{snippetName:"zodSchemaValidation",folder:"ActionsState"})]})}),e.jsx(I,{children:e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsx(h,{size:"lg",children:"Common Schema Patterns"}),e.jsx(ue,{tabs:[{label:"Basic Types",language:"typescript",snippet:"basicTypes",folder:"SchemaValidation"},{label:"Complex Objects",language:"typescript",snippet:"complexObjects",folder:"SchemaValidation"},{label:"Arrays & Validation",language:"typescript",snippet:"arraysValidation",folder:"SchemaValidation"},{label:"Conditional Logic",language:"typescript",snippet:"conditionalLogic",folder:"SchemaValidation"}]})]})}),e.jsx(I,{children:e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsx(h,{size:"lg",children:"Integration with Prep Functions"}),e.jsx(l,{color:"gray.600",children:"While schemas handle structural validation, prep functions handle business logic and user input validation. They work together for comprehensive validation."}),e.jsxs(ne,{status:"info",children:[e.jsx(re,{}),e.jsxs(d,{children:[e.jsx(l,{fontWeight:"semibold",children:"Schema vs Prep Validation"}),e.jsxs(cr,{mt:2,spacing:1,children:[e.jsxs(g,{children:[e.jsx("strong",{children:"Schema:"})," Structure, types, constraints (throws errors)"]}),e.jsxs(g,{children:[e.jsx("strong",{children:"Prep:"})," Business rules, user input (sets quality feedback)"]})]})]})]}),e.jsx(te,{snippetName:"schemaPrepIntegration",folder:"SchemaValidation"})]})}),e.jsx(I,{children:e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsx(h,{size:"lg",children:"Schema Best Practices"}),e.jsxs(Y,{columns:{base:1,lg:2},spacing:6,children:[e.jsxs(d,{children:[e.jsx(h,{size:"md",mb:3,color:"green.600",children:"✅ Do"}),e.jsxs(x,{spacing:3,align:"stretch",children:[e.jsxs(d,{layerStyle:"highlight",bg:"green.50",children:[e.jsx(l,{fontWeight:"semibold",children:"Define schemas at factory level"}),e.jsx(l,{fontSize:"sm",color:"gray.600",children:"Create schemas alongside your factory functions for reusability"})]}),e.jsxs(d,{layerStyle:"highlight",bg:"green.50",children:[e.jsx(l,{fontWeight:"semibold",children:"Use meaningful constraints"}),e.jsx(l,{fontSize:"sm",color:"gray.600",children:"Add min/max, patterns, and business-relevant validation rules"})]}),e.jsxs(d,{layerStyle:"highlight",bg:"green.50",children:[e.jsx(l,{fontWeight:"semibold",children:"Infer TypeScript types"}),e.jsxs(l,{fontSize:"sm",color:"gray.600",children:["Use ",e.jsx(Z,{children:"z.infer<typeof Schema>"})," for type safety"]})]})]})]}),e.jsxs(d,{children:[e.jsx(h,{size:"md",mb:3,color:"red.600",children:"❌ Don't"}),e.jsxs(x,{spacing:3,align:"stretch",children:[e.jsxs(d,{layerStyle:"highlight",bg:"red.50",children:[e.jsx(l,{fontWeight:"semibold",children:"Duplicate validation logic"}),e.jsx(l,{fontSize:"sm",color:"gray.600",children:"Don't repeat schema constraints in prep functions"})]}),e.jsxs(d,{layerStyle:"highlight",bg:"red.50",children:[e.jsx(l,{fontWeight:"semibold",children:"Over-constrain schemas"}),e.jsx(l,{fontSize:"sm",color:"gray.600",children:"Keep schemas focused on structure, not business rules"})]}),e.jsxs(d,{layerStyle:"highlight",bg:"red.50",children:[e.jsx(l,{fontWeight:"semibold",children:"Ignore schema errors"}),e.jsx(l,{fontSize:"sm",color:"gray.600",children:"Schema validation errors indicate serious structural issues"})]})]})]})]})]})})]})}),pl=t=>{if(!t)throw new Error("handleError absent");return new Se({value:{balance:1e3,transactions:[],pendingOperations:0,isProcessing:!1},res:new Map([["handleError",t]]),actions:{transfer(n,r,s){if(r<=0)throw new Error("Transfer amount must be positive");if(n.balance<r)throw new Error("Insufficient funds");const i=n.balance-r,a={id:Math.random().toString(36).substr(2,9),amount:-r,description:s,timestamp:Date.now()};this.next({...n,balance:i,transactions:[...n.transactions,a]})},deposit(n,r,s){if(r<=0)throw new Error("Deposit amount must be positive");const i={id:Math.random().toString(36).substr(2,9),amount:r,description:s,timestamp:Date.now()};this.next({...n,balance:n.balance+r,transactions:[...n.transactions,i]})},processPayroll(n,r){this.transact({suspendValidation:!0,action(){this.next({...this.value,pendingOperations:r.length});let s=0;const i=[];for(const a of r){if(a.salary<=0)throw new Error(`Invalid salary for ${a.name}`);s+=a.salary,i.push({id:Math.random().toString(36).substr(2,9),amount:-a.salary,description:`Payroll: ${a.name}`,timestamp:Date.now()})}if(this.value.balance<s)throw new Error(`Insufficient funds for payroll. Need $${s}, have $${this.value.balance}`);this.next({balance:this.value.balance-s,transactions:[...this.value.transactions,...i],pendingOperations:0})}})},safeTransfer(n,r,s){try{this.$.transfer(r,s)}catch(i){this.res.get("handleError")(i)}},safeDeposit(n,r,s){try{this.$.deposit(r,s)}catch(i){this.res.get("handleError")(i)}},safeProcessPayroll(n,r){try{this.$.processPayroll(r)}catch(s){this.res.get("handleError")(s)}},handlePayrollDemo(n){this.next({...n,isProcessing:!0});const r=[{name:"Alice Johnson",salary:300},{name:"Bob Smith",salary:250},{name:"Carol Davis",salary:400}];setTimeout(()=>{try{this.$.processPayroll(r)}catch(s){this.res.get("handleError")(s)}finally{this.set("isProcessing",!1)}},1e3)},handleFailedPayroll(){const n=[{name:"Alice Johnson",salary:500},{name:"Bob Smith",salary:600},{name:"Carol Davis",salary:700}];this.$.safeProcessPayroll(n)}},reset(){this.next({balance:1e3,transactions:[],pendingOperations:0,isProcessing:!1})},tests(n){return n.balance<0?"Account balance cannot be negative":null}})},gl=()=>{const{handleError:t}=Tt(),[n,r]=fe(pl,t);ve("white","gray.800");const s=ve("gray.200","gray.600");return e.jsx(oe,{maxW:"container.xl",py:8,children:e.jsxs(x,{spacing:8,align:"stretch",children:[e.jsxs(d,{children:[e.jsx(h,{size:"xl",mb:4,children:"Transaction System"}),e.jsx(l,{fontSize:"lg",color:"gray.600",mb:6,children:"Forestry 4's transaction system provides atomic operations with automatic rollback, validation suspension, and nested transaction support for complex business operations. Not only does a transaction ensure complex operations succeed or fail as a unit, it also reduces the number of updates to subscribers; since subscribers only update after all of the actions' body is complete, you can do multiple operations inside a transactions function and only output one update to subscribers. If transactions are nested the outermost transaction constrains the output."}),e.jsxs(ne,{status:"info",mb:6,children:[e.jsx(re,{}),e.jsxs(d,{children:[e.jsx(l,{fontWeight:"semibold",children:"Key Benefits"}),e.jsx(l,{fontSize:"sm",mt:1,children:"Transactions ensure data consistency by grouping multiple operations into atomic units. If any operation fails, all changes are automatically rolled back to maintain data integrity."})]})]})]}),e.jsxs(I,{title:"Core Transaction Concepts",children:[e.jsxs(Y,{columns:{base:1,md:2},spacing:6,children:[e.jsxs(d,{children:[e.jsxs(h,{size:"md",mb:3,color:"green.600",children:[e.jsx(z,{mr:2}),"Atomic Operations"]}),e.jsx(l,{fontSize:"sm",color:"gray.600",mb:3,children:"All operations within a transaction succeed or fail together. No partial updates."}),e.jsxs(G,{spacing:2,fontSize:"sm",children:[e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),"Multiple state changes grouped together"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),"Automatic rollback on any failure"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),"Maintains data consistency"]})]})]}),e.jsxs(d,{children:[e.jsxs(h,{size:"md",mb:3,color:"blue.600",children:[e.jsx(Ce,{mr:2}),"Validation Suspension"]}),e.jsx(l,{fontSize:"sm",color:"gray.600",mb:3,children:"Temporarily allow invalid intermediate states during complex operations."}),e.jsxs(G,{spacing:2,fontSize:"sm",children:[e.jsxs(g,{children:[e.jsx(b,{as:Ce,color:"blue.500"}),"Suspend validation during transaction"]}),e.jsxs(g,{children:[e.jsx(b,{as:Ce,color:"blue.500"}),"Final state must still be valid"]}),e.jsxs(g,{children:[e.jsx(b,{as:Ce,color:"blue.500"}),"Enables complex multi-step operations"]})]})]})]}),e.jsx(Le,{my:6}),e.jsxs(d,{children:[e.jsxs(h,{size:"md",mb:3,color:"purple.600",children:[e.jsx(be,{mr:2}),"Nested Transactions"]}),e.jsx(l,{fontSize:"sm",color:"gray.600",mb:3,children:"Transactions can be nested, with inner transactions rolling back to outer transaction boundaries."}),e.jsxs(G,{spacing:2,fontSize:"sm",children:[e.jsxs(g,{children:[e.jsx(b,{as:be,color:"purple.500"}),"Inner transactions can be caught and handled"]}),e.jsxs(g,{children:[e.jsx(b,{as:be,color:"purple.500"}),"Outer transaction continues if inner error is caught"]}),e.jsxs(g,{children:[e.jsx(b,{as:be,color:"purple.500"}),"Uncaught errors bubble up and rollback all levels; use try/catch to interrupt cascading failure"]})]})]})]}),e.jsxs(I,{title:"Live Transaction Demo",children:[e.jsx(l,{color:"gray.600",mb:6,children:"This banking demo shows atomic transactions in action. Try the payroll processing to see how multiple operations are grouped together."}),e.jsxs(Y,{columns:{base:1,lg:2},spacing:6,children:[e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsxs(d,{p:4,bg:"green.50",borderRadius:"md",border:"1px",borderColor:"green.200",children:[e.jsxs($,{justify:"space-between",mb:2,children:[e.jsx(l,{fontWeight:"semibold",children:"Account Balance"}),e.jsxs(S,{colorScheme:"green",fontSize:"lg",children:["$",n.balance.toFixed(2)]})]}),n.pendingOperations>0&&e.jsxs(l,{fontSize:"sm",color:"orange.600",children:["Processing ",n.pendingOperations," operations..."]}),n.isProcessing&&e.jsx(l,{fontSize:"sm",color:"blue.600",children:"Processing payroll..."})]}),e.jsxs(x,{spacing:2,children:[e.jsx(R,{colorScheme:"blue",onClick:()=>r.$.safeDeposit(500,"Demo deposit"),size:"sm",width:"full",children:"Deposit $500"}),e.jsx(R,{colorScheme:"orange",onClick:()=>r.$.safeTransfer(200,"Demo transfer"),size:"sm",width:"full",children:"Transfer $200"}),e.jsx(R,{colorScheme:"green",onClick:()=>r.$.handlePayrollDemo(),isLoading:n.isProcessing,loadingText:"Processing...",size:"sm",width:"full",children:"Process Payroll ($950)"}),e.jsx(R,{colorScheme:"red",variant:"outline",onClick:()=>r.$.handleFailedPayroll(),size:"sm",width:"full",children:"Try Failed Payroll ($1800)"}),e.jsx(R,{variant:"outline",onClick:()=>r.$.reset(),size:"sm",width:"full",children:"Reset Demo"})]})]}),e.jsxs(d,{children:[e.jsx(h,{size:"md",mb:3,children:"Recent Transactions"}),e.jsx(d,{maxHeight:"300px",overflowY:"auto",border:"1px",borderColor:s,borderRadius:"md",p:3,children:n.transactions.length===0?e.jsx(l,{color:"gray.500",textAlign:"center",py:4,children:"No transactions yet"}):e.jsx(x,{spacing:2,align:"stretch",children:n.transactions.slice(-10).reverse().map(i=>e.jsxs(d,{p:2,bg:i.amount>0?"green.50":"red.50",borderRadius:"sm",fontSize:"sm",children:[e.jsxs($,{justify:"space-between",children:[e.jsx(l,{children:i.description}),e.jsxs(l,{fontWeight:"semibold",color:i.amount>0?"green.600":"red.600",children:[i.amount>0?"+":"","$",i.amount.toFixed(2)]})]}),e.jsx(l,{fontSize:"xs",color:"gray.500",children:new Date(i.timestamp).toLocaleTimeString()})]},i.id))})})]})]})]}),e.jsx(I,{title:"Transaction API",children:e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsxs(d,{children:[e.jsx(h,{size:"md",mb:3,children:"Basic Transaction Syntax"}),e.jsx(te,{snippetName:"basicTransactionSyntax",folder:"Transactions",language:"typescript"})]}),e.jsxs(d,{children:[e.jsx(h,{size:"md",mb:3,children:"Transaction Parameters"}),e.jsx(d,{p:4,bg:"gray.50",borderRadius:"md",children:e.jsxs(x,{spacing:3,align:"stretch",children:[e.jsxs(N,{title:"suspendValidation: boolean",titleAsCode:!0,snippetName:"suspendValidationExample",snippetFolder:"Transactions",codeTitle:"Validation Suspension Example",children:["When ",e.jsx(Z,{children:"true"}),", validation is suspended during the transaction, allowing temporarily invalid states. Final state must still be valid."]}),e.jsxs(N,{title:"action: (value: DataType) => void",titleAsCode:!0,snippetName:"actionFunctionExample",snippetFolder:"Transactions",codeTitle:"Action Function Example",children:["The function containing all operations to be executed atomically. Use",e.jsx(Z,{children:"this.$"})," to call other actions within the transaction. Actions"," ",e.jsx("i",{children:"cannot be lambdas / arrow functions"})," and must be ",e.jsx("b",{children:"synchronous"}),". Transactional integrity cannot be maintained over async operations, but you can call transactions from inside async functions (as long as the action itself is sync)."]})]})})]}),e.jsxs(d,{children:[e.jsx(h,{size:"md",mb:3,children:"Error Handling & Rollback"}),e.jsx(te,{snippetName:"errorHandlingRollback",folder:"Transactions",language:"typescript"})]})]})}),e.jsx(I,{title:"Advanced Transaction Patterns",children:e.jsx(ue,{tabs:[{label:"Shopping Cart Checkout",language:"typescript",code:`// Complex e-commerce checkout process
const checkoutActions = {
  processCheckout(value, paymentInfo, shippingInfo) {
    this.transact({
      suspendValidation: true,
      action() {
        // Step 1: Validate cart isn't empty
        if (this.value.items.length === 0) {
          throw new Error('Cart is empty')
        }

        // Step 2: Reserve inventory (may temporarily create negative stock)
        for (const item of this.value.items) {
          this.$.reserveInventory(item.productId, item.quantity)
        }

        // Step 3: Process payment
        const paymentResult = this.$.processPayment(
          this.value.totalAmount,
          paymentInfo
        )

        // Step 4: Create order record
        const orderId = this.$.createOrder({
          items: this.value.items,
          paymentId: paymentResult.id,
          shipping: shippingInfo,
          total: this.value.totalAmount
        })

        // Step 5: Clear cart and update user's order history
        this.$.clearCart()
        this.$.addToOrderHistory(orderId)

        // Step 6: Send confirmation email
        this.$.sendOrderConfirmation(orderId, paymentInfo.email)
      }
    })
  }
}`},{label:"Nested Transactions",language:"typescript",code:`// Nested transactions with error recovery
const batchActions = {
  processBatchUpdates(value, updates) {
    this.transact({
      suspendValidation: true,
      action() {
        const results = []
        const errors = []

        for (const update of updates) {
          try {
            // Inner transaction for each update
            this.transact({
              action() {
                this.$.validateUpdate(update)
                this.$.applyUpdate(update)
                this.$.logUpdate(update.id)
              }
            })
            results.push({ id: update.id, status: 'success' })
          } catch (error) {
            // Catch inner transaction error, continue with batch
            errors.push({ id: update.id, error: error.message })
          }
        }

        // Update batch results
        this.$.setBatchResults(results, errors)

        // If too many errors, fail the entire batch
        if (errors.length > updates.length * 0.5) {
          throw new Error(\`Batch failed: \${errors.length} of \${updates.length} updates failed\`)
        }
      }
    })
  }
}`},{label:"Transaction Monitoring",language:"typescript",code:`// Monitor transaction stack for debugging
const store = new Store({
  value: { count: 0, operations: [] },
  actions: {
    complexOperation(value) {
      this.transact({
        suspendValidation: true,
        action() {
          this.$.step1()
          this.$.step2()
          this.$.step3()
        }
      })
    }
  }
})

// Subscribe to transaction stack changes
const stackSubscription = store.observeTransStack((stack) => {
  console.log('Transaction stack:', stack.map(t => ({
    id: t.id,
    isTransaction: t.isTransaction,
    suspendValidation: t.suspendValidation
  })))
})

// Monitor for debugging
store.$.complexOperation()

// Clean up
stackSubscription.unsubscribe()`},{label:"Safe Action Patterns",language:"typescript",code:`// Pattern for creating safe actions that handle transaction errors
function createStoreWithSafeActions(errorHandler) {
  return new Store({
    value: { data: [], status: 'idle' },

    actions: {
      // Regular actions that can throw
      dangerousUpdate(value, newData) {
        this.transact({
          action() {
            this.$.validateData(newData)
            this.$.updateData(newData)
            this.$.notifySubscribers()
          }
        })
      },

      // Safe versions that catch and handle errors
      ...(errorHandler ? {
        safeDangerousUpdate(value, newData) {
          try {
            this.$.dangerousUpdate(newData)
          } catch (error) {
            errorHandler(error, 'Update Failed')
            // Optionally set error state
            this.next({ ...this.value, status: 'error' })
          }
        }
      } : {})
    }
  })
}

// Usage with error handling
const { handleError } = useErrorHandler()
const store = createStoreWithSafeActions(handleError)

// Use safe actions in UI
<Button onClick={() => store.$.safeDangerousUpdate(newData)}>
  Update Data
</Button>`}]})}),e.jsx(I,{title:"Best Practices",children:e.jsxs(Y,{columns:{base:1,md:2},spacing:6,children:[e.jsx(x,{spacing:4,align:"stretch",children:e.jsxs(d,{children:[e.jsx(h,{size:"sm",color:"green.600",mb:2,children:"✅ Best Practices"}),e.jsxs(G,{spacing:2,fontSize:"sm",children:[e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),"Use transactions for multi-step operations that must succeed or fail together"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),"Suspend validation when intermediate states may be temporarily invalid"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),"Keep transaction functions focused and atomic"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),"Use ",e.jsx(Z,{children:"this.$"})," to call other actions within transactions"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),"Handle transaction errors gracefully with try/catch"]})]})]})}),e.jsx(x,{spacing:4,align:"stretch",children:e.jsxs(d,{children:[e.jsx(h,{size:"sm",color:"red.600",mb:2,children:"❌ Avoid This"}),e.jsxs(G,{spacing:2,fontSize:"sm",children:[e.jsxs(g,{children:[e.jsx(b,{as:be,color:"red.500"}),"Don't use transactions for simple single-step operations"]}),e.jsxs(g,{children:[e.jsx(b,{as:be,color:"red.500"}),"Don't nest transactions unnecessarily deep"]}),e.jsxs(g,{children:[e.jsx(b,{as:be,color:"red.500"}),"Don't expect suspended transactions to permanently sidestep validation. the suspendValidation only is in effect until the close of the function."]}),e.jsxs(g,{children:[e.jsx(b,{as:be,color:"red.500"}),"Don't perform async operations inside transaction functions"]})]})]})})]})}),e.jsx(I,{title:"Troubleshooting",children:e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsxs(d,{children:[e.jsx(h,{size:"md",mb:3,color:"orange.600",children:"Common Issues & Solutions"}),e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsxs(d,{p:4,bg:"orange.50",borderRadius:"md",border:"1px",borderColor:"orange.200",children:[e.jsx(l,{fontWeight:"semibold",color:"orange.800",mb:2,children:'"Transaction failed but state seems unchanged"'}),e.jsx(l,{fontSize:"sm",color:"gray.700",mb:2,children:"This is expected behavior. When a transaction fails, all changes are rolled back automatically."}),e.jsx(K,{language:"typescript",children:`// Check transaction errors
try {
  store.transact({
    action() {
      this.$.step1() // ✅ Success
      this.$.step2() // ❌ Fails here
      this.$.step3() // Never executed
    }
  })
} catch (error) {
  console.log('Transaction rolled back:', error.message)
  // Store state is exactly as it was before the transaction
}`})]}),e.jsxs(d,{p:4,bg:"red.50",borderRadius:"md",border:"1px",borderColor:"red.200",children:[e.jsx(l,{fontWeight:"semibold",color:"red.800",mb:2,children:'"Validation errors even with suspendValidation: true"'}),e.jsxs(l,{fontSize:"sm",color:"gray.700",mb:2,children:[e.jsx(Z,{children:"suspendValidation"})," only suspends validation during the transaction. The final state must still pass all validation rules."]}),e.jsx(K,{language:"typescript",children:`store.transact({
  suspendValidation: true,
  action() {
    // These intermediate states can be invalid
    this.next({ balance: -100 }) // Temporarily negative
    this.next({ balance: 50 })   // Still negative

    // But final state must be valid
    this.next({ balance: 200 })  // ✅ Valid final state
  }
})`})]}),e.jsxs(d,{p:4,bg:"blue.50",borderRadius:"md",border:"1px",borderColor:"blue.200",children:[e.jsx(l,{fontWeight:"semibold",color:"blue.800",mb:2,children:'"Nested transaction behavior is confusing"'}),e.jsx(l,{fontSize:"sm",color:"gray.700",mb:2,children:"Inner transactions can be caught and handled. Only uncaught errors bubble up to outer transactions."}),e.jsx(K,{language:"typescript",children:`store.transact({
  action() {
    try {
      // Inner transaction that might fail
      this.transact({
        action() {
          this.$.riskyOperation() // Might throw
        }
      })
    } catch (innerError) {
      // Handle inner transaction failure
      this.$.handleError(innerError)
      // Outer transaction continues
    }

    this.$.finalStep() // This still executes
  }
})`})]})]})]}),e.jsxs(d,{children:[e.jsx(h,{size:"md",mb:3,children:"Debugging Transactions"}),e.jsx(l,{fontSize:"sm",color:"gray.600",mb:3,children:"Use the transaction stack observer to debug complex transaction flows:"}),e.jsx(K,{language:"typescript",children:`// Enable transaction debugging
const debugSub = store.observeTransStack((stack) => {
  console.log('Transaction Stack:', stack.map(t => ({
    id: t.id.slice(-8), // Show last 8 chars of ID
    isTransaction: t.isTransaction,
    suspendValidation: t.suspendValidation,
    hasValue: !!t.value
  })))
})

// Your transaction code here
store.transact({
  suspendValidation: true,
  action() {
    // Watch the console to see stack changes
    this.$.complexOperation()
  }
})

// Clean up when done
debugSub.unsubscribe()`})]})]})})]})})},fl=()=>e.jsxs(oe,{maxW:"container.xl",py:8,children:[e.jsxs(h,{size:"xl",mb:4,children:["RxJS Integration",e.jsx(S,{ml:3,colorScheme:"purple",children:"Power Tool"})]}),e.jsx(I,{title:"Leverage RxJS operators and reactive programming patterns with Forestry 4",children:e.jsxs(d,{children:[e.jsxs(l,{mt:4,children:["Every store exposes an rxjs subject. you can observe or ",e.jsx("code",{children:".pipe(...)"}),"a stores' output to throttle it, or conbine or modify store stream(s)."]}),e.jsxs(l,{children:["Stores follow the observable pattern closely; they don't immediately derive from BehaviorSubjects but they do follow the pattern - methods like"," ",e.jsx("code",{children:"next(candidate), complete, subscribe"}),"behave as you would expect for an RxJS Observable."]})]})}),e.jsx(I,{title:"Immer values for consisntly unique values",children:e.jsxs(d,{children:[e.jsxs(l,{fontSize:"lg",children:[e.jsx("a",{href:"https://immerjs.github.io/immer/",children:"Immer"})," enforces immutability and as a side effect unique references in store values"]}),e.jsx(l,{mt:4,children:"Like ReactToolkit, values in states are immutable; this has strong benefits in react ensuring that for instance, every time you add an element to an array or map, its returned as a new array or map every time, triggering updates to dependency lists or components."}),e.jsxs(l,{children:["the ",e.jsx("code",{children:".mutate()"})," method in stores are in fact wrappers for immer providers."]})]})})]}),xl=()=>e.jsx(oe,{maxW:"container.xl",py:8,children:e.jsxs(d,{children:[e.jsxs(h,{size:"xl",mb:4,children:["Advanced Patterns",e.jsx(S,{ml:3,colorScheme:"purple",children:"Power Tool"})]}),e.jsx(l,{fontSize:"lg",color:"gray.600",children:"Advanced patterns, debugging techniques, and performance optimization."}),e.jsx(l,{mt:4,color:"gray.500",children:"This page is under construction. Coming soon!"})]})}),jl=()=>e.jsx(d,{children:e.jsxs(yt,{children:[e.jsx(d,{layerStyle:"sidebar",children:e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsxs(d,{children:[e.jsx(h,{size:"md",mb:4,children:"API Reference"}),e.jsx(l,{fontSize:"sm",color:"gray.600",children:"Navigate to any section"})]}),e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsxs(d,{children:[e.jsx(l,{fontWeight:"semibold",color:"blue.600",mb:2,children:"Core Classes"}),e.jsxs(x,{spacing:1,align:"stretch",pl:2,children:[e.jsx(de,{href:"#forest",layerStyle:"navLink",children:"Forest"}),e.jsx(de,{href:"#forestbranch",layerStyle:"navLink",children:"ForestBranch"})]})]}),e.jsxs(d,{children:[e.jsx(l,{fontWeight:"semibold",color:"green.600",mb:2,children:"Forest Methods"}),e.jsxs(x,{spacing:1,align:"stretch",pl:2,children:[e.jsx(de,{href:"#forest-constructor",layerStyle:"navLink",children:"Constructor & Properties"}),e.jsx(de,{href:"#forest-core",layerStyle:"navLink",children:"Core"}),e.jsx(de,{href:"#forest-branching",layerStyle:"navLink",children:"Branching"}),e.jsx(de,{href:"#forest-transactions",layerStyle:"navLink",children:"Transaction"}),e.jsx(de,{href:"#forest-validation",layerStyle:"navLink",children:"Validation"})]})]}),e.jsxs(d,{children:[e.jsx(l,{fontWeight:"semibold",color:"purple.600",mb:2,children:"ForestBranch Methods"}),e.jsxs(x,{spacing:1,align:"stretch",pl:2,children:[e.jsx(de,{href:"#branch-properties",layerStyle:"navLink",children:"Branch Properties"}),e.jsx(de,{href:"#branch-methods",layerStyle:"navLink",children:"Overridden Methods"})]})]}),e.jsxs(d,{children:[e.jsx(l,{fontWeight:"semibold",color:"orange.600",mb:2,children:"Types"}),e.jsxs(x,{spacing:1,align:"stretch",pl:2,children:[e.jsx(B,{href:"#types-config",layerStyle:"navLink",children:"Configuration Types"}),e.jsx(B,{href:"#types-actions",layerStyle:"navLink",children:"Action Types"}),e.jsx(B,{href:"#types-validation",layerStyle:"navLink",children:"Validation Types"}),e.jsx(B,{href:"#types-utility",layerStyle:"navLink",children:"Utility Types"})]})]})]})]})}),e.jsx(d,{layerStyle:"mainContent",children:e.jsx(oe,{maxW:"container.lg",children:e.jsxs(x,{spacing:12,align:"stretch",children:[e.jsxs(d,{children:[e.jsxs(h,{size:"xl",mb:4,children:["API Reference",e.jsx(S,{ml:3,colorScheme:"blue",children:"Reference"})]}),e.jsx(l,{textStyle:"hero",children:"Complete API documentation for Forest and ForestBranch classes."})]}),e.jsxs(d,{id:"forest",children:[e.jsxs($,{mb:4,children:[e.jsx(h,{size:"lg",children:"Forest"}),e.jsx(S,{colorScheme:"green",children:"Class"})]}),e.jsx(l,{textStyle:"body",children:"The primary reactive state management class that supports branching and hierarchical state management. Forest includes all core store functionality plus advanced features for managing complex nested data structures."})]}),e.jsxs(d,{id:"forest-constructor",layerStyle:"methodCard",children:[e.jsx(h,{size:"md",mb:4,children:"Constructor & Properties"}),e.jsx(d,{mb:6,children:e.jsx(N,{title:"new Forest<DataType, Actions>(params: StoreParams)",children:"Creates a new Forest instance with the specified data type and actions. Forest is the root store that can create branches."})}),e.jsx(h,{size:"sm",mb:3,children:"Properties"}),e.jsxs(G,{spacing:3,children:[e.jsxs(g,{children:[e.jsx(Z,{children:"value: DataType"})," - Current forest value (readonly)"]}),e.jsxs(g,{children:[e.jsx(Z,{children:"name: string"})," - Forest identifier"]}),e.jsxs(g,{children:[e.jsx(Z,{children:"$: Actions"})," - Exposed ",e.jsx(B,{to:"/actions'",children:"action"})," methods."]}),e.jsxs(g,{children:[e.jsx(Z,{children:"acts: Actions"})," - Alias for $ property"]}),e.jsxs(g,{children:[e.jsx(Z,{children:"res: Map<string, any>"})," - container for external resources such as database connectors, DOM references. Changing res entries does not trigger any subscriber updates."]}),e.jsxs(g,{children:[e.jsx(Z,{children:"isActive: boolean"})," - Whether forest accepts updates; set to false when ",e.jsx("code",{children:"complete()"})," is called"]}),e.jsxs(g,{children:[e.jsx(Z,{children:"path: Path"})," - the path between this store and its parent; is empty array [] for root Forest"]}),e.jsxs(g,{children:[e.jsx(Z,{children:"parent?: StoreBranch"})," - null for root Forest"]}),e.jsxs(g,{children:[e.jsx(Z,{children:"isRoot: boolean"})," - Always true for Forest"]}),e.jsxs(g,{children:[e.jsx(Z,{children:"root: Forest"})," - Returns self (this)"]})]})]}),e.jsxs(d,{id:"forest-core",layerStyle:"methodCard",children:[e.jsx(h,{size:"md",mb:4,children:"Core Methods"}),e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsx(N,{title:"next(value: Partial<DataType>): void",snippetName:"nextExample",snippetFolder:"APIReference",codeTitle:"Updating Forest Values",children:"Updates the forest with a new value."}),e.jsx(N,{title:"subscribe(listener: Listener<DataType>): Subscription",snippetName:"subscribeExample",snippetFolder:"APIReference",codeTitle:"Subscribing to Changes",children:"Subscribes to forest changes. Returns RxJS Subscription for cleanup."}),e.jsx(N,{title:"get(path?: Path): any",snippetName:"getPathExample",snippetFolder:"APIReference",codeTitle:"Getting Values by Path",children:"Gets value at specified path. Returns entire value if no path provided."}),e.jsx(N,{title:"set(path: Path, value: unknown): boolean",snippetName:"setValueExample",snippetFolder:"APIReference",codeTitle:"Setting Values Example",children:"Sets value at specified path using Immer for immutable updates. Returns true if successful."}),e.jsx(N,{title:"complete(): DataType",children:"Completes the forest and all branches, preventing further updates. Returns final value. note - branch completions effect only that branch and any sub-branches it spawned; completing the root Forest will terminate the entire forest and all its branches and sub-branches."})]})]}),e.jsxs(d,{id:"forest-branching",layerStyle:"methodCard",children:[e.jsx(h,{size:"md",mb:4,children:"Branching Methods"}),e.jsx(x,{spacing:6,align:"stretch",children:e.jsx(N,{title:"branch<Type, Actions>(path: Path, params: BranchParams): ForestBranch",snippetName:"branchCreationExample",snippetFolder:"APIReference",codeTitle:"Branch Creation Example",children:"Creates a new branch at the specified path with its own actions and validation. This is the key feature that makes Forest powerful for managing nested state."})})]}),e.jsxs(d,{id:"forest-transactions",layerStyle:"methodCard",children:[e.jsx(h,{size:"md",mb:4,children:"Transaction Methods"}),e.jsx(x,{spacing:6,align:"stretch",children:e.jsxs(N,{title:"transact(params: TransParams | TransFn, suspendValidation?: boolean): void",snippetName:"transactMethodExamples",snippetFolder:"Transactions",codeTitle:"Transaction Examples",children:["Executes multiple operations as a single atomic transaction across the forest and all branches. All changes within the transaction are applied atomically. It is possible to nest transactions - in which case all subscriptions are suspended until the outermost transactions complete. Any thrown (uncaught) error suspends a transaction and reverts ",e.jsx("i",{children:"all"})," updates made since the beginning of that transaction; in the case of nested transaction, its possible to catch the inner transactions' error in which case the state will be the same as it was before the inner transaction started. ",e.jsx("b",{children:"action must NOT be a lambda/arrow function"}),"."]})})]}),e.jsxs(d,{id:"forest-validation",layerStyle:"methodCard",children:[e.jsx(h,{size:"md",mb:4,children:"Validation Methods"}),e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsx(N,{title:"validate(value: unknown): Validity",snippetName:"validateMethod",snippetFolder:"APIReference",codeTitle:"Validation Examples",children:"Validates a value against schema and tests. Returns validity object with detailed error information. If the current state of the store is under a transaction with suspendValidation, it will always return isValid: true. validate captures any thrown errors from validation functions into the feedback."}),e.jsx(N,{title:"test(value: unknown): Validity",snippetName:"testMethod",snippetFolder:"APIReference",codeTitle:"Test Function Examples",children:"Identical to validate -- however it ignores any transactional / suspendValidation conditions"})]})]}),e.jsxs(d,{id:"forestbranch",layerStyle:"methodCard",children:[e.jsxs($,{mb:4,children:[e.jsx(h,{size:"lg",children:"ForestBranch"}),e.jsx(S,{colorScheme:"purple",children:"Class"})]}),e.jsxs(l,{textStyle:"body",mb:6,children:["ForestBranch provides a focused interface for managing a specific part of a Forest's data. It inherits all Forest methods but operates on a specific path within the parent Forest, automatically synchronizing changes bidirectionally. You can create a transient branch to do a focused operation on a subset of the store or to observe specific subsets of the store hierarchy. It is the output of the",e.jsx("code",{children:"branch(path)"})," method of Forest or ForestBranch."]}),e.jsx(h,{size:"md",mb:4,children:"Key Properties"}),e.jsxs(G,{spacing:3,children:[e.jsxs(g,{children:[e.jsx(Z,{children:"path: Path"})," - Path from parent to this branch."]}),e.jsxs(g,{children:[e.jsx(Z,{children:"parent: Forest | ForestBranch"})," - Parent forest or branch that created this branch"]}),e.jsxs(g,{children:[e.jsx(Z,{children:"root: Forest"})," - Reference to the root Forest instance"]}),e.jsxs(g,{children:[e.jsx(Z,{children:"isRoot: boolean"})," - Always false for branches"]}),e.jsxs(g,{children:[e.jsx(Z,{children:"value: DataType"})," - Current value at this branch's path (computed from parent)"]}),e.jsxs(g,{children:[e.jsx(Z,{children:"$: Actions"})," - Branch-specific action methods that operate on this path"]})]}),e.jsx(l,{textStyle:"body",mt:4,children:"ForestBranch inherits all Forest methods (next, get, set, mutate, subscribe, etc.) but they operate on the branch's specific path within the parent Forest, not on independent state. also completing a branch completes it and its sub-items but not the parent / or upwwards stores, including the root."})]}),e.jsxs(d,{children:[e.jsxs($,{mb:4,children:[e.jsx(h,{size:"lg",children:"Type Definitions"}),e.jsx(S,{colorScheme:"orange",children:"Types"})]}),e.jsx(l,{textStyle:"body",children:"Key TypeScript interfaces and types used throughout Forestry 4."})]}),e.jsxs(d,{id:"types-config",layerStyle:"methodCard",children:[e.jsx(h,{size:"md",mb:4,children:"Constructor parameter structure"}),e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsxs(N,{title:"StoreParams<DataType, Actions>",children:["Configuration object for creating Forest instances. Contains:",e.jsxs("ul",{children:[e.jsxs("li",{children:["value ",e.jsx(S,{colorScheme:"red",children:"Required"})," "]}),e.jsx("li",{children:"actions"}),e.jsx("li",{children:"schema"}),e.jsx("li",{children:"tests"}),e.jsx("li",{children:"prep"}),e.jsx("li",{children:"name"})]})]}),e.jsxs(N,{title:"BranchParams<DataType, Actions>",children:["Identical to StoreParams except it has no value, and has a ",e.jsx("code",{children:"path"}),"parameter; branches' parameter is read from the root Forest instance via chained path between the branch and the root Forestry"]})]})]}),e.jsxs(d,{id:"types-actions",layerStyle:"methodCard",children:[e.jsx(h,{size:"md",mb:4,children:"Action Types"}),e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsx(N,{title:"ActionParamsFn<DataType, Args, Returned>",children:"Function signature for action definitions (with value parameter)."}),e.jsx(N,{title:"ActionExposedFn<Args, Returned>",children:"Function signature for exposed actions (without value parameter)."})]})]}),e.jsxs(d,{id:"types-validation",layerStyle:"methodCard",children:[e.jsx(h,{size:"md",mb:4,children:"Validation Types"}),e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsx(N,{title:"ValueTestFn<DataType>",children:"Function that tests a value and returns error message or null -- or throws."}),e.jsxs(N,{title:"Validity",children:["Object returned by test and isValid",e.jsxs("ul",{children:[e.jsx("li",{children:"isValid: boolean"}),e.jsx("li",{children:"error?: Error"})]})]}),e.jsx(N,{title:"ValidationResult",children:"String error message or null for valid values."})]})]}),e.jsxs(d,{id:"types-utility",layerStyle:"methodCard",children:[e.jsx(h,{size:"md",mb:4,children:"Utility Types"}),e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsxs(N,{title:"Path",children:["String (",e.jsx("code",{children:"user.id"}),") array (",e.jsx("code",{children:"['user', 'id']"}),") of strings representing object path."]}),e.jsxs(N,{title:"Listener<DataType>",children:["Function that receives store value changes. it can be either a simple one-property function or a structured"," ",e.jsx("a",{href:"https://rxjs.dev/api/index/interface/Observer",children:"Observer"}),"."]}),e.jsx(N,{title:"ResourceMap",children:"Map for storing external resources (DOM, WebGL, etc.)."})]})]}),e.jsxs(d,{children:[e.jsxs($,{mb:4,children:[e.jsx(h,{size:"lg",children:"Examples"}),e.jsx(S,{colorScheme:"teal",children:"Examples"})]}),e.jsx(l,{textStyle:"body",children:"Common usage patterns and examples for each API."}),e.jsxs($,{spacing:4,wrap:"wrap",mt:4,children:[e.jsx(B,{to:"/basic",children:e.jsxs(S,{colorScheme:"blue",p:2,children:[e.jsx(Ce,{mr:2}),"Store Basics"]})}),e.jsx(B,{to:"/react",children:e.jsxs(S,{colorScheme:"green",p:2,children:[e.jsx(Ce,{mr:2}),"React Integration"]})}),e.jsx(B,{to:"integration",children:e.jsxs(S,{colorScheme:"purple",p:2,children:[e.jsx(Ce,{mr:2}),"Validation System"]})})]})]})]})})})]})}),bl=()=>{const t=[{title:"Todo App",path:"/examples/todo-app",badge:"Complete Example",badgeColor:"green",icon:z,description:"A fully-featured todo application demonstrating action-based architecture, form handling, and React integration patterns.",features:["Action-Based Architecture","Computed Values as Actions","Tactical Form Handling","useForestryLocal Integration"]},{title:"Shopping Cart",path:"/examples/shopping-cart",badge:"Validation Focus",badgeColor:"purple",icon:Ae,description:"A shopping cart application showcasing Forestry 4's validation system, schema integration, and complex business logic.",features:["Zod Schema Validation","Custom Test Functions","Real-time Validation","Complex State Management"]},{title:"Form Validation",path:"/examples/form-validation",badge:"Form Patterns",badgeColor:"blue",icon:vr,description:"Advanced form validation with field-level validation, cross-field dependencies, and async validation patterns.",features:["Field-Level Validation","Cross-Field Dependencies","Async Validation","Error State Management"]},{title:"Transaction Demo",path:"/examples/transaction-demo",badge:"Advanced Pattern",badgeColor:"orange",icon:Sr,description:"Comprehensive transaction system example demonstrating atomic operations, rollback capabilities, and complex state management.",features:["Atomic Operations","Automatic Rollback","Nested Transactions","Performance Optimization"]}];return e.jsx(oe,{maxW:"container.xl",py:8,children:e.jsxs(x,{spacing:8,align:"stretch",children:[e.jsxs(d,{textAlign:"center",children:[e.jsx(h,{size:"xl",mb:4,children:"Practical Examples"}),e.jsx(l,{fontSize:"lg",color:"gray.600",maxW:"2xl",mx:"auto",children:"Real-world examples demonstrating Forestry 4's capabilities in various scenarios. Each example showcases different aspects of the library with complete, working code."})]}),e.jsx(Y,{columns:{base:1,md:2},spacing:6,children:t.map(n=>e.jsx(hn,{as:B,to:n.path,_hover:{transform:"translateY(-2px)",shadow:"lg",textDecoration:"none"},transition:"all 0.2s",cursor:"pointer",children:e.jsx(mn,{children:e.jsxs(x,{align:"stretch",spacing:4,children:[e.jsxs($,{justify:"space-between",align:"start",children:[e.jsxs($,{children:[e.jsx(Fe,{as:n.icon,color:"forest.500",boxSize:5}),e.jsx(h,{size:"md",children:n.title})]}),e.jsx(S,{colorScheme:n.badgeColor,variant:"subtle",children:n.badge})]}),e.jsx(l,{color:"gray.600",fontSize:"sm",children:n.description}),e.jsxs(d,{children:[e.jsx(l,{fontSize:"sm",fontWeight:"semibold",mb:2,color:"gray.700",children:"Key Features:"}),e.jsx(x,{align:"stretch",spacing:1,children:n.features.map(r=>e.jsxs($,{spacing:2,children:[e.jsx(z,{color:"green.500",boxSize:3}),e.jsx(l,{fontSize:"sm",color:"gray.600",children:r})]},r))})]}),e.jsx(de,{as:"span",color:"forest.600",fontWeight:"semibold",fontSize:"sm",_hover:{color:"forest.700"},children:"View Example →"})]})})},n.path))}),e.jsx(d,{textAlign:"center",mt:8,children:e.jsx(l,{color:"gray.500",fontSize:"sm",children:"More examples coming soon! Each example includes live demos, complete source code, and detailed explanations of the patterns used."})})]})})},yl=()=>e.jsx(oe,{maxW:"container.xl",py:8,children:e.jsxs(x,{layerStyle:"section",spacing:8,children:[e.jsxs(d,{textAlign:"center",children:[e.jsxs(Heading,{size:"xl",mb:4,children:["Todo App Example",e.jsx(Badge,{ml:3,colorScheme:"green",children:"Complete Example"})]}),e.jsx(Text,{fontSize:"lg",color:"gray.600",maxW:"2xl",children:"A fully-featured todo application demonstrating Forestry 4's action-based architecture, form handling, filtering, and React integration patterns."})]}),e.jsxs(d,{layerStyle:"methodCard",w:"full",children:[e.jsx(Heading,{size:"md",mb:4,children:"Key Features Demonstrated"}),e.jsxs(G,{spacing:2,children:[e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Action-Based Architecture:"})," All logic encapsulated in store actions"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Computed Values as Actions:"})," filteredTodos(), completedCount(), activeCount()"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Tactical Form Handling:"})," onChange action using event.target.name"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Event Handler Actions:"})," All onClick/onChange handlers are store methods"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"useForestryLocal Integration:"})," Clean hook-based state management"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Validation:"})," Built-in tests for input validation"]})]})]}),e.jsxs(d,{layerStyle:"methodCard",w:"full",children:[e.jsx(Heading,{size:"md",mb:4,children:"Live Demo"}),e.jsx(Text,{mb:4,color:"gray.600",children:"Try the todo app below. Notice how all interactions are handled through store actions, and the component is purely presentational."}),e.jsx(Mn,{})]}),e.jsxs(d,{layerStyle:"methodCard",w:"full",children:[e.jsx(Heading,{size:"md",mb:4,children:"Architecture Highlights"}),e.jsxs(ne,{status:"info",mb:4,children:[e.jsx(re,{}),"This example demonstrates the ultimate Forestry pattern where the React component is purely declarative JSX with zero business logic."]}),e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsxs(d,{children:[e.jsx(Heading,{size:"sm",mb:2,children:"Pure Component Pattern"}),e.jsx(Text,{fontSize:"sm",color:"gray.600",children:"The React component contains no business logic, state management, or event handling code. Everything is delegated to store actions."})]}),e.jsxs(d,{children:[e.jsx(Heading,{size:"sm",mb:2,children:"Action Categories"}),e.jsxs(G,{spacing:1,fontSize:"sm",children:[e.jsxs(g,{children:[e.jsx("strong",{children:"Data Actions:"})," addTodo, toggleTodo, removeTodo, setFilter, clearCompleted"]}),e.jsxs(g,{children:[e.jsx("strong",{children:"UI Actions:"})," setFilterAll, setFilterActive, setFilterCompleted, handleKeyPress"]}),e.jsxs(g,{children:[e.jsx("strong",{children:"Selector Actions:"})," filteredTodos, completedCount, activeCount, isAddDisabled"]}),e.jsxs(g,{children:[e.jsx("strong",{children:"Factory Actions:"})," createToggleTodo, createRemoveTodo (for parameterized handlers)"]})]})]}),e.jsxs(d,{children:[e.jsx(Heading,{size:"sm",mb:2,children:"Inline Function Calls"}),e.jsx(Text,{fontSize:"sm",color:"gray.600",children:"All computed values and event handlers use direct action references without arrow functions, resulting in cleaner JSX and better performance."})]})]})]}),e.jsxs(d,{layerStyle:"methodCard",w:"full",children:[e.jsx(Heading,{size:"md",mb:4,children:"Store Structure"}),e.jsx(K,{language:"typescript",title:"Store Factory Pattern",children:`const createTodoStore = () => {
  return new Forest<TodoState>({
    name: 'todo-app',
    value: {
      todos: initialTodos,
      filter: 'all',
      newTodoText: '',
    },
    actions: {
      // Selector actions (computed values)
      filteredTodos: function (value: TodoState): TodoItem[] {
        switch (value.filter) {
          case 'active': return value.todos.filter(todo => !todo.completed);
          case 'completed': return value.todos.filter(todo => todo.completed);
          default: return value.todos;
        }
      },
      
      completedCount: function (value: TodoState): number {
        return value.todos.filter(todo => todo.completed).length;
      },
      
      // UI event actions
      setFilterAll: function (value: TodoState) {
        this.$.setFilter('all');
      },
      
      // Data manipulation actions
      addTodo: function (value: TodoState) {
        if (!value.newTodoText.trim()) return;
        const newTodo = {
          id: Date.now(),
          text: value.newTodoText.trim(),
          completed: false,
        };
        this.mutate((draft) => {
          draft.todos.push(newTodo);
          draft.newTodoText = '';
        });
      },
      
      // ... more actions
    },
    tests: [
      (value: TodoState) => value.newTodoText.length > 100 ? 'Todo text too long' : null,
    ]
  });
};`})]}),e.jsxs(d,{layerStyle:"methodCard",w:"full",children:[e.jsx(Heading,{size:"md",mb:4,children:"Component Usage"}),e.jsx(K,{language:"typescript",title:"Pure React Component",children:`const TodoAppDemo: React.FC = () => {
  const [todoValue, todoStore] = useForestryLocal<TodoState>(createTodoStore);

  if (!todoValue) {
    return <Text>Loading...</Text>;
  }

  return (
    <SimpleGrid columns={{ base: 1, lg: 2 }} spacing={6}>
      <VStack spacing={4} align="stretch">
        <Input
          name="newTodoText"
          value={todoValue.newTodoText}
          onChange={todoStore.$.onChange}
          onKeyPress={todoStore.$.handleKeyPress}
        />
        <Button
          onClick={todoStore.$.addTodo}
          isDisabled={todoStore.$.isAddDisabled()}
        >
          Add
        </Button>
        
        <Button onClick={todoStore.$.setFilterAll}>
          All ({todoValue.todos.length})
        </Button>
        <Button onClick={todoStore.$.setFilterActive}>
          Active ({todoStore.$.activeCount()})
        </Button>
        
        {todoStore.$.filteredTodos().map((todo) => (
          <HStack key={todo.id}>
            <Checkbox
              isChecked={todo.completed}
              onChange={todoStore.$.createToggleTodo(todo.id)}
            />
            <Text>{todo.text}</Text>
            <Button onClick={todoStore.$.createRemoveTodo(todo.id)}>
              ×
            </Button>
          </HStack>
        ))}
      </VStack>
    </SimpleGrid>
  );
};`})]}),e.jsxs(d,{layerStyle:"methodCard",w:"full",children:[e.jsx(Heading,{size:"md",mb:4,children:"Best Practices Demonstrated"}),e.jsxs(G,{spacing:3,children:[e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Store Factory Pattern:"})," Use factory functions with useForestryLocal for clean component integration"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Action-Based Selectors:"})," Computed values as actions rather than React useMemo"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Tactical Form Handling:"})," Single onChange action using event.target.name pattern"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Direct Action References:"})," Avoid arrow functions in JSX for better performance"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Minimal State:"})," Store only essential data, compute derived values on-demand"]})]})]})]})}),vl=()=>e.jsx(oe,{maxW:"container.xl",py:8,children:e.jsxs(x,{layerStyle:"section",spacing:8,children:[e.jsxs(d,{textAlign:"center",children:[e.jsxs(h,{size:"xl",mb:4,children:["Shopping Cart Example",e.jsx(S,{ml:3,colorScheme:"purple",children:"Validation Focus"})]}),e.jsx(l,{fontSize:"lg",color:"gray.600",maxW:"2xl",children:"A shopping cart application demonstrating Forestry 4's validation system, schema integration, and complex business logic handling."})]}),e.jsxs(d,{layerStyle:"methodCard",w:"full",children:[e.jsx(h,{size:"md",mb:4,children:"Key Features Demonstrated"}),e.jsxs(G,{spacing:2,children:[e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Zod Schema Validation:"})," Type-safe validation with detailed error messages"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Custom Test Functions:"})," Business logic validation (inventory, pricing)"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Real-time Validation:"})," Immediate feedback on user interactions"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Complex State Management:"})," Cart items, totals, discounts, shipping"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Error Handling:"})," Graceful handling of validation failures"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Transaction Safety:"})," Atomic operations for cart modifications"]})]})]}),e.jsxs(d,{layerStyle:"methodCard",w:"full",children:[e.jsx(h,{size:"md",mb:4,children:"Live Demo"}),e.jsx(l,{mb:4,color:"gray.600",children:"Try adding items to the cart, modifying quantities, and applying discounts. Notice how validation provides immediate feedback and prevents invalid states."}),e.jsx(Bn,{})]}),e.jsxs(d,{layerStyle:"methodCard",w:"full",children:[e.jsx(h,{size:"md",mb:4,children:"Validation Strategy"}),e.jsxs(ne,{status:"info",mb:4,children:[e.jsx(re,{}),"This example demonstrates layered validation: schema validation for data types and custom tests for business rules."]}),e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsxs(d,{children:[e.jsx(h,{size:"sm",mb:2,children:"Schema Validation (Zod)"}),e.jsx(l,{fontSize:"sm",color:"gray.600",children:"Ensures data types, required fields, and basic constraints are met. Provides detailed error messages for each field."})]}),e.jsxs(d,{children:[e.jsx(h,{size:"sm",mb:2,children:"Business Logic Tests"}),e.jsx(l,{fontSize:"sm",color:"gray.600",children:"Custom validation functions that check inventory availability, pricing rules, discount eligibility, and shipping constraints."})]}),e.jsxs(d,{children:[e.jsx(h,{size:"sm",mb:2,children:"Real-time Feedback"}),e.jsx(l,{fontSize:"sm",color:"gray.600",children:"Validation runs on every state change, providing immediate feedback without waiting for form submission."})]})]})]}),e.jsxs(d,{layerStyle:"methodCard",w:"full",children:[e.jsx(h,{size:"md",mb:4,children:"Schema & Validation"}),e.jsx(K,{language:"typescript",title:"Zod Schema Definition",children:`import { z } from 'zod';

const CartItemSchema = z.object({
  id: z.string().min(1, 'Product ID is required'),
  name: z.string().min(1, 'Product name is required'),
  price: z.number().positive('Price must be positive'),
  quantity: z.number().int().positive('Quantity must be a positive integer'),
  category: z.enum(['electronics', 'clothing', 'books', 'home']),
});

const ShoppingCartSchema = z.object({
  items: z.array(CartItemSchema),
  subtotal: z.number().nonnegative('Subtotal cannot be negative'),
  tax: z.number().nonnegative('Tax cannot be negative'),
  shipping: z.number().nonnegative('Shipping cannot be negative'),
  discount: z.number().nonnegative('Discount cannot be negative'),
  total: z.number().nonnegative('Total cannot be negative'),
  couponCode: z.string().optional(),
});

// Custom business logic tests
const cartTests = [
  (cart: CartState) => {
    // Check inventory availability
    const outOfStock = cart.items.find(item => 
      getInventory(item.id) < item.quantity
    );
    if (outOfStock) {
      return \`\${outOfStock.name} is out of stock\`;
    }
    return null;
  },
  
  (cart: CartState) => {
    // Validate discount eligibility
    if (cart.discount > 0 && cart.subtotal < 50) {
      return 'Minimum order of $50 required for discounts';
    }
    return null;
  },
  
  (cart: CartState) => {
    // Check maximum cart size
    if (cart.items.length > 20) {
      return 'Maximum 20 items allowed in cart';
    }
    return null;
  }
];`})]}),e.jsxs(d,{layerStyle:"methodCard",w:"full",children:[e.jsx(h,{size:"md",mb:4,children:"Store Actions"}),e.jsx(K,{language:"typescript",title:"Cart Management Actions",children:`const createShoppingCartStore = () => new Forest<CartState>({
  name: 'shopping-cart',
  value: initialCartState,
  schema: ShoppingCartSchema,
  tests: cartTests,
  
  actions: {
    // Add item with validation
    addItem: function(value: CartState, product: Product) {
      const existingItem = value.items.find(item => item.id === product.id);
      
      if (existingItem) {
        this.$.updateQuantity(product.id, existingItem.quantity + 1);
      } else {
        const newItem: CartItem = {
          id: product.id,
          name: product.name,
          price: product.price,
          quantity: 1,
          category: product.category,
        };
        
        this.mutate(draft => {
          draft.items.push(newItem);
        });
        this.$.recalculateTotal();
      }
    },
    
    // Update quantity with validation
    updateQuantity: function(value: CartState, productId: string, quantity: number) {
      if (quantity <= 0) {
        this.$.removeItem(productId);
        return;
      }
      
      this.mutate(draft => {
        const item = draft.items.find(item => item.id === productId);
        if (item) {
          item.quantity = quantity;
        }
      });
      this.$.recalculateTotal();
    },
    
    // Apply coupon with validation
    applyCoupon: function(value: CartState, couponCode: string) {
      const coupon = validateCoupon(couponCode, value.subtotal);
      if (!coupon.valid) {
        throw new Error(coupon.error);
      }
      
      this.mutate(draft => {
        draft.couponCode = couponCode;
        draft.discount = coupon.discount;
      });
      this.$.recalculateTotal();
    },
    
    // Recalculate totals
    recalculateTotal: function(value: CartState) {
      const subtotal = value.items.reduce((sum, item) => 
        sum + (item.price * item.quantity), 0
      );
      
      const tax = subtotal * 0.08; // 8% tax
      const shipping = subtotal > 100 ? 0 : 9.99; // Free shipping over $100
      const total = subtotal + tax + shipping - value.discount;
      
      this.mutate(draft => {
        draft.subtotal = subtotal;
        draft.tax = tax;
        draft.shipping = shipping;
        draft.total = Math.max(0, total);
      });
    },
    
    // Checkout with transaction
    checkout: function(value: CartState) {
      return this.transact({
        suspendValidation: false, // Keep validation active
        action() {
          // Validate final state
          const validation = this.validate(this.value);
          if (!validation.isValid) {
            throw new Error(\`Checkout failed: \${validation.error}\`);
          }
          
          // Process payment, update inventory, etc.
          this.$.processPayment();
          this.$.updateInventory();
          this.$.clearCart();
        }
      });
    }
  }
});`})]}),e.jsxs(d,{layerStyle:"methodCard",w:"full",children:[e.jsx(h,{size:"md",mb:4,children:"Validation Best Practices"}),e.jsxs(G,{spacing:3,children:[e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Layered Validation:"})," Use schema for data types, tests for business logic"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Immediate Feedback:"})," Validate on every state change for better UX"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Detailed Error Messages:"})," Provide specific, actionable error information"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Transaction Safety:"})," Use transactions for multi-step operations"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Graceful Degradation:"})," Handle validation failures without breaking the UI"]})]})]})]})}),Sl=()=>e.jsx(oe,{maxW:"container.xl",py:8,children:e.jsxs(x,{layerStyle:"section",spacing:8,children:[e.jsxs(d,{textAlign:"center",children:[e.jsxs(h,{size:"xl",mb:4,children:["Advanced Form Validation",e.jsx(S,{ml:3,colorScheme:"blue",children:"Form Patterns"})]}),e.jsx(l,{fontSize:"lg",color:"gray.600",maxW:"2xl",children:"A comprehensive form validation example demonstrating field-level validation, cross-field dependencies, async validation, and error handling patterns."})]}),e.jsxs(d,{layerStyle:"methodCard",w:"full",children:[e.jsx(h,{size:"md",mb:4,children:"Key Features Demonstrated"}),e.jsxs(G,{spacing:2,children:[e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Field-Level Validation:"})," Individual field validation with specific error messages"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Cross-Field Dependencies:"})," Password confirmation, conditional required fields"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Async Validation:"})," Username availability, email verification"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Dynamic Validation Rules:"})," Rules that change based on other field values"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Error State Management:"})," Field-specific error display and clearing"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Form Submission Flow:"})," Validation before submission with loading states"]})]})]}),e.jsxs(d,{layerStyle:"methodCard",w:"full",children:[e.jsx(h,{size:"md",mb:4,children:"Live Demo"}),e.jsx(l,{mb:4,color:"gray.600",children:"Try filling out the form below. Notice how validation provides immediate feedback, handles async operations, and manages complex field dependencies."}),e.jsx(Wn,{})]}),e.jsxs(d,{layerStyle:"methodCard",w:"full",children:[e.jsx(h,{size:"md",mb:4,children:"Validation Architecture"}),e.jsxs(ne,{status:"info",mb:4,children:[e.jsx(re,{}),"This example demonstrates a multi-layered validation approach with field-level, form-level, and async validation patterns."]}),e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsxs(d,{children:[e.jsx(h,{size:"sm",mb:2,children:"Field-Level Validation"}),e.jsx(l,{fontSize:"sm",color:"gray.600",children:"Each field has its own validation rules that run immediately on change, providing instant feedback to users."})]}),e.jsxs(d,{children:[e.jsx(h,{size:"sm",mb:2,children:"Cross-Field Dependencies"}),e.jsx(l,{fontSize:"sm",color:"gray.600",children:"Some fields depend on others (password confirmation, conditional requirements) and are validated whenever dependent fields change."})]}),e.jsxs(d,{children:[e.jsx(h,{size:"sm",mb:2,children:"Async Validation"}),e.jsx(l,{fontSize:"sm",color:"gray.600",children:"Username and email fields perform server-side validation to check availability and validity, with proper loading states and error handling."})]}),e.jsxs(d,{children:[e.jsx(h,{size:"sm",mb:2,children:"Form-Level Validation"}),e.jsx(l,{fontSize:"sm",color:"gray.600",children:"Overall form validation ensures all fields are valid before allowing submission, with comprehensive error reporting."})]})]})]}),e.jsxs(d,{layerStyle:"methodCard",w:"full",children:[e.jsx(h,{size:"md",mb:4,children:"Validation Schema"}),e.jsx(K,{language:"typescript",title:"Form Schema with Complex Rules",children:`import { z } from 'zod';

const UserRegistrationSchema = z.object({
  username: z.string()
    .min(3, 'Username must be at least 3 characters')
    .max(20, 'Username must be less than 20 characters')
    .regex(/^[a-zA-Z0-9_]+$/, 'Username can only contain letters, numbers, and underscores'),
    
  email: z.string()
    .email('Please enter a valid email address')
    .min(1, 'Email is required'),
    
  password: z.string()
    .min(8, 'Password must be at least 8 characters')
    .regex(/^(?=.*[a-z])(?=.*[A-Z])(?=.*d)/, 'Password must contain uppercase, lowercase, and number'),
    
  confirmPassword: z.string()
    .min(1, 'Please confirm your password'),
    
  firstName: z.string()
    .min(1, 'First name is required')
    .max(50, 'First name must be less than 50 characters'),
    
  lastName: z.string()
    .min(1, 'Last name is required')
    .max(50, 'Last name must be less than 50 characters'),
    
  age: z.number()
    .int('Age must be a whole number')
    .min(13, 'Must be at least 13 years old')
    .max(120, 'Please enter a valid age'),
    
  agreeToTerms: z.boolean()
    .refine(val => val === true, 'You must agree to the terms and conditions'),
    
  newsletter: z.boolean().optional(),
  
  // Conditional field - required if newsletter is true
  interests: z.array(z.string()).optional(),
}).refine(
  (data) => data.password === data.confirmPassword,
  {
    message: "Passwords don't match",
    path: ["confirmPassword"],
  }
).refine(
  (data) => !data.newsletter || (data.interests && data.interests.length > 0),
  {
    message: "Please select at least one interest for newsletter",
    path: ["interests"],
  }
);

// Custom async validation tests
const formTests = [
  // Async username availability check
  async (form: FormState) => {
    if (form.username && form.username.length >= 3) {
      const isAvailable = await checkUsernameAvailability(form.username);
      if (!isAvailable) {
        return 'Username is already taken';
      }
    }
    return null;
  },
  
  // Async email verification
  async (form: FormState) => {
    if (form.email && form.email.includes('@')) {
      const isValid = await verifyEmailDomain(form.email);
      if (!isValid) {
        return 'Email domain is not supported';
      }
    }
    return null;
  },
  
  // Business logic validation
  (form: FormState) => {
    if (form.age && form.age < 18 && form.newsletter) {
      return 'Users under 18 cannot subscribe to newsletter';
    }
    return null;
  }
];`})]}),e.jsxs(d,{layerStyle:"methodCard",w:"full",children:[e.jsx(h,{size:"md",mb:4,children:"Store Implementation"}),e.jsx(K,{language:"typescript",title:"Form Store with Advanced Validation",children:`const createFormStore = () => new Forest<FormState>({
  name: 'registration-form',
  value: initialFormState,
  schema: UserRegistrationSchema,
  tests: formTests,
  
  actions: {
    // Field-specific validation
    validateField: async function(value: FormState, fieldName: keyof FormState) {
      try {
        // Validate single field using schema
        const fieldSchema = UserRegistrationSchema.shape[fieldName];
        if (fieldSchema) {
          fieldSchema.parse(value[fieldName]);
        }
        
        // Run relevant async tests
        const relevantTests = formTests.filter(test => 
          test.toString().includes(fieldName)
        );
        
        for (const test of relevantTests) {
          const error = await test(value);
          if (error) {
            this.$.setFieldError(fieldName, error);
            return;
          }
        }
        
        // Clear error if validation passes
        this.$.clearFieldError(fieldName);
      } catch (error) {
        if (error instanceof z.ZodError) {
          const fieldError = error.errors.find(e => 
            e.path.includes(fieldName)
          );
          if (fieldError) {
            this.$.setFieldError(fieldName, fieldError.message);
          }
        }
      }
    },
    
    // Update field with validation
    updateField: function(value: FormState, fieldName: keyof FormState, fieldValue: any) {
      this.set(fieldName, fieldValue);
      
      // Trigger validation for this field and dependent fields
      this.$.validateField(fieldName);
      
      // Handle cross-field dependencies
      if (fieldName === 'password') {
        this.$.validateField('confirmPassword');
      }
      if (fieldName === 'newsletter') {
        this.$.validateField('interests');
      }
    },
    
    // Set field error
    setFieldError: function(value: FormState, fieldName: string, error: string) {
      this.mutate(draft => {
        if (!draft.errors) draft.errors = {};
        draft.errors[fieldName] = error;
      });
    },
    
    // Clear field error
    clearFieldError: function(value: FormState, fieldName: string) {
      this.mutate(draft => {
        if (draft.errors) {
          delete draft.errors[fieldName];
        }
      });
    },
    
    // Form submission with full validation
    submitForm: async function(value: FormState) {
      this.set('isSubmitting', true);
      
      try {
        // Run full validation
        const validation = await this.validate(value);
        if (!validation.isValid) {
          throw new Error(\`Form validation failed: \${validation.error}\`);
        }
        
        // Submit to server
        const result = await submitRegistration(value);
        
        this.set('isSubmitted', true);
        this.set('submitMessage', 'Registration successful!');
        
        return result;
      } catch (error) {
        this.set('submitError', error.message);
        throw error;
      } finally {
        this.set('isSubmitting', false);
      }
    },
    
    // Check if form is valid
    isFormValid: function(value: FormState): boolean {
      const hasErrors = value.errors && Object.keys(value.errors).length > 0;
      const hasRequiredFields = value.username && value.email && 
                               value.password && value.firstName && 
                               value.lastName && value.agreeToTerms;
      return !hasErrors && !!hasRequiredFields;
    }
  }
});`})]}),e.jsxs(d,{layerStyle:"methodCard",w:"full",children:[e.jsx(h,{size:"md",mb:4,children:"Form Validation Best Practices"}),e.jsxs(G,{spacing:3,children:[e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Immediate Feedback:"})," Validate fields as users type for better UX"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Progressive Enhancement:"})," Start with basic validation, add async checks"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Clear Error Messages:"})," Provide specific, actionable error information"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Loading States:"})," Show progress during async validation and submission"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Accessibility:"})," Proper ARIA labels and error associations"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Error Recovery:"})," Allow users to easily correct and retry"]})]})]})]})}),wl=()=>e.jsx(oe,{maxW:"container.xl",py:8,children:e.jsxs(x,{layerStyle:"section",spacing:8,children:[e.jsxs(d,{textAlign:"center",children:[e.jsxs(h,{size:"xl",mb:4,children:["Transaction System Example",e.jsx(S,{ml:3,colorScheme:"orange",children:"Advanced Pattern"})]}),e.jsx(l,{fontSize:"lg",color:"gray.600",maxW:"2xl",children:"A comprehensive example demonstrating Forestry 4's transaction system for atomic operations, rollback capabilities, and complex state management scenarios."})]}),e.jsxs(d,{layerStyle:"methodCard",w:"full",children:[e.jsx(h,{size:"md",mb:4,children:"Key Features Demonstrated"}),e.jsxs(G,{spacing:2,children:[e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Atomic Operations:"})," Multi-step operations that succeed or fail as a unit"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Automatic Rollback:"})," State restoration when transactions fail"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Validation Control:"})," Suspend/resume validation during transactions"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Nested Transactions:"})," Complex operations with multiple transaction levels"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Error Handling:"})," Graceful failure handling with detailed error information"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Performance Optimization:"})," Batch operations for better performance"]})]})]}),e.jsxs(d,{layerStyle:"methodCard",w:"full",children:[e.jsx(h,{size:"md",mb:4,children:"Transaction Concepts"}),e.jsxs(ne,{status:"info",mb:4,children:[e.jsx(re,{}),"Transactions ensure data consistency by treating multiple operations as a single, atomic unit that either completes entirely or rolls back completely."]}),e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsxs(d,{children:[e.jsx(h,{size:"sm",mb:2,children:"Atomicity"}),e.jsx(l,{fontSize:"sm",color:"gray.600",children:"All operations within a transaction succeed together or fail together. No partial updates are left in an inconsistent state."})]}),e.jsxs(d,{children:[e.jsx(h,{size:"sm",mb:2,children:"Rollback Safety"}),e.jsx(l,{fontSize:"sm",color:"gray.600",children:"If any operation fails, the entire transaction is rolled back to the original state before the transaction began."})]}),e.jsxs(d,{children:[e.jsx(h,{size:"sm",mb:2,children:"Validation Control"}),e.jsx(l,{fontSize:"sm",color:"gray.600",children:"Validation can be suspended during transactions to allow intermediate invalid states, then resumed for final validation."})]}),e.jsxs(d,{children:[e.jsx(h,{size:"sm",mb:2,children:"Performance Benefits"}),e.jsx(l,{fontSize:"sm",color:"gray.600",children:"Batch multiple operations together to reduce validation overhead and improve performance for complex state changes."})]})]})]}),e.jsxs(d,{layerStyle:"methodCard",w:"full",children:[e.jsx(h,{size:"md",mb:4,children:"Basic Transaction Pattern"}),e.jsx(K,{language:"typescript",title:"Simple Transaction Example",children:`// Basic transaction for atomic operations
const transferFunds = function(value: BankState, fromAccount: string, toAccount: string, amount: number) {
  return this.transact({
    suspendValidation: true, // Allow intermediate invalid states
    action() {
      // Step 1: Withdraw from source account
      const fromBalance = this.value.accounts[fromAccount];
      if (fromBalance < amount) {
        throw new Error('Insufficient funds');
      }
      this.set(\`accounts.\${fromAccount}\`, fromBalance - amount);
      
      // Step 2: Deposit to destination account
      const toBalance = this.value.accounts[toAccount];
      this.set(\`accounts.\${toAccount}\`, toBalance + amount);
      
      // Step 3: Record transaction
      this.mutate(draft => {
        draft.transactions.push({
          id: Date.now(),
          from: fromAccount,
          to: toAccount,
          amount,
          timestamp: new Date(),
        });
      });
      
      // Final validation will run here automatically
      // If validation fails, entire transaction rolls back
    }
  });
};`})]}),e.jsxs(d,{layerStyle:"methodCard",w:"full",children:[e.jsx(h,{size:"md",mb:4,children:"Complex Transaction Example"}),e.jsx(te,{snippetName:"transaction-examples.ts",language:"typescript",title:"Advanced Transaction Patterns"})]}),e.jsxs(d,{layerStyle:"methodCard",w:"full",children:[e.jsx(h,{size:"md",mb:4,children:"Nested Transactions"}),e.jsx(K,{language:"typescript",title:"Nested Transaction Pattern",children:`// Nested transactions for complex operations
const processOrder = function(value: OrderState, order: Order) {
  return this.transact({
    suspendValidation: false, // Keep validation active
    action() {
      // Outer transaction: Process entire order
      
      // Step 1: Validate inventory (inner transaction)
      this.transact({
        suspendValidation: true,
        action() {
          for (const item of order.items) {
            const inventory = this.value.inventory[item.productId];
            if (inventory < item.quantity) {
              throw new Error(\`Insufficient inventory for \${item.name}\`);
            }
            // Reserve inventory
            this.set(\`inventory.\${item.productId}\`, inventory - item.quantity);
          }
        }
      });
      
      // Step 2: Process payment (inner transaction)
      this.transact({
        suspendValidation: true,
        action() {
          const paymentResult = this.$.processPayment(order.payment);
          if (!paymentResult.success) {
            throw new Error(\`Payment failed: \${paymentResult.error}\`);
          }
          this.set('paymentStatus', 'completed');
        }
      });
      
      // Step 3: Update order status
      this.mutate(draft => {
        draft.orders[order.id] = {
          ...order,
          status: 'confirmed',
          processedAt: new Date(),
        };
      });
      
      // Step 4: Send confirmation
      this.$.sendOrderConfirmation(order.id);
    }
  });
};`})]}),e.jsxs(d,{layerStyle:"methodCard",w:"full",children:[e.jsx(h,{size:"md",mb:4,children:"Error Handling & Recovery"}),e.jsx(K,{language:"typescript",title:"Transaction Error Handling",children:`// Comprehensive error handling in transactions
const safeDataMigration = function(value: DataState, migrationPlan: MigrationPlan) {
  return this.transact({
    suspendValidation: true,
    action() {
      try {
        // Create backup before migration
        const backup = JSON.parse(JSON.stringify(this.value));
        this.set('_backup', backup);
        
        // Step 1: Validate migration plan
        const validation = validateMigrationPlan(migrationPlan);
        if (!validation.isValid) {
          throw new Error(\`Invalid migration plan: \${validation.errors.join(', ')}\`);
        }
        
        // Step 2: Apply schema changes
        for (const change of migrationPlan.schemaChanges) {
          this.$.applySchemaChange(change);
        }
        
        // Step 3: Migrate data
        for (const transformation of migrationPlan.dataTransformations) {
          this.$.applyDataTransformation(transformation);
        }
        
        // Step 4: Validate final state
        const finalValidation = this.validate(this.value);
        if (!finalValidation.isValid) {
          throw new Error(\`Migration resulted in invalid state: \${finalValidation.error}\`);
        }
        
        // Success - remove backup
        this.set('_backup', null);
        this.set('migrationStatus', 'completed');
        
      } catch (error) {
        // Transaction will automatically rollback
        // Log error for debugging
        console.error('Migration failed:', error);
        
        // Set error state (this will be rolled back too if we throw)
        this.set('migrationError', error.message);
        
        // Re-throw to trigger rollback
        throw error;
      }
    }
  }).catch(error => {
    // Handle post-rollback cleanup
    this.set('migrationStatus', 'failed');
    this.set('lastError', error.message);
    
    // Optionally restore from backup
    if (this.value._backup) {
      this.$.restoreFromBackup();
    }
    
    throw error; // Re-throw for caller
  });
};`})]}),e.jsxs(d,{layerStyle:"methodCard",w:"full",children:[e.jsx(h,{size:"md",mb:4,children:"Performance Optimization"}),e.jsx(K,{language:"typescript",title:"Batch Operations with Transactions",children:`// Batch operations for better performance
const batchUpdateUsers = function(value: UserState, updates: UserUpdate[]) {
  return this.transact({
    suspendValidation: true, // Skip validation for each individual update
    action() {
      // Process all updates in a single transaction
      for (const update of updates) {
        const user = this.value.users[update.userId];
        if (!user) {
          throw new Error(\`User \${update.userId} not found\`);
        }
        
        // Apply update
        this.mutate(draft => {
          Object.assign(draft.users[update.userId], update.changes);
        });
      }
      
      // Update metadata
      this.mutate(draft => {
        draft.lastBatchUpdate = new Date();
        draft.batchUpdateCount = (draft.batchUpdateCount || 0) + 1;
      });
      
      // Validation runs once at the end for all changes
    }
  });
};

// Bulk data import with progress tracking
const importData = function(value: ImportState, data: ImportData[]) {
  return this.transact({
    suspendValidation: true,
    action() {
      const total = data.length;
      let processed = 0;
      
      for (const item of data) {
        try {
          // Process individual item
          this.$.processImportItem(item);
          processed++;
          
          // Update progress (but don't trigger validation yet)
          this.set('importProgress', {
            processed,
            total,
            percentage: Math.round((processed / total) * 100)
          });
          
        } catch (error) {
          // Add to error list but continue processing
          this.mutate(draft => {
            if (!draft.importErrors) draft.importErrors = [];
            draft.importErrors.push({
              item: item.id,
              error: error.message
            });
          });
        }
      }
      
      // Final validation and cleanup
      this.set('importStatus', 'completed');
      this.set('importCompletedAt', new Date());
    }
  });
};`})]}),e.jsxs(d,{layerStyle:"methodCard",w:"full",children:[e.jsx(h,{size:"md",mb:4,children:"Transaction Best Practices"}),e.jsxs(G,{spacing:3,children:[e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Use for Multi-Step Operations:"})," Any operation that requires multiple state changes"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Suspend Validation Wisely:"})," Suspend for intermediate states, validate at the end"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Handle Errors Gracefully:"})," Provide meaningful error messages and recovery options"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Keep Transactions Focused:"})," Don't make transactions too large or complex"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Test Rollback Scenarios:"})," Ensure your error handling and rollback logic works"]}),e.jsxs(g,{children:[e.jsx(b,{as:z,color:"green.500"}),e.jsx("strong",{children:"Use for Performance:"})," Batch operations to reduce validation overhead"]})]})]})]})});function zl(){return e.jsxs(d,{minH:"100vh",bg:"gray.50",children:[e.jsx(zr,{}),e.jsx(d,{as:"main",pt:"80px",children:e.jsxs(pr,{children:[e.jsx(ae,{path:"/",element:e.jsx($r,{})}),e.jsx(ae,{path:"/why",element:e.jsx(Zr,{})}),e.jsx(ae,{path:"/store",element:e.jsx(Lr,{})}),e.jsx(ae,{path:"/actions",element:e.jsx(Qo,{})}),e.jsx(ae,{path:"/react",element:e.jsx(il,{})}),e.jsx(ae,{path:"/validation",element:e.jsx(hl,{})}),e.jsx(ae,{path:"/schemas",element:e.jsx(ml,{})}),e.jsx(ae,{path:"/transactions",element:e.jsx(gl,{})}),e.jsx(ae,{path:"/rxjs",element:e.jsx(fl,{})}),e.jsx(ae,{path:"/advanced",element:e.jsx(xl,{})}),e.jsx(ae,{path:"/examples/todo-app",element:e.jsx(yl,{})}),e.jsx(ae,{path:"/examples/shopping-cart",element:e.jsx(vl,{})}),e.jsx(ae,{path:"/examples/form-validation",element:e.jsx(Sl,{})}),e.jsx(ae,{path:"/examples/transaction-demo",element:e.jsx(wl,{})}),e.jsx(ae,{path:"/api",element:e.jsx(jl,{})}),e.jsx(ae,{path:"/examples",element:e.jsx(bl,{})})]})})]})}const Fl=dr({colors:{brand:{50:"#e6f7ff",100:"#bae7ff",200:"#91d5ff",300:"#69c0ff",400:"#40a9ff",500:"#1890ff",600:"#096dd9",700:"#0050b3",800:"#003a8c",900:"#002766"},forest:{50:"#f0fff4",100:"#c6f6d5",200:"#9ae6b4",300:"#68d391",400:"#48bb78",500:"#38a169",600:"#2f855a",700:"#276749",800:"#22543d",900:"#1a202c"}},fonts:{heading:`'Poppins', -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif`,body:`'Poppins', -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif`,mono:"'JetBrains Mono', 'Monaco', 'Menlo', 'Ubuntu Mono', monospace"},layerStyles:{card:{py:1,px:1,borderRadius:"md",mb:2},highlight:{p:3,borderRadius:"md"},section:{spacing:6,align:"stretch"},infoBox:{p:4,borderRadius:"md"},sidebar:{position:"fixed",left:0,top:0,h:"100vh",w:"280px",bg:"gray.50",borderRight:"1px",borderColor:"gray.200",overflowY:"auto",p:6,zIndex:10},mainContent:{ml:"280px",p:8,maxW:"none"},methodCard:{p:6,borderRadius:"lg",border:"1px",borderColor:"gray.200",mb:6,bg:"white",shadow:"sm"},codeExample:{p:4,bg:"gray.50",borderRadius:"md",border:"1px",borderColor:"gray.200",fontFamily:"mono",fontSize:"sm",overflowX:"auto"},methodSignature:{py:3,borderBottom:"1px solid",borderColor:"red.600",fontFamily:"mono",fontSize:"sm",fontWeight:"semibold",color:"gray.800",display:"block"},navLink:{display:"block",py:2,px:3,borderRadius:"md",fontSize:"sm",color:"gray.700",textDecoration:"none",_hover:{bg:"gray.100",color:"brand.600"}}},textStyles:{body:{color:"gray.600",mb:4},description:{color:"gray.600",fontSize:"sm",mb:3},hero:{fontSize:"xl",color:"gray.600",maxW:"4xl",mx:"auto"}},components:{Button:{defaultProps:{colorScheme:"brand"}},Code:{baseStyle:{fontSize:"sm",fontFamily:"mono"}},Heading:{baseStyle:{fontWeight:"semibold"},sizes:{sm:{fontSize:"md",mb:2},md:{fontSize:"lg",mb:3},lg:{fontSize:"xl",mb:4}}}}});br.createRoot(document.getElementById("root")).render(e.jsx(vt.StrictMode,{children:e.jsx(ur,{theme:Fl,toastOptions:{defaultOptions:{position:"top-right",duration:4e3}},children:e.jsx(gr,{children:e.jsx(zl,{})})})}));
