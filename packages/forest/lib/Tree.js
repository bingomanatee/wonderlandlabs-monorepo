Object.defineProperty(exports,"__esModule",{value:!0}),exports.Tree=void 0;let constants_1=require("./constants"),Branch_1=require("./Branch"),join_1=require("./join"),DEFAULT_INITIALIZER={name:"DEFAULT_INITIALIZER",delta:function(t,e){return e.val}};class Tree{constructor(t,e,n){this.forest=t,this.dataEngine=n.dataEngine,this.engine.actions.has(constants_1.ACTION_NAME_INITIALIZER)?(t=this.engine.actions.get(constants_1.ACTION_NAME_INITIALIZER),this.root=new Branch_1.Branch(this,t,n)):this.root=new Branch_1.Branch(this,DEFAULT_INITIALIZER,n)}get top(){let t=this.root;for(;t;){if(!t.next)return t;t=t.next}return t}get engine(){return this.forest.dataEngine(this.dataEngine)}get value(){return this.top.value}do(t,e,n){var r=this.engine.actions.get(t);if(r)return r=new Branch_1.Branch(this,r,e,n),(0,join_1.join)(this.top,r),r;throw new Error("engine "+this.dataEngine+" does not have an action "+t)}}exports.Tree=Tree;