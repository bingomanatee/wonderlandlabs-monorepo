"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TransHandler=void 0;class TransHandler{constructor(s,t,e){this.mgr=s,this.id=t,this.props=e,this.puts=[];const i=this;this._sub=s.tree.updates.subscribe({next(t){"put-data"===t.action&&t.collection&&(s.tree.has(t.collection,t.identity)?i.puts.push(Object.assign(Object.assign({},t),{create:!s.tree.has(t.collection,t.identity),prev:s.tree.get(t.collection,t.identity)})):i.puts.push(t))}})}complete(){this.mgr.remove(this.id,!0),this._sub.unsubscribe()}fail(){this.mgr.remove(this.id,!1),this._sub.unsubscribe()}}exports.TransHandler=TransHandler;