import{d as Se,j as e,u as Be,B as d,C as ie,F as Ue,H as $,L as le,I as Zt,T as c,M as Sr,e as wr,f as O,g as zr,h as kr,i as Rt,k as _r,l as K,m as Ar,n as Cr,o as Fr,p as Tr,q as Er,r as En,s as $n,V as x,t as m,S as X,D as Ne,v as Te,w as se,x as b,y as F,z as $r,A as In,E as Zn,G as ae,J as ve,K as Rn,N as k,O as w,P as Ir,Q as Dn,R as $e,U as Ie,W as Ze,X as je,Y as be,Z as Zr,$ as Rr,a0 as Dt,a1 as St,a2 as wt,a3 as zt,a4 as kt,a5 as Xt,a6 as Dr,a7 as Pr,a8 as Or}from"./chakra-CbgKJTu2.js";import{e as Nr,g as Pn,b as pe,a as ee,u as Mr,L as Q,c as Qt,f as Vr,h as re,B as Lr}from"./vendor-BYoL5dE3.js";import{F as he}from"./forestry-BAjXgMwp.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();var et={},en;function Wr(){if(en)return et;en=1;var t=Nr();return et.createRoot=t.createRoot,et.hydrateRoot=t.hydrateRoot,et}var Ur=Wr();const Br=Pn(Ur),Hr=Se({d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z",displayName:"CopyIcon"}),qr=Se({viewBox:"0 0 14 14",d:"M14,7.77 L14,6.17 L12.06,5.53 L11.61,4.44 L12.49,2.6 L11.36,1.47 L9.55,2.38 L8.46,1.93 L7.77,0.01 L6.17,0.01 L5.54,1.95 L4.43,2.4 L2.59,1.52 L1.46,2.65 L2.37,4.46 L1.92,5.55 L0,6.23 L0,7.82 L1.94,8.46 L2.39,9.55 L1.51,11.39 L2.64,12.52 L4.45,11.61 L5.54,12.06 L6.23,13.98 L7.82,13.98 L8.45,12.04 L9.56,11.59 L11.4,12.47 L12.53,11.34 L11.61,9.53 L12.08,8.44 L14,7.75 L14,7.77 Z M7,10 C5.34,10 4,8.66 4,7 C4,5.34 5.34,4 7,4 C8.66,4 10,5.34 10,7 C10,8.66 8.66,10 7,10 Z",displayName:"SettingsIcon"}),Y=Se({displayName:"CheckCircleIcon",d:"M12,0A12,12,0,1,0,24,12,12.014,12.014,0,0,0,12,0Zm6.927,8.2-6.845,9.289a1.011,1.011,0,0,1-1.43.188L5.764,13.769a1,1,0,1,1,1.25-1.562l4.076,3.261,6.227-8.451A1,1,0,1,1,18.927,8.2Z"}),Gr=Se({d:"M19.5,9.5h-.75V6.75a6.75,6.75,0,0,0-13.5,0V9.5H4.5a2,2,0,0,0-2,2V22a2,2,0,0,0,2,2h15a2,2,0,0,0,2-2V11.5A2,2,0,0,0,19.5,9.5Zm-9.5,6a2,2,0,1,1,3,1.723V19.5a1,1,0,0,1-2,0V17.223A1.994,1.994,0,0,1,10,15.5ZM7.75,6.75a4.25,4.25,0,0,1,8.5,0V9a.5.5,0,0,1-.5.5H8.25a.5.5,0,0,1-.5-.5Z",displayName:"LockIcon"}),Jr=Se({displayName:"ChevronDownIcon",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"}),Ee=Se({d:"M23.555,8.729a1.505,1.505,0,0,0-1.406-.98H16.062a.5.5,0,0,1-.472-.334L13.405,1.222a1.5,1.5,0,0,0-2.81,0l-.005.016L8.41,7.415a.5.5,0,0,1-.471.334H1.85A1.5,1.5,0,0,0,.887,10.4l5.184,4.3a.5.5,0,0,1,.155.543L4.048,21.774a1.5,1.5,0,0,0,2.31,1.684l5.346-3.92a.5.5,0,0,1,.591,0l5.344,3.919a1.5,1.5,0,0,0,2.312-1.683l-2.178-6.535a.5.5,0,0,1,.155-.543l5.194-4.306A1.5,1.5,0,0,0,23.555,8.729Z",displayName:"StarIcon"}),tt=Se({d:"M12,0A12,12,0,1,0,24,12,12.013,12.013,0,0,0,12,0Zm.25,5a1.5,1.5,0,1,1-1.5,1.5A1.5,1.5,0,0,1,12.25,5ZM14.5,18.5h-4a1,1,0,0,1,0-2h.75a.25.25,0,0,0,.25-.25v-4.5a.25.25,0,0,0-.25-.25H10.5a1,1,0,0,1,0-2h1a2,2,0,0,1,2,2v4.75a.25.25,0,0,0,.25.25h.75a1,1,0,1,1,0,2Z"}),ke=Se({d:"M11.983,0a12.206,12.206,0,0,0-8.51,3.653A11.8,11.8,0,0,0,0,12.207,11.779,11.779,0,0,0,11.8,24h.214A12.111,12.111,0,0,0,24,11.791h0A11.766,11.766,0,0,0,11.983,0ZM10.5,16.542a1.476,1.476,0,0,1,1.449-1.53h.027a1.527,1.527,0,0,1,1.523,1.47,1.475,1.475,0,0,1-1.449,1.53h-.027A1.529,1.529,0,0,1,10.5,16.542ZM11,12.5v-6a1,1,0,0,1,2,0v6a1,1,0,1,1-2,0Z",displayName:"WarningIcon"}),V=Se({viewBox:"0 0 14 14",path:e.jsx("g",{fill:"currentColor",children:e.jsx("polygon",{points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})})});var On={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},tn=pe.createContext&&pe.createContext(On),Yr=["attr","size","title"];function Kr(t,n){if(t==null)return{};var r=Xr(t,n),s,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)s=o[i],!(n.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(r[s]=t[s])}return r}function Xr(t,n){if(t==null)return{};var r={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(n.indexOf(s)>=0)continue;r[s]=t[s]}return r}function lt(){return lt=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},lt.apply(this,arguments)}function nn(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function dt(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?nn(Object(r),!0).forEach(function(s){Qr(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):nn(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Qr(t,n,r){return n=es(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function es(t){var n=ts(t,"string");return typeof n=="symbol"?n:n+""}function ts(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function Nn(t){return t&&t.map((n,r)=>pe.createElement(n.tag,dt({key:r},n.attr),Nn(n.child)))}function Pt(t){return n=>pe.createElement(ns,lt({attr:dt({},t.attr)},n),Nn(t.child))}function ns(t){var n=r=>{var{attr:s,size:i,title:o}=t,a=Kr(t,Yr),l=i||r.size||"1em",u;return r.className&&(u=r.className),t.className&&(u=(u?u+" ":"")+t.className),pe.createElement("svg",lt({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,s,a,{className:u,style:dt(dt({color:t.color||r.color},r.style),t.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),o&&pe.createElement("title",null,o),t.children)};return tn!==void 0?pe.createElement(tn.Consumer,null,r=>n(r)):n(On)}function rs(t){return Pt({attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"},child:[]}]})(t)}function ye(t,...n){const r=ee.useRef(null);r.current||=t(...n);const[s,i]=ee.useState(r.current?.value);return ee.useEffect(()=>{if(r.current){let o=r.current?.subscribe(i);return()=>{o?.unsubscribe()}}},[]),[s,r.current]}class ss extends he{constructor(){super({name:"navigation",value:{openMenu:null,hoveredMenu:null}})}openMenu(n){this.mutate(r=>{r.openMenu=n,r.hoveredMenu=n})}closeMenu(){this.mutate(n=>{n.openMenu=null,n.hoveredMenu=null})}setHoveredMenu(n){this.mutate(r=>{r.hoveredMenu=n,r.openMenu=n})}handleMenuEnter(n){this.mutate(r=>{r.hoveredMenu=n,r.openMenu=n})}handleMenuLeave(){this.mutate(n=>{n.hoveredMenu=null,n.openMenu=null})}handleItemClick(){this.mutate(n=>{n.openMenu=null,n.hoveredMenu=null})}}const is=()=>new ss,os={"Getting Started":[{label:"Quick Start",path:"/"},{label:"Why Forestry?",path:"/why"}],"Essential Features":[{label:"Basics",path:"/forest"},{label:"Actions",path:"/actions"},{label:"With React",path:"/react"}],"Power Tools":[{label:"Validation",path:"/validation"},{label:"Schema",path:"/schemas"},{label:"Transactions",path:"/transactions"},{label:"RxJS / Immer",path:"/rxjs"}],"Practical Examples":[{label:"Overview",path:"/examples"},{label:"Todo App",path:"/examples/todo-app"},{label:"Shopping Cart",path:"/examples/shopping-cart"},{label:"Form Validation",path:"/examples/form-validation"},{label:"Transaction Demo",path:"/examples/transaction-demo"}],"API Reference":[{label:"Overview",path:"/api"},{label:"Forest Class",path:"/api#forest"},{label:"Constructor & Properties",path:"/api#forest-constructor"},{label:"Core Methods",path:"/api#forest-core"},{label:"Branching Methods",path:"/api#forest-branching"},{label:"Transactions",path:"/api#forest-transactions"},{label:"Validation",path:"/api#forest-validation"},{label:"Types",path:"/api#types-config"}]},as=()=>{const t=Mr(),n=Be("black","gray.500"),r=Be("white","black"),[s,i]=ye(is),{openMenu:o}=s,a=l=>t.pathname===l;return e.jsx(d,{position:"fixed",top:0,left:0,right:0,zIndex:1e3,bg:n,shadow:"sm",children:e.jsx(ie,{maxW:"container.xl",children:e.jsxs(Ue,{alignItems:"center",justifyContent:"space-between",children:[e.jsxs($,{as:le,spacing:2,to:"/",mr:10,children:[e.jsx(Zt,{w:"32px",h:"32px",src:"/img/logo-dark.png"}),e.jsx(c,{fontSize:"xl",fontWeight:"bold",color:r,whiteSpace:"nowrap",children:"Forestry 4.0"})]}),e.jsxs($,{spacing:6,children:[Object.entries(os).map(([l,u])=>e.jsxs(Sr,{isOpen:o===l,onClose:()=>i.$.closeMenu(),children:[e.jsx(wr,{as:O,variant:"ghost",colorScheme:"green",color:"green.300",_hover:{bg:"green.700",color:"white"},_active:{bg:"green.600",color:"white"},_focus:{boxShadow:"none",outline:"none"},_focusVisible:{boxShadow:"none",outline:"none"},rightIcon:e.jsx(Jr,{}),onMouseEnter:()=>i.handleMenuEnter(l),onClick:()=>{o===l?i.closeMenu():i.openMenu(l)},children:l}),e.jsx(zr,{onMouseLeave:()=>i.handleMenuLeave(),onMouseEnter:()=>i.setHoveredMenu(l),py:0,overflow:"hidden",children:u.map(h=>e.jsx(kr,{as:h.external?le:Q,to:h.external?void 0:h.path,href:h.external?h.path:void 0,isExternal:h.external,bg:!h.external&&a(h.path)?"forest.50":"transparent",color:!h.external&&a(h.path)?"forest.600":"gray.700",fontWeight:!h.external&&a(h.path)?"semibold":"normal",_hover:{bg:!h.external&&a(h.path)?"forest.100":"gray.50"},onClick:()=>i.handleItemClick(),children:h.label},h.path))})]},l)),e.jsx(O,{as:le,href:"https://github.com/bingomanatee/wonderlandlabs-monorepo",isExternal:!0,variant:"ghost",size:"sm","aria-label":"View source on GitHub",children:e.jsx(c,{color:"white",children:e.jsx(rs,{})})})]})]})})})};function g(t,n,r){function s(l,u){var h;Object.defineProperty(l,"_zod",{value:l._zod??{},enumerable:!1}),(h=l._zod).traits??(h.traits=new Set),l._zod.traits.add(t),n(l,u);for(const z in a.prototype)z in l||Object.defineProperty(l,z,{value:a.prototype[z].bind(l)});l._zod.constr=a,l._zod.def=u}const i=r?.Parent??Object;class o extends i{}Object.defineProperty(o,"name",{value:t});function a(l){var u;const h=r?.Parent?new o:this;s(h,l),(u=h._zod).deferred??(u.deferred=[]);for(const z of h._zod.deferred)z();return h}return Object.defineProperty(a,"init",{value:s}),Object.defineProperty(a,Symbol.hasInstance,{value:l=>r?.Parent&&l instanceof r.Parent?!0:l?._zod?.traits?.has(t)}),Object.defineProperty(a,"name",{value:t}),a}class Me extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class Mn extends Error{constructor(n){super(`Encountered unidirectional transform during encode: ${n}`),this.name="ZodEncodeError"}}const Vn={};function _e(t){return Vn}function cs(t){const n=Object.values(t).filter(s=>typeof s=="number");return Object.entries(t).filter(([s,i])=>n.indexOf(+s)===-1).map(([s,i])=>i)}function Tt(t,n){return typeof n=="bigint"?n.toString():n}function Ot(t){return{get value(){{const n=t();return Object.defineProperty(this,"value",{value:n}),n}}}}function Nt(t){return t==null}function Mt(t){const n=t.startsWith("^")?1:0,r=t.endsWith("$")?t.length-1:t.length;return t.slice(n,r)}function ls(t,n){const r=(t.toString().split(".")[1]||"").length,s=n.toString();let i=(s.split(".")[1]||"").length;if(i===0&&/\d?e-\d?/.test(s)){const u=s.match(/\d?e-(\d?)/);u?.[1]&&(i=Number.parseInt(u[1]))}const o=r>i?r:i,a=Number.parseInt(t.toFixed(o).replace(".","")),l=Number.parseInt(n.toFixed(o).replace(".",""));return a%l/10**o}const rn=Symbol("evaluating");function N(t,n,r){let s;Object.defineProperty(t,n,{get(){if(s!==rn)return s===void 0&&(s=rn,s=r()),s},set(i){Object.defineProperty(t,n,{value:i})},configurable:!0})}function ds(t){return Object.create(Object.getPrototypeOf(t),Object.getOwnPropertyDescriptors(t))}function Ce(t,n,r){Object.defineProperty(t,n,{value:r,writable:!0,enumerable:!0,configurable:!0})}function Le(...t){const n={};for(const r of t){const s=Object.getOwnPropertyDescriptors(r);Object.assign(n,s)}return Object.defineProperties({},n)}function sn(t){return JSON.stringify(t)}const Ln="captureStackTrace"in Error?Error.captureStackTrace:(...t)=>{};function ut(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}const us=Ot(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const t=Function;return new t(""),!0}catch{return!1}});function Ve(t){if(ut(t)===!1)return!1;const n=t.constructor;if(n===void 0)return!0;const r=n.prototype;return!(ut(r)===!1||Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===!1)}function Wn(t){return Ve(t)?{...t}:Array.isArray(t)?[...t]:t}const hs=new Set(["string","number","symbol"]);function gt(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Fe(t,n,r){const s=new t._zod.constr(n??t._zod.def);return(!n||r?.parent)&&(s._zod.parent=t),s}function _(t){const n=t;if(!n)return{};if(typeof n=="string")return{error:()=>n};if(n?.message!==void 0){if(n?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");n.error=n.message}return delete n.message,typeof n.error=="string"?{...n,error:()=>n.error}:n}function ps(t){return Object.keys(t).filter(n=>t[n]._zod.optin==="optional"&&t[n]._zod.optout==="optional")}const ms={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function gs(t,n){const r=t._zod.def,s=Le(t._zod.def,{get shape(){const i={};for(const o in n){if(!(o in r.shape))throw new Error(`Unrecognized key: "${o}"`);n[o]&&(i[o]=r.shape[o])}return Ce(this,"shape",i),i},checks:[]});return Fe(t,s)}function fs(t,n){const r=t._zod.def,s=Le(t._zod.def,{get shape(){const i={...t._zod.def.shape};for(const o in n){if(!(o in r.shape))throw new Error(`Unrecognized key: "${o}"`);n[o]&&delete i[o]}return Ce(this,"shape",i),i},checks:[]});return Fe(t,s)}function xs(t,n){if(!Ve(n))throw new Error("Invalid input to extend: expected a plain object");const r=t._zod.def.checks;if(r&&r.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const i=Le(t._zod.def,{get shape(){const o={...t._zod.def.shape,...n};return Ce(this,"shape",o),o},checks:[]});return Fe(t,i)}function js(t,n){if(!Ve(n))throw new Error("Invalid input to safeExtend: expected a plain object");const r={...t._zod.def,get shape(){const s={...t._zod.def.shape,...n};return Ce(this,"shape",s),s},checks:t._zod.def.checks};return Fe(t,r)}function bs(t,n){const r=Le(t._zod.def,{get shape(){const s={...t._zod.def.shape,...n._zod.def.shape};return Ce(this,"shape",s),s},get catchall(){return n._zod.def.catchall},checks:[]});return Fe(t,r)}function ys(t,n,r){const s=Le(n._zod.def,{get shape(){const i=n._zod.def.shape,o={...i};if(r)for(const a in r){if(!(a in i))throw new Error(`Unrecognized key: "${a}"`);r[a]&&(o[a]=t?new t({type:"optional",innerType:i[a]}):i[a])}else for(const a in i)o[a]=t?new t({type:"optional",innerType:i[a]}):i[a];return Ce(this,"shape",o),o},checks:[]});return Fe(n,s)}function vs(t,n,r){const s=Le(n._zod.def,{get shape(){const i=n._zod.def.shape,o={...i};if(r)for(const a in r){if(!(a in o))throw new Error(`Unrecognized key: "${a}"`);r[a]&&(o[a]=new t({type:"nonoptional",innerType:i[a]}))}else for(const a in i)o[a]=new t({type:"nonoptional",innerType:i[a]});return Ce(this,"shape",o),o},checks:[]});return Fe(n,s)}function De(t,n=0){if(t.aborted===!0)return!0;for(let r=n;r<t.issues.length;r++)if(t.issues[r]?.continue!==!0)return!0;return!1}function Pe(t,n){return n.map(r=>{var s;return(s=r).path??(s.path=[]),r.path.unshift(t),r})}function nt(t){return typeof t=="string"?t:t?.message}function Ae(t,n,r){const s={...t,path:t.path??[]};if(!t.message){const i=nt(t.inst?._zod.def?.error?.(t))??nt(n?.error?.(t))??nt(r.customError?.(t))??nt(r.localeError?.(t))??"Invalid input";s.message=i}return delete s.inst,delete s.continue,n?.reportInput||delete s.input,s}function Vt(t){return Array.isArray(t)?"array":typeof t=="string"?"string":"unknown"}function He(...t){const[n,r,s]=t;return typeof n=="string"?{message:n,code:"custom",input:r,inst:s}:{...n}}const Un=(t,n)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:n,enumerable:!1}),t.message=JSON.stringify(n,Tt,2),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},Bn=g("$ZodError",Un),Hn=g("$ZodError",Un,{Parent:Error});function Ss(t,n=r=>r.message){const r={},s=[];for(const i of t.issues)i.path.length>0?(r[i.path[0]]=r[i.path[0]]||[],r[i.path[0]].push(n(i))):s.push(n(i));return{formErrors:s,fieldErrors:r}}function ws(t,n){const r=n||function(o){return o.message},s={_errors:[]},i=o=>{for(const a of o.issues)if(a.code==="invalid_union"&&a.errors.length)a.errors.map(l=>i({issues:l}));else if(a.code==="invalid_key")i({issues:a.issues});else if(a.code==="invalid_element")i({issues:a.issues});else if(a.path.length===0)s._errors.push(r(a));else{let l=s,u=0;for(;u<a.path.length;){const h=a.path[u];u===a.path.length-1?(l[h]=l[h]||{_errors:[]},l[h]._errors.push(r(a))):l[h]=l[h]||{_errors:[]},l=l[h],u++}}};return i(t),s}const Lt=t=>(n,r,s,i)=>{const o=s?Object.assign(s,{async:!1}):{async:!1},a=n._zod.run({value:r,issues:[]},o);if(a instanceof Promise)throw new Me;if(a.issues.length){const l=new(i?.Err??t)(a.issues.map(u=>Ae(u,o,_e())));throw Ln(l,i?.callee),l}return a.value},Wt=t=>async(n,r,s,i)=>{const o=s?Object.assign(s,{async:!0}):{async:!0};let a=n._zod.run({value:r,issues:[]},o);if(a instanceof Promise&&(a=await a),a.issues.length){const l=new(i?.Err??t)(a.issues.map(u=>Ae(u,o,_e())));throw Ln(l,i?.callee),l}return a.value},ft=t=>(n,r,s)=>{const i=s?{...s,async:!1}:{async:!1},o=n._zod.run({value:r,issues:[]},i);if(o instanceof Promise)throw new Me;return o.issues.length?{success:!1,error:new(t??Bn)(o.issues.map(a=>Ae(a,i,_e())))}:{success:!0,data:o.value}},zs=ft(Hn),xt=t=>async(n,r,s)=>{const i=s?Object.assign(s,{async:!0}):{async:!0};let o=n._zod.run({value:r,issues:[]},i);return o instanceof Promise&&(o=await o),o.issues.length?{success:!1,error:new t(o.issues.map(a=>Ae(a,i,_e())))}:{success:!0,data:o.value}},ks=xt(Hn),_s=t=>(n,r,s)=>{const i=s?Object.assign(s,{direction:"backward"}):{direction:"backward"};return Lt(t)(n,r,i)},As=t=>(n,r,s)=>Lt(t)(n,r,s),Cs=t=>async(n,r,s)=>{const i=s?Object.assign(s,{direction:"backward"}):{direction:"backward"};return Wt(t)(n,r,i)},Fs=t=>async(n,r,s)=>Wt(t)(n,r,s),Ts=t=>(n,r,s)=>{const i=s?Object.assign(s,{direction:"backward"}):{direction:"backward"};return ft(t)(n,r,i)},Es=t=>(n,r,s)=>ft(t)(n,r,s),$s=t=>async(n,r,s)=>{const i=s?Object.assign(s,{direction:"backward"}):{direction:"backward"};return xt(t)(n,r,i)},Is=t=>async(n,r,s)=>xt(t)(n,r,s),Zs=/^[cC][^\s-]{8,}$/,Rs=/^[0-9a-z]+$/,Ds=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,Ps=/^[0-9a-vA-V]{20}$/,Os=/^[A-Za-z0-9]{27}$/,Ns=/^[a-zA-Z0-9_-]{21}$/,Ms=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,Vs=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,on=t=>t?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${t}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,Ls=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,Ws="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function Us(){return new RegExp(Ws,"u")}const Bs=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Hs=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,qs=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,Gs=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Js=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,qn=/^[A-Za-z0-9_-]*$/,Ys=/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,Ks=/^\+(?:[0-9]){6,14}[0-9]$/,Gn="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",Xs=new RegExp(`^${Gn}$`);function Jn(t){const n="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof t.precision=="number"?t.precision===-1?`${n}`:t.precision===0?`${n}:[0-5]\\d`:`${n}:[0-5]\\d\\.\\d{${t.precision}}`:`${n}(?::[0-5]\\d(?:\\.\\d+)?)?`}function Qs(t){return new RegExp(`^${Jn(t)}$`)}function ei(t){const n=Jn({precision:t.precision}),r=["Z"];t.local&&r.push(""),t.offset&&r.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const s=`${n}(?:${r.join("|")})`;return new RegExp(`^${Gn}T(?:${s})$`)}const ti=t=>{const n=t?`[\\s\\S]{${t?.minimum??0},${t?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${n}$`)},ni=/^-?\d+$/,ri=/^-?\d+(?:\.\d+)?/,si=/^(?:true|false)$/i,ii=/^[^A-Z]*$/,oi=/^[^a-z]*$/,ce=g("$ZodCheck",(t,n)=>{var r;t._zod??(t._zod={}),t._zod.def=n,(r=t._zod).onattach??(r.onattach=[])}),Yn={number:"number",bigint:"bigint",object:"date"},Kn=g("$ZodCheckLessThan",(t,n)=>{ce.init(t,n);const r=Yn[typeof n.value];t._zod.onattach.push(s=>{const i=s._zod.bag,o=(n.inclusive?i.maximum:i.exclusiveMaximum)??Number.POSITIVE_INFINITY;n.value<o&&(n.inclusive?i.maximum=n.value:i.exclusiveMaximum=n.value)}),t._zod.check=s=>{(n.inclusive?s.value<=n.value:s.value<n.value)||s.issues.push({origin:r,code:"too_big",maximum:n.value,input:s.value,inclusive:n.inclusive,inst:t,continue:!n.abort})}}),Xn=g("$ZodCheckGreaterThan",(t,n)=>{ce.init(t,n);const r=Yn[typeof n.value];t._zod.onattach.push(s=>{const i=s._zod.bag,o=(n.inclusive?i.minimum:i.exclusiveMinimum)??Number.NEGATIVE_INFINITY;n.value>o&&(n.inclusive?i.minimum=n.value:i.exclusiveMinimum=n.value)}),t._zod.check=s=>{(n.inclusive?s.value>=n.value:s.value>n.value)||s.issues.push({origin:r,code:"too_small",minimum:n.value,input:s.value,inclusive:n.inclusive,inst:t,continue:!n.abort})}}),ai=g("$ZodCheckMultipleOf",(t,n)=>{ce.init(t,n),t._zod.onattach.push(r=>{var s;(s=r._zod.bag).multipleOf??(s.multipleOf=n.value)}),t._zod.check=r=>{if(typeof r.value!=typeof n.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof r.value=="bigint"?r.value%n.value===BigInt(0):ls(r.value,n.value)===0)||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:n.value,input:r.value,inst:t,continue:!n.abort})}}),ci=g("$ZodCheckNumberFormat",(t,n)=>{ce.init(t,n),n.format=n.format||"float64";const r=n.format?.includes("int"),s=r?"int":"number",[i,o]=ms[n.format];t._zod.onattach.push(a=>{const l=a._zod.bag;l.format=n.format,l.minimum=i,l.maximum=o,r&&(l.pattern=ni)}),t._zod.check=a=>{const l=a.value;if(r){if(!Number.isInteger(l)){a.issues.push({expected:s,format:n.format,code:"invalid_type",continue:!1,input:l,inst:t});return}if(!Number.isSafeInteger(l)){l>0?a.issues.push({input:l,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:s,continue:!n.abort}):a.issues.push({input:l,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:s,continue:!n.abort});return}}l<i&&a.issues.push({origin:"number",input:l,code:"too_small",minimum:i,inclusive:!0,inst:t,continue:!n.abort}),l>o&&a.issues.push({origin:"number",input:l,code:"too_big",maximum:o,inst:t})}}),li=g("$ZodCheckMaxLength",(t,n)=>{var r;ce.init(t,n),(r=t._zod.def).when??(r.when=s=>{const i=s.value;return!Nt(i)&&i.length!==void 0}),t._zod.onattach.push(s=>{const i=s._zod.bag.maximum??Number.POSITIVE_INFINITY;n.maximum<i&&(s._zod.bag.maximum=n.maximum)}),t._zod.check=s=>{const i=s.value;if(i.length<=n.maximum)return;const a=Vt(i);s.issues.push({origin:a,code:"too_big",maximum:n.maximum,inclusive:!0,input:i,inst:t,continue:!n.abort})}}),di=g("$ZodCheckMinLength",(t,n)=>{var r;ce.init(t,n),(r=t._zod.def).when??(r.when=s=>{const i=s.value;return!Nt(i)&&i.length!==void 0}),t._zod.onattach.push(s=>{const i=s._zod.bag.minimum??Number.NEGATIVE_INFINITY;n.minimum>i&&(s._zod.bag.minimum=n.minimum)}),t._zod.check=s=>{const i=s.value;if(i.length>=n.minimum)return;const a=Vt(i);s.issues.push({origin:a,code:"too_small",minimum:n.minimum,inclusive:!0,input:i,inst:t,continue:!n.abort})}}),ui=g("$ZodCheckLengthEquals",(t,n)=>{var r;ce.init(t,n),(r=t._zod.def).when??(r.when=s=>{const i=s.value;return!Nt(i)&&i.length!==void 0}),t._zod.onattach.push(s=>{const i=s._zod.bag;i.minimum=n.length,i.maximum=n.length,i.length=n.length}),t._zod.check=s=>{const i=s.value,o=i.length;if(o===n.length)return;const a=Vt(i),l=o>n.length;s.issues.push({origin:a,...l?{code:"too_big",maximum:n.length}:{code:"too_small",minimum:n.length},inclusive:!0,exact:!0,input:s.value,inst:t,continue:!n.abort})}}),jt=g("$ZodCheckStringFormat",(t,n)=>{var r,s;ce.init(t,n),t._zod.onattach.push(i=>{const o=i._zod.bag;o.format=n.format,n.pattern&&(o.patterns??(o.patterns=new Set),o.patterns.add(n.pattern))}),n.pattern?(r=t._zod).check??(r.check=i=>{n.pattern.lastIndex=0,!n.pattern.test(i.value)&&i.issues.push({origin:"string",code:"invalid_format",format:n.format,input:i.value,...n.pattern?{pattern:n.pattern.toString()}:{},inst:t,continue:!n.abort})}):(s=t._zod).check??(s.check=()=>{})}),hi=g("$ZodCheckRegex",(t,n)=>{jt.init(t,n),t._zod.check=r=>{n.pattern.lastIndex=0,!n.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:n.pattern.toString(),inst:t,continue:!n.abort})}}),pi=g("$ZodCheckLowerCase",(t,n)=>{n.pattern??(n.pattern=ii),jt.init(t,n)}),mi=g("$ZodCheckUpperCase",(t,n)=>{n.pattern??(n.pattern=oi),jt.init(t,n)}),gi=g("$ZodCheckIncludes",(t,n)=>{ce.init(t,n);const r=gt(n.includes),s=new RegExp(typeof n.position=="number"?`^.{${n.position}}${r}`:r);n.pattern=s,t._zod.onattach.push(i=>{const o=i._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(s)}),t._zod.check=i=>{i.value.includes(n.includes,n.position)||i.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:n.includes,input:i.value,inst:t,continue:!n.abort})}}),fi=g("$ZodCheckStartsWith",(t,n)=>{ce.init(t,n);const r=new RegExp(`^${gt(n.prefix)}.*`);n.pattern??(n.pattern=r),t._zod.onattach.push(s=>{const i=s._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(r)}),t._zod.check=s=>{s.value.startsWith(n.prefix)||s.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:n.prefix,input:s.value,inst:t,continue:!n.abort})}}),xi=g("$ZodCheckEndsWith",(t,n)=>{ce.init(t,n);const r=new RegExp(`.*${gt(n.suffix)}$`);n.pattern??(n.pattern=r),t._zod.onattach.push(s=>{const i=s._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(r)}),t._zod.check=s=>{s.value.endsWith(n.suffix)||s.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:n.suffix,input:s.value,inst:t,continue:!n.abort})}}),ji=g("$ZodCheckOverwrite",(t,n)=>{ce.init(t,n),t._zod.check=r=>{r.value=n.tx(r.value)}});class bi{constructor(n=[]){this.content=[],this.indent=0,this&&(this.args=n)}indented(n){this.indent+=1,n(this),this.indent-=1}write(n){if(typeof n=="function"){n(this,{execution:"sync"}),n(this,{execution:"async"});return}const s=n.split(`
`).filter(a=>a),i=Math.min(...s.map(a=>a.length-a.trimStart().length)),o=s.map(a=>a.slice(i)).map(a=>" ".repeat(this.indent*2)+a);for(const a of o)this.content.push(a)}compile(){const n=Function,r=this?.args,i=[...(this?.content??[""]).map(o=>`  ${o}`)];return new n(...r,i.join(`
`))}}const yi={major:4,minor:1,patch:8},U=g("$ZodType",(t,n)=>{var r;t??(t={}),t._zod.def=n,t._zod.bag=t._zod.bag||{},t._zod.version=yi;const s=[...t._zod.def.checks??[]];t._zod.traits.has("$ZodCheck")&&s.unshift(t);for(const i of s)for(const o of i._zod.onattach)o(t);if(s.length===0)(r=t._zod).deferred??(r.deferred=[]),t._zod.deferred?.push(()=>{t._zod.run=t._zod.parse});else{const i=(a,l,u)=>{let h=De(a),z;for(const v of l){if(v._zod.def.when){if(!v._zod.def.when(a))continue}else if(h)continue;const R=a.issues.length,A=v._zod.check(a);if(A instanceof Promise&&u?.async===!1)throw new Me;if(z||A instanceof Promise)z=(z??Promise.resolve()).then(async()=>{await A,a.issues.length!==R&&(h||(h=De(a,R)))});else{if(a.issues.length===R)continue;h||(h=De(a,R))}}return z?z.then(()=>a):a},o=(a,l,u)=>{if(De(a))return a.aborted=!0,a;const h=i(l,s,u);if(h instanceof Promise){if(u.async===!1)throw new Me;return h.then(z=>t._zod.parse(z,u))}return t._zod.parse(h,u)};t._zod.run=(a,l)=>{if(l.skipChecks)return t._zod.parse(a,l);if(l.direction==="backward"){const h=t._zod.parse({value:a.value,issues:[]},{...l,skipChecks:!0});return h instanceof Promise?h.then(z=>o(z,a,l)):o(h,a,l)}const u=t._zod.parse(a,l);if(u instanceof Promise){if(l.async===!1)throw new Me;return u.then(h=>i(h,s,l))}return i(u,s,l)}}t["~standard"]={validate:i=>{try{const o=zs(t,i);return o.success?{value:o.data}:{issues:o.error?.issues}}catch{return ks(t,i).then(a=>a.success?{value:a.data}:{issues:a.error?.issues})}},vendor:"zod",version:1}}),Ut=g("$ZodString",(t,n)=>{U.init(t,n),t._zod.pattern=[...t?._zod.bag?.patterns??[]].pop()??ti(t._zod.bag),t._zod.parse=(r,s)=>{if(n.coerce)try{r.value=String(r.value)}catch{}return typeof r.value=="string"||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:t}),r}}),L=g("$ZodStringFormat",(t,n)=>{jt.init(t,n),Ut.init(t,n)}),vi=g("$ZodGUID",(t,n)=>{n.pattern??(n.pattern=Vs),L.init(t,n)}),Si=g("$ZodUUID",(t,n)=>{if(n.version){const s={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[n.version];if(s===void 0)throw new Error(`Invalid UUID version: "${n.version}"`);n.pattern??(n.pattern=on(s))}else n.pattern??(n.pattern=on());L.init(t,n)}),wi=g("$ZodEmail",(t,n)=>{n.pattern??(n.pattern=Ls),L.init(t,n)}),zi=g("$ZodURL",(t,n)=>{L.init(t,n),t._zod.check=r=>{try{const s=r.value.trim(),i=new URL(s);n.hostname&&(n.hostname.lastIndex=0,n.hostname.test(i.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:Ys.source,input:r.value,inst:t,continue:!n.abort})),n.protocol&&(n.protocol.lastIndex=0,n.protocol.test(i.protocol.endsWith(":")?i.protocol.slice(0,-1):i.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:n.protocol.source,input:r.value,inst:t,continue:!n.abort})),n.normalize?r.value=i.href:r.value=s;return}catch{r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:t,continue:!n.abort})}}}),ki=g("$ZodEmoji",(t,n)=>{n.pattern??(n.pattern=Us()),L.init(t,n)}),_i=g("$ZodNanoID",(t,n)=>{n.pattern??(n.pattern=Ns),L.init(t,n)}),Ai=g("$ZodCUID",(t,n)=>{n.pattern??(n.pattern=Zs),L.init(t,n)}),Ci=g("$ZodCUID2",(t,n)=>{n.pattern??(n.pattern=Rs),L.init(t,n)}),Fi=g("$ZodULID",(t,n)=>{n.pattern??(n.pattern=Ds),L.init(t,n)}),Ti=g("$ZodXID",(t,n)=>{n.pattern??(n.pattern=Ps),L.init(t,n)}),Ei=g("$ZodKSUID",(t,n)=>{n.pattern??(n.pattern=Os),L.init(t,n)}),$i=g("$ZodISODateTime",(t,n)=>{n.pattern??(n.pattern=ei(n)),L.init(t,n)}),Ii=g("$ZodISODate",(t,n)=>{n.pattern??(n.pattern=Xs),L.init(t,n)}),Zi=g("$ZodISOTime",(t,n)=>{n.pattern??(n.pattern=Qs(n)),L.init(t,n)}),Ri=g("$ZodISODuration",(t,n)=>{n.pattern??(n.pattern=Ms),L.init(t,n)}),Di=g("$ZodIPv4",(t,n)=>{n.pattern??(n.pattern=Bs),L.init(t,n),t._zod.onattach.push(r=>{const s=r._zod.bag;s.format="ipv4"})}),Pi=g("$ZodIPv6",(t,n)=>{n.pattern??(n.pattern=Hs),L.init(t,n),t._zod.onattach.push(r=>{const s=r._zod.bag;s.format="ipv6"}),t._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:t,continue:!n.abort})}}}),Oi=g("$ZodCIDRv4",(t,n)=>{n.pattern??(n.pattern=qs),L.init(t,n)}),Ni=g("$ZodCIDRv6",(t,n)=>{n.pattern??(n.pattern=Gs),L.init(t,n),t._zod.check=r=>{const s=r.value.split("/");try{if(s.length!==2)throw new Error;const[i,o]=s;if(!o)throw new Error;const a=Number(o);if(`${a}`!==o)throw new Error;if(a<0||a>128)throw new Error;new URL(`http://[${i}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:t,continue:!n.abort})}}});function Qn(t){if(t==="")return!0;if(t.length%4!==0)return!1;try{return atob(t),!0}catch{return!1}}const Mi=g("$ZodBase64",(t,n)=>{n.pattern??(n.pattern=Js),L.init(t,n),t._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64"}),t._zod.check=r=>{Qn(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:t,continue:!n.abort})}});function Vi(t){if(!qn.test(t))return!1;const n=t.replace(/[-_]/g,s=>s==="-"?"+":"/"),r=n.padEnd(Math.ceil(n.length/4)*4,"=");return Qn(r)}const Li=g("$ZodBase64URL",(t,n)=>{n.pattern??(n.pattern=qn),L.init(t,n),t._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64url"}),t._zod.check=r=>{Vi(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:t,continue:!n.abort})}}),Wi=g("$ZodE164",(t,n)=>{n.pattern??(n.pattern=Ks),L.init(t,n)});function Ui(t,n=null){try{const r=t.split(".");if(r.length!==3)return!1;const[s]=r;if(!s)return!1;const i=JSON.parse(atob(s));return!("typ"in i&&i?.typ!=="JWT"||!i.alg||n&&(!("alg"in i)||i.alg!==n))}catch{return!1}}const Bi=g("$ZodJWT",(t,n)=>{L.init(t,n),t._zod.check=r=>{Ui(r.value,n.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:t,continue:!n.abort})}}),er=g("$ZodNumber",(t,n)=>{U.init(t,n),t._zod.pattern=t._zod.bag.pattern??ri,t._zod.parse=(r,s)=>{if(n.coerce)try{r.value=Number(r.value)}catch{}const i=r.value;if(typeof i=="number"&&!Number.isNaN(i)&&Number.isFinite(i))return r;const o=typeof i=="number"?Number.isNaN(i)?"NaN":Number.isFinite(i)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:i,inst:t,...o?{received:o}:{}}),r}}),Hi=g("$ZodNumber",(t,n)=>{ci.init(t,n),er.init(t,n)}),qi=g("$ZodBoolean",(t,n)=>{U.init(t,n),t._zod.pattern=si,t._zod.parse=(r,s)=>{if(n.coerce)try{r.value=!!r.value}catch{}const i=r.value;return typeof i=="boolean"||r.issues.push({expected:"boolean",code:"invalid_type",input:i,inst:t}),r}}),Gi=g("$ZodUnknown",(t,n)=>{U.init(t,n),t._zod.parse=r=>r}),Ji=g("$ZodNever",(t,n)=>{U.init(t,n),t._zod.parse=(r,s)=>(r.issues.push({expected:"never",code:"invalid_type",input:r.value,inst:t}),r)}),Yi=g("$ZodDate",(t,n)=>{U.init(t,n),t._zod.parse=(r,s)=>{if(n.coerce)try{r.value=new Date(r.value)}catch{}const i=r.value,o=i instanceof Date;return o&&!Number.isNaN(i.getTime())||r.issues.push({expected:"date",code:"invalid_type",input:i,...o?{received:"Invalid Date"}:{},inst:t}),r}});function an(t,n,r){t.issues.length&&n.issues.push(...Pe(r,t.issues)),n.value[r]=t.value}const Ki=g("$ZodArray",(t,n)=>{U.init(t,n),t._zod.parse=(r,s)=>{const i=r.value;if(!Array.isArray(i))return r.issues.push({expected:"array",code:"invalid_type",input:i,inst:t}),r;r.value=Array(i.length);const o=[];for(let a=0;a<i.length;a++){const l=i[a],u=n.element._zod.run({value:l,issues:[]},s);u instanceof Promise?o.push(u.then(h=>an(h,r,a))):an(u,r,a)}return o.length?Promise.all(o).then(()=>r):r}});function ht(t,n,r,s){t.issues.length&&n.issues.push(...Pe(r,t.issues)),t.value===void 0?r in s&&(n.value[r]=void 0):n.value[r]=t.value}function tr(t){const n=Object.keys(t.shape);for(const s of n)if(!t.shape?.[s]?._zod?.traits?.has("$ZodType"))throw new Error(`Invalid element at key "${s}": expected a Zod schema`);const r=ps(t.shape);return{...t,keys:n,keySet:new Set(n),numKeys:n.length,optionalKeys:new Set(r)}}function nr(t,n,r,s,i,o){const a=[],l=i.keySet,u=i.catchall._zod,h=u.def.type;for(const z of Object.keys(n)){if(l.has(z))continue;if(h==="never"){a.push(z);continue}const v=u.run({value:n[z],issues:[]},s);v instanceof Promise?t.push(v.then(R=>ht(R,r,z,n))):ht(v,r,z,n)}return a.length&&r.issues.push({code:"unrecognized_keys",keys:a,input:n,inst:o}),t.length?Promise.all(t).then(()=>r):r}const Xi=g("$ZodObject",(t,n)=>{U.init(t,n);const r=Ot(()=>tr(n));N(t._zod,"propValues",()=>{const a=n.shape,l={};for(const u in a){const h=a[u]._zod;if(h.values){l[u]??(l[u]=new Set);for(const z of h.values)l[u].add(z)}}return l});const s=ut,i=n.catchall;let o;t._zod.parse=(a,l)=>{o??(o=r.value);const u=a.value;if(!s(u))return a.issues.push({expected:"object",code:"invalid_type",input:u,inst:t}),a;a.value={};const h=[],z=o.shape;for(const v of o.keys){const A=z[v]._zod.run({value:u[v],issues:[]},l);A instanceof Promise?h.push(A.then(I=>ht(I,a,v,u))):ht(A,a,v,u)}return i?nr(h,u,a,l,r.value,t):h.length?Promise.all(h).then(()=>a):a}}),Qi=g("$ZodObjectJIT",(t,n)=>{Xi.init(t,n);const r=t._zod.parse,s=Ot(()=>tr(n)),i=R=>{const A=new bi(["shape","payload","ctx"]),I=s.value,W=p=>{const j=sn(p);return`shape[${j}]._zod.run({ value: input[${j}], issues: [] }, ctx)`};A.write("const input = payload.value;");const D=Object.create(null);let H=0;for(const p of I.keys)D[p]=`key_${H++}`;A.write("const newResult = {};");for(const p of I.keys){const j=D[p],y=sn(p);A.write(`const ${j} = ${W(p)};`),A.write(`
        if (${j}.issues.length) {
          payload.issues = payload.issues.concat(${j}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${y}, ...iss.path] : [${y}]
          })));
        }
        
        
        if (${j}.value === undefined) {
          if (${y} in input) {
            newResult[${y}] = undefined;
          }
        } else {
          newResult[${y}] = ${j}.value;
        }
        
      `)}A.write("payload.value = newResult;"),A.write("return payload;");const f=A.compile();return(p,j)=>f(R,p,j)};let o;const a=ut,l=!Vn.jitless,h=l&&us.value,z=n.catchall;let v;t._zod.parse=(R,A)=>{v??(v=s.value);const I=R.value;return a(I)?l&&h&&A?.async===!1&&A.jitless!==!0?(o||(o=i(n.shape)),R=o(R,A),z?nr([],I,R,A,v,t):R):r(R,A):(R.issues.push({expected:"object",code:"invalid_type",input:I,inst:t}),R)}});function cn(t,n,r,s){for(const o of t)if(o.issues.length===0)return n.value=o.value,n;const i=t.filter(o=>!De(o));return i.length===1?(n.value=i[0].value,i[0]):(n.issues.push({code:"invalid_union",input:n.value,inst:r,errors:t.map(o=>o.issues.map(a=>Ae(a,s,_e())))}),n)}const eo=g("$ZodUnion",(t,n)=>{U.init(t,n),N(t._zod,"optin",()=>n.options.some(i=>i._zod.optin==="optional")?"optional":void 0),N(t._zod,"optout",()=>n.options.some(i=>i._zod.optout==="optional")?"optional":void 0),N(t._zod,"values",()=>{if(n.options.every(i=>i._zod.values))return new Set(n.options.flatMap(i=>Array.from(i._zod.values)))}),N(t._zod,"pattern",()=>{if(n.options.every(i=>i._zod.pattern)){const i=n.options.map(o=>o._zod.pattern);return new RegExp(`^(${i.map(o=>Mt(o.source)).join("|")})$`)}});const r=n.options.length===1,s=n.options[0]._zod.run;t._zod.parse=(i,o)=>{if(r)return s(i,o);let a=!1;const l=[];for(const u of n.options){const h=u._zod.run({value:i.value,issues:[]},o);if(h instanceof Promise)l.push(h),a=!0;else{if(h.issues.length===0)return h;l.push(h)}}return a?Promise.all(l).then(u=>cn(u,i,t,o)):cn(l,i,t,o)}}),to=g("$ZodIntersection",(t,n)=>{U.init(t,n),t._zod.parse=(r,s)=>{const i=r.value,o=n.left._zod.run({value:i,issues:[]},s),a=n.right._zod.run({value:i,issues:[]},s);return o instanceof Promise||a instanceof Promise?Promise.all([o,a]).then(([u,h])=>ln(r,u,h)):ln(r,o,a)}});function Et(t,n){if(t===n)return{valid:!0,data:t};if(t instanceof Date&&n instanceof Date&&+t==+n)return{valid:!0,data:t};if(Ve(t)&&Ve(n)){const r=Object.keys(n),s=Object.keys(t).filter(o=>r.indexOf(o)!==-1),i={...t,...n};for(const o of s){const a=Et(t[o],n[o]);if(!a.valid)return{valid:!1,mergeErrorPath:[o,...a.mergeErrorPath]};i[o]=a.data}return{valid:!0,data:i}}if(Array.isArray(t)&&Array.isArray(n)){if(t.length!==n.length)return{valid:!1,mergeErrorPath:[]};const r=[];for(let s=0;s<t.length;s++){const i=t[s],o=n[s],a=Et(i,o);if(!a.valid)return{valid:!1,mergeErrorPath:[s,...a.mergeErrorPath]};r.push(a.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}function ln(t,n,r){if(n.issues.length&&t.issues.push(...n.issues),r.issues.length&&t.issues.push(...r.issues),De(t))return t;const s=Et(n.value,r.value);if(!s.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(s.mergeErrorPath)}`);return t.value=s.data,t}const no=g("$ZodRecord",(t,n)=>{U.init(t,n),t._zod.parse=(r,s)=>{const i=r.value;if(!Ve(i))return r.issues.push({expected:"record",code:"invalid_type",input:i,inst:t}),r;const o=[];if(n.keyType._zod.values){const a=n.keyType._zod.values;r.value={};for(const u of a)if(typeof u=="string"||typeof u=="number"||typeof u=="symbol"){const h=n.valueType._zod.run({value:i[u],issues:[]},s);h instanceof Promise?o.push(h.then(z=>{z.issues.length&&r.issues.push(...Pe(u,z.issues)),r.value[u]=z.value})):(h.issues.length&&r.issues.push(...Pe(u,h.issues)),r.value[u]=h.value)}let l;for(const u in i)a.has(u)||(l=l??[],l.push(u));l&&l.length>0&&r.issues.push({code:"unrecognized_keys",input:i,inst:t,keys:l})}else{r.value={};for(const a of Reflect.ownKeys(i)){if(a==="__proto__")continue;const l=n.keyType._zod.run({value:a,issues:[]},s);if(l instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(l.issues.length){r.issues.push({code:"invalid_key",origin:"record",issues:l.issues.map(h=>Ae(h,s,_e())),input:a,path:[a],inst:t}),r.value[l.value]=l.value;continue}const u=n.valueType._zod.run({value:i[a],issues:[]},s);u instanceof Promise?o.push(u.then(h=>{h.issues.length&&r.issues.push(...Pe(a,h.issues)),r.value[l.value]=h.value})):(u.issues.length&&r.issues.push(...Pe(a,u.issues)),r.value[l.value]=u.value)}}return o.length?Promise.all(o).then(()=>r):r}}),ro=g("$ZodEnum",(t,n)=>{U.init(t,n);const r=cs(n.entries),s=new Set(r);t._zod.values=s,t._zod.pattern=new RegExp(`^(${r.filter(i=>hs.has(typeof i)).map(i=>typeof i=="string"?gt(i):i.toString()).join("|")})$`),t._zod.parse=(i,o)=>{const a=i.value;return s.has(a)||i.issues.push({code:"invalid_value",values:r,input:a,inst:t}),i}}),so=g("$ZodTransform",(t,n)=>{U.init(t,n),t._zod.parse=(r,s)=>{if(s.direction==="backward")throw new Mn(t.constructor.name);const i=n.transform(r.value,r);if(s.async)return(i instanceof Promise?i:Promise.resolve(i)).then(a=>(r.value=a,r));if(i instanceof Promise)throw new Me;return r.value=i,r}});function dn(t,n){return t.issues.length&&n===void 0?{issues:[],value:void 0}:t}const io=g("$ZodOptional",(t,n)=>{U.init(t,n),t._zod.optin="optional",t._zod.optout="optional",N(t._zod,"values",()=>n.innerType._zod.values?new Set([...n.innerType._zod.values,void 0]):void 0),N(t._zod,"pattern",()=>{const r=n.innerType._zod.pattern;return r?new RegExp(`^(${Mt(r.source)})?$`):void 0}),t._zod.parse=(r,s)=>{if(n.innerType._zod.optin==="optional"){const i=n.innerType._zod.run(r,s);return i instanceof Promise?i.then(o=>dn(o,r.value)):dn(i,r.value)}return r.value===void 0?r:n.innerType._zod.run(r,s)}}),oo=g("$ZodNullable",(t,n)=>{U.init(t,n),N(t._zod,"optin",()=>n.innerType._zod.optin),N(t._zod,"optout",()=>n.innerType._zod.optout),N(t._zod,"pattern",()=>{const r=n.innerType._zod.pattern;return r?new RegExp(`^(${Mt(r.source)}|null)$`):void 0}),N(t._zod,"values",()=>n.innerType._zod.values?new Set([...n.innerType._zod.values,null]):void 0),t._zod.parse=(r,s)=>r.value===null?r:n.innerType._zod.run(r,s)}),ao=g("$ZodDefault",(t,n)=>{U.init(t,n),t._zod.optin="optional",N(t._zod,"values",()=>n.innerType._zod.values),t._zod.parse=(r,s)=>{if(s.direction==="backward")return n.innerType._zod.run(r,s);if(r.value===void 0)return r.value=n.defaultValue,r;const i=n.innerType._zod.run(r,s);return i instanceof Promise?i.then(o=>un(o,n)):un(i,n)}});function un(t,n){return t.value===void 0&&(t.value=n.defaultValue),t}const co=g("$ZodPrefault",(t,n)=>{U.init(t,n),t._zod.optin="optional",N(t._zod,"values",()=>n.innerType._zod.values),t._zod.parse=(r,s)=>(s.direction==="backward"||r.value===void 0&&(r.value=n.defaultValue),n.innerType._zod.run(r,s))}),lo=g("$ZodNonOptional",(t,n)=>{U.init(t,n),N(t._zod,"values",()=>{const r=n.innerType._zod.values;return r?new Set([...r].filter(s=>s!==void 0)):void 0}),t._zod.parse=(r,s)=>{const i=n.innerType._zod.run(r,s);return i instanceof Promise?i.then(o=>hn(o,t)):hn(i,t)}});function hn(t,n){return!t.issues.length&&t.value===void 0&&t.issues.push({code:"invalid_type",expected:"nonoptional",input:t.value,inst:n}),t}const uo=g("$ZodCatch",(t,n)=>{U.init(t,n),N(t._zod,"optin",()=>n.innerType._zod.optin),N(t._zod,"optout",()=>n.innerType._zod.optout),N(t._zod,"values",()=>n.innerType._zod.values),t._zod.parse=(r,s)=>{if(s.direction==="backward")return n.innerType._zod.run(r,s);const i=n.innerType._zod.run(r,s);return i instanceof Promise?i.then(o=>(r.value=o.value,o.issues.length&&(r.value=n.catchValue({...r,error:{issues:o.issues.map(a=>Ae(a,s,_e()))},input:r.value}),r.issues=[]),r)):(r.value=i.value,i.issues.length&&(r.value=n.catchValue({...r,error:{issues:i.issues.map(o=>Ae(o,s,_e()))},input:r.value}),r.issues=[]),r)}}),ho=g("$ZodPipe",(t,n)=>{U.init(t,n),N(t._zod,"values",()=>n.in._zod.values),N(t._zod,"optin",()=>n.in._zod.optin),N(t._zod,"optout",()=>n.out._zod.optout),N(t._zod,"propValues",()=>n.in._zod.propValues),t._zod.parse=(r,s)=>{if(s.direction==="backward"){const o=n.out._zod.run(r,s);return o instanceof Promise?o.then(a=>rt(a,n.in,s)):rt(o,n.in,s)}const i=n.in._zod.run(r,s);return i instanceof Promise?i.then(o=>rt(o,n.out,s)):rt(i,n.out,s)}});function rt(t,n,r){return t.issues.length?(t.aborted=!0,t):n._zod.run({value:t.value,issues:t.issues},r)}const po=g("$ZodReadonly",(t,n)=>{U.init(t,n),N(t._zod,"propValues",()=>n.innerType._zod.propValues),N(t._zod,"values",()=>n.innerType._zod.values),N(t._zod,"optin",()=>n.innerType._zod.optin),N(t._zod,"optout",()=>n.innerType._zod.optout),t._zod.parse=(r,s)=>{if(s.direction==="backward")return n.innerType._zod.run(r,s);const i=n.innerType._zod.run(r,s);return i instanceof Promise?i.then(pn):pn(i)}});function pn(t){return t.value=Object.freeze(t.value),t}const mo=g("$ZodCustom",(t,n)=>{ce.init(t,n),U.init(t,n),t._zod.parse=(r,s)=>r,t._zod.check=r=>{const s=r.value,i=n.fn(s);if(i instanceof Promise)return i.then(o=>mn(o,r,s,t));mn(i,r,s,t)}});function mn(t,n,r,s){if(!t){const i={code:"custom",input:r,inst:s,path:[...s._zod.def.path??[]],continue:!s._zod.def.abort};s._zod.def.params&&(i.params=s._zod.def.params),n.issues.push(He(i))}}class go{constructor(){this._map=new WeakMap,this._idmap=new Map}add(n,...r){const s=r[0];if(this._map.set(n,s),s&&typeof s=="object"&&"id"in s){if(this._idmap.has(s.id))throw new Error(`ID ${s.id} already exists in the registry`);this._idmap.set(s.id,n)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(n){const r=this._map.get(n);return r&&typeof r=="object"&&"id"in r&&this._idmap.delete(r.id),this._map.delete(n),this}get(n){const r=n._zod.parent;if(r){const s={...this.get(r)??{}};delete s.id;const i={...s,...this._map.get(n)};return Object.keys(i).length?i:void 0}return this._map.get(n)}has(n){return this._map.has(n)}}function fo(){return new go}const st=fo();function xo(t,n){return new t({type:"string",..._(n)})}function rr(t,n){return new t({type:"string",format:"email",check:"string_format",abort:!1,..._(n)})}function gn(t,n){return new t({type:"string",format:"guid",check:"string_format",abort:!1,..._(n)})}function jo(t,n){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,..._(n)})}function bo(t,n){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",..._(n)})}function yo(t,n){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",..._(n)})}function vo(t,n){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",..._(n)})}function So(t,n){return new t({type:"string",format:"url",check:"string_format",abort:!1,..._(n)})}function wo(t,n){return new t({type:"string",format:"emoji",check:"string_format",abort:!1,..._(n)})}function zo(t,n){return new t({type:"string",format:"nanoid",check:"string_format",abort:!1,..._(n)})}function ko(t,n){return new t({type:"string",format:"cuid",check:"string_format",abort:!1,..._(n)})}function _o(t,n){return new t({type:"string",format:"cuid2",check:"string_format",abort:!1,..._(n)})}function Ao(t,n){return new t({type:"string",format:"ulid",check:"string_format",abort:!1,..._(n)})}function Co(t,n){return new t({type:"string",format:"xid",check:"string_format",abort:!1,..._(n)})}function Fo(t,n){return new t({type:"string",format:"ksuid",check:"string_format",abort:!1,..._(n)})}function To(t,n){return new t({type:"string",format:"ipv4",check:"string_format",abort:!1,..._(n)})}function Eo(t,n){return new t({type:"string",format:"ipv6",check:"string_format",abort:!1,..._(n)})}function $o(t,n){return new t({type:"string",format:"cidrv4",check:"string_format",abort:!1,..._(n)})}function Io(t,n){return new t({type:"string",format:"cidrv6",check:"string_format",abort:!1,..._(n)})}function Zo(t,n){return new t({type:"string",format:"base64",check:"string_format",abort:!1,..._(n)})}function Ro(t,n){return new t({type:"string",format:"base64url",check:"string_format",abort:!1,..._(n)})}function Do(t,n){return new t({type:"string",format:"e164",check:"string_format",abort:!1,..._(n)})}function Po(t,n){return new t({type:"string",format:"jwt",check:"string_format",abort:!1,..._(n)})}function Oo(t,n){return new t({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,..._(n)})}function No(t,n){return new t({type:"string",format:"date",check:"string_format",..._(n)})}function Mo(t,n){return new t({type:"string",format:"time",check:"string_format",precision:null,..._(n)})}function Vo(t,n){return new t({type:"string",format:"duration",check:"string_format",..._(n)})}function Lo(t,n){return new t({type:"number",checks:[],..._(n)})}function Wo(t,n){return new t({type:"number",check:"number_format",abort:!1,format:"safeint",..._(n)})}function Uo(t,n){return new t({type:"boolean",..._(n)})}function Bo(t){return new t({type:"unknown"})}function Ho(t,n){return new t({type:"never",..._(n)})}function qo(t,n){return new t({type:"date",..._(n)})}function fn(t,n){return new Kn({check:"less_than",..._(n),value:t,inclusive:!1})}function at(t,n){return new Kn({check:"less_than",..._(n),value:t,inclusive:!0})}function xn(t,n){return new Xn({check:"greater_than",..._(n),value:t,inclusive:!1})}function ct(t,n){return new Xn({check:"greater_than",..._(n),value:t,inclusive:!0})}function jn(t,n){return new ai({check:"multiple_of",..._(n),value:t})}function sr(t,n){return new li({check:"max_length",..._(n),maximum:t})}function pt(t,n){return new di({check:"min_length",..._(n),minimum:t})}function ir(t,n){return new ui({check:"length_equals",..._(n),length:t})}function Go(t,n){return new hi({check:"string_format",format:"regex",..._(n),pattern:t})}function Jo(t){return new pi({check:"string_format",format:"lowercase",..._(t)})}function Yo(t){return new mi({check:"string_format",format:"uppercase",..._(t)})}function Ko(t,n){return new gi({check:"string_format",format:"includes",..._(n),includes:t})}function Xo(t,n){return new fi({check:"string_format",format:"starts_with",..._(n),prefix:t})}function Qo(t,n){return new xi({check:"string_format",format:"ends_with",..._(n),suffix:t})}function Ge(t){return new ji({check:"overwrite",tx:t})}function ea(t){return Ge(n=>n.normalize(t))}function ta(){return Ge(t=>t.trim())}function na(){return Ge(t=>t.toLowerCase())}function ra(){return Ge(t=>t.toUpperCase())}function sa(t,n,r){return new t({type:"array",element:n,..._(r)})}function ia(t,n,r){return new t({type:"custom",check:"custom",fn:n,..._(r)})}function oa(t){const n=aa(r=>(r.addIssue=s=>{if(typeof s=="string")r.issues.push(He(s,r.value,n._zod.def));else{const i=s;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=r.value),i.inst??(i.inst=n),i.continue??(i.continue=!n._zod.def.abort),r.issues.push(He(i))}},t(r.value,r)));return n}function aa(t,n){const r=new ce({check:"custom",..._(n)});return r._zod.check=t,r}const ca=g("ZodISODateTime",(t,n)=>{$i.init(t,n),B.init(t,n)});function la(t){return Oo(ca,t)}const da=g("ZodISODate",(t,n)=>{Ii.init(t,n),B.init(t,n)});function ua(t){return No(da,t)}const ha=g("ZodISOTime",(t,n)=>{Zi.init(t,n),B.init(t,n)});function pa(t){return Mo(ha,t)}const ma=g("ZodISODuration",(t,n)=>{Ri.init(t,n),B.init(t,n)});function ga(t){return Vo(ma,t)}const fa=(t,n)=>{Bn.init(t,n),t.name="ZodError",Object.defineProperties(t,{format:{value:r=>ws(t,r)},flatten:{value:r=>Ss(t,r)},addIssue:{value:r=>{t.issues.push(r),t.message=JSON.stringify(t.issues,Tt,2)}},addIssues:{value:r=>{t.issues.push(...r),t.message=JSON.stringify(t.issues,Tt,2)}},isEmpty:{get(){return t.issues.length===0}}})},me=g("ZodError",fa,{Parent:Error}),xa=Lt(me),ja=Wt(me),ba=ft(me),ya=xt(me),va=_s(me),Sa=As(me),wa=Cs(me),za=Fs(me),ka=Ts(me),_a=Es(me),Aa=$s(me),Ca=Is(me),J=g("ZodType",(t,n)=>(U.init(t,n),t.def=n,t.type=n.type,Object.defineProperty(t,"_def",{value:n}),t.check=(...r)=>t.clone({...n,checks:[...n.checks??[],...r.map(s=>typeof s=="function"?{_zod:{check:s,def:{check:"custom"},onattach:[]}}:s)]}),t.clone=(r,s)=>Fe(t,r,s),t.brand=()=>t,t.register=((r,s)=>(r.add(t,s),t)),t.parse=(r,s)=>xa(t,r,s,{callee:t.parse}),t.safeParse=(r,s)=>ba(t,r,s),t.parseAsync=async(r,s)=>ja(t,r,s,{callee:t.parseAsync}),t.safeParseAsync=async(r,s)=>ya(t,r,s),t.spa=t.safeParseAsync,t.encode=(r,s)=>va(t,r,s),t.decode=(r,s)=>Sa(t,r,s),t.encodeAsync=async(r,s)=>wa(t,r,s),t.decodeAsync=async(r,s)=>za(t,r,s),t.safeEncode=(r,s)=>ka(t,r,s),t.safeDecode=(r,s)=>_a(t,r,s),t.safeEncodeAsync=async(r,s)=>Aa(t,r,s),t.safeDecodeAsync=async(r,s)=>Ca(t,r,s),t.refine=(r,s)=>t.check(vc(r,s)),t.superRefine=r=>t.check(Sc(r)),t.overwrite=r=>t.check(Ge(r)),t.optional=()=>Sn(t),t.nullable=()=>wn(t),t.nullish=()=>Sn(wn(t)),t.nonoptional=r=>mc(t,r),t.array=()=>Je(t),t.or=r=>rc([t,r]),t.and=r=>ic(t,r),t.transform=r=>zn(t,cc(r)),t.default=r=>uc(t,r),t.prefault=r=>pc(t,r),t.catch=r=>fc(t,r),t.pipe=r=>zn(t,r),t.readonly=()=>bc(t),t.describe=r=>{const s=t.clone();return st.add(s,{description:r}),s},Object.defineProperty(t,"description",{get(){return st.get(t)?.description},configurable:!0}),t.meta=(...r)=>{if(r.length===0)return st.get(t);const s=t.clone();return st.add(s,r[0]),s},t.isOptional=()=>t.safeParse(void 0).success,t.isNullable=()=>t.safeParse(null).success,t)),or=g("_ZodString",(t,n)=>{Ut.init(t,n),J.init(t,n);const r=t._zod.bag;t.format=r.format??null,t.minLength=r.minimum??null,t.maxLength=r.maximum??null,t.regex=(...s)=>t.check(Go(...s)),t.includes=(...s)=>t.check(Ko(...s)),t.startsWith=(...s)=>t.check(Xo(...s)),t.endsWith=(...s)=>t.check(Qo(...s)),t.min=(...s)=>t.check(pt(...s)),t.max=(...s)=>t.check(sr(...s)),t.length=(...s)=>t.check(ir(...s)),t.nonempty=(...s)=>t.check(pt(1,...s)),t.lowercase=s=>t.check(Jo(s)),t.uppercase=s=>t.check(Yo(s)),t.trim=()=>t.check(ta()),t.normalize=(...s)=>t.check(ea(...s)),t.toLowerCase=()=>t.check(na()),t.toUpperCase=()=>t.check(ra())}),Fa=g("ZodString",(t,n)=>{Ut.init(t,n),or.init(t,n),t.email=r=>t.check(rr(ar,r)),t.url=r=>t.check(So(Ea,r)),t.jwt=r=>t.check(Po(Ha,r)),t.emoji=r=>t.check(wo($a,r)),t.guid=r=>t.check(gn(bn,r)),t.uuid=r=>t.check(jo(it,r)),t.uuidv4=r=>t.check(bo(it,r)),t.uuidv6=r=>t.check(yo(it,r)),t.uuidv7=r=>t.check(vo(it,r)),t.nanoid=r=>t.check(zo(Ia,r)),t.guid=r=>t.check(gn(bn,r)),t.cuid=r=>t.check(ko(Za,r)),t.cuid2=r=>t.check(_o(Ra,r)),t.ulid=r=>t.check(Ao(Da,r)),t.base64=r=>t.check(Zo(Wa,r)),t.base64url=r=>t.check(Ro(Ua,r)),t.xid=r=>t.check(Co(Pa,r)),t.ksuid=r=>t.check(Fo(Oa,r)),t.ipv4=r=>t.check(To(Na,r)),t.ipv6=r=>t.check(Eo(Ma,r)),t.cidrv4=r=>t.check($o(Va,r)),t.cidrv6=r=>t.check(Io(La,r)),t.e164=r=>t.check(Do(Ba,r)),t.datetime=r=>t.check(la(r)),t.date=r=>t.check(ua(r)),t.time=r=>t.check(pa(r)),t.duration=r=>t.check(ga(r))});function P(t){return xo(Fa,t)}const B=g("ZodStringFormat",(t,n)=>{L.init(t,n),or.init(t,n)}),ar=g("ZodEmail",(t,n)=>{wi.init(t,n),B.init(t,n)});function Ta(t){return rr(ar,t)}const bn=g("ZodGUID",(t,n)=>{vi.init(t,n),B.init(t,n)}),it=g("ZodUUID",(t,n)=>{Si.init(t,n),B.init(t,n)}),Ea=g("ZodURL",(t,n)=>{zi.init(t,n),B.init(t,n)}),$a=g("ZodEmoji",(t,n)=>{ki.init(t,n),B.init(t,n)}),Ia=g("ZodNanoID",(t,n)=>{_i.init(t,n),B.init(t,n)}),Za=g("ZodCUID",(t,n)=>{Ai.init(t,n),B.init(t,n)}),Ra=g("ZodCUID2",(t,n)=>{Ci.init(t,n),B.init(t,n)}),Da=g("ZodULID",(t,n)=>{Fi.init(t,n),B.init(t,n)}),Pa=g("ZodXID",(t,n)=>{Ti.init(t,n),B.init(t,n)}),Oa=g("ZodKSUID",(t,n)=>{Ei.init(t,n),B.init(t,n)}),Na=g("ZodIPv4",(t,n)=>{Di.init(t,n),B.init(t,n)}),Ma=g("ZodIPv6",(t,n)=>{Pi.init(t,n),B.init(t,n)}),Va=g("ZodCIDRv4",(t,n)=>{Oi.init(t,n),B.init(t,n)}),La=g("ZodCIDRv6",(t,n)=>{Ni.init(t,n),B.init(t,n)}),Wa=g("ZodBase64",(t,n)=>{Mi.init(t,n),B.init(t,n)}),Ua=g("ZodBase64URL",(t,n)=>{Li.init(t,n),B.init(t,n)}),Ba=g("ZodE164",(t,n)=>{Wi.init(t,n),B.init(t,n)}),Ha=g("ZodJWT",(t,n)=>{Bi.init(t,n),B.init(t,n)}),cr=g("ZodNumber",(t,n)=>{er.init(t,n),J.init(t,n),t.gt=(s,i)=>t.check(xn(s,i)),t.gte=(s,i)=>t.check(ct(s,i)),t.min=(s,i)=>t.check(ct(s,i)),t.lt=(s,i)=>t.check(fn(s,i)),t.lte=(s,i)=>t.check(at(s,i)),t.max=(s,i)=>t.check(at(s,i)),t.int=s=>t.check(yn(s)),t.safe=s=>t.check(yn(s)),t.positive=s=>t.check(xn(0,s)),t.nonnegative=s=>t.check(ct(0,s)),t.negative=s=>t.check(fn(0,s)),t.nonpositive=s=>t.check(at(0,s)),t.multipleOf=(s,i)=>t.check(jn(s,i)),t.step=(s,i)=>t.check(jn(s,i)),t.finite=()=>t;const r=t._zod.bag;t.minValue=Math.max(r.minimum??Number.NEGATIVE_INFINITY,r.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,t.maxValue=Math.min(r.maximum??Number.POSITIVE_INFINITY,r.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,t.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),t.isFinite=!0,t.format=r.format??null});function ue(t){return Lo(cr,t)}const qa=g("ZodNumberFormat",(t,n)=>{Hi.init(t,n),cr.init(t,n)});function yn(t){return Wo(qa,t)}const Ga=g("ZodBoolean",(t,n)=>{qi.init(t,n),J.init(t,n)});function oe(t){return Uo(Ga,t)}const Ja=g("ZodUnknown",(t,n)=>{Gi.init(t,n),J.init(t,n)});function vn(){return Bo(Ja)}const Ya=g("ZodNever",(t,n)=>{Ji.init(t,n),J.init(t,n)});function Ka(t){return Ho(Ya,t)}const Xa=g("ZodDate",(t,n)=>{Yi.init(t,n),J.init(t,n),t.min=(s,i)=>t.check(ct(s,i)),t.max=(s,i)=>t.check(at(s,i));const r=t._zod.bag;t.minDate=r.minimum?new Date(r.minimum):null,t.maxDate=r.maximum?new Date(r.maximum):null});function Qa(t){return qo(Xa,t)}const ec=g("ZodArray",(t,n)=>{Ki.init(t,n),J.init(t,n),t.element=n.element,t.min=(r,s)=>t.check(pt(r,s)),t.nonempty=r=>t.check(pt(1,r)),t.max=(r,s)=>t.check(sr(r,s)),t.length=(r,s)=>t.check(ir(r,s)),t.unwrap=()=>t.element});function Je(t,n){return sa(ec,t,n)}const tc=g("ZodObject",(t,n)=>{Qi.init(t,n),J.init(t,n),N(t,"shape",()=>n.shape),t.keyof=()=>qe(Object.keys(t._zod.def.shape)),t.catchall=r=>t.clone({...t._zod.def,catchall:r}),t.passthrough=()=>t.clone({...t._zod.def,catchall:vn()}),t.loose=()=>t.clone({...t._zod.def,catchall:vn()}),t.strict=()=>t.clone({...t._zod.def,catchall:Ka()}),t.strip=()=>t.clone({...t._zod.def,catchall:void 0}),t.extend=r=>xs(t,r),t.safeExtend=r=>js(t,r),t.merge=r=>bs(t,r),t.pick=r=>gs(t,r),t.omit=r=>fs(t,r),t.partial=(...r)=>ys(lr,t,r[0]),t.required=(...r)=>vs(dr,t,r[0])});function ge(t,n){const r={type:"object",get shape(){return Ce(this,"shape",t?ds(t):{}),this.shape},..._(n)};return new tc(r)}const nc=g("ZodUnion",(t,n)=>{eo.init(t,n),J.init(t,n),t.options=n.options});function rc(t,n){return new nc({type:"union",options:t,..._(n)})}const sc=g("ZodIntersection",(t,n)=>{to.init(t,n),J.init(t,n)});function ic(t,n){return new sc({type:"intersection",left:t,right:n})}const oc=g("ZodRecord",(t,n)=>{no.init(t,n),J.init(t,n),t.keyType=n.keyType,t.valueType=n.valueType});function _t(t,n,r){return new oc({type:"record",keyType:t,valueType:n,..._(r)})}const $t=g("ZodEnum",(t,n)=>{ro.init(t,n),J.init(t,n),t.enum=n.entries,t.options=Object.values(n.entries);const r=new Set(Object.keys(n.entries));t.extract=(s,i)=>{const o={};for(const a of s)if(r.has(a))o[a]=n.entries[a];else throw new Error(`Key ${a} not found in enum`);return new $t({...n,checks:[],..._(i),entries:o})},t.exclude=(s,i)=>{const o={...n.entries};for(const a of s)if(r.has(a))delete o[a];else throw new Error(`Key ${a} not found in enum`);return new $t({...n,checks:[],..._(i),entries:o})}});function qe(t,n){const r=Array.isArray(t)?Object.fromEntries(t.map(s=>[s,s])):t;return new $t({type:"enum",entries:r,..._(n)})}const ac=g("ZodTransform",(t,n)=>{so.init(t,n),J.init(t,n),t._zod.parse=(r,s)=>{if(s.direction==="backward")throw new Mn(t.constructor.name);r.addIssue=o=>{if(typeof o=="string")r.issues.push(He(o,r.value,n));else{const a=o;a.fatal&&(a.continue=!1),a.code??(a.code="custom"),a.input??(a.input=r.value),a.inst??(a.inst=t),r.issues.push(He(a))}};const i=n.transform(r.value,r);return i instanceof Promise?i.then(o=>(r.value=o,r)):(r.value=i,r)}});function cc(t){return new ac({type:"transform",transform:t})}const lr=g("ZodOptional",(t,n)=>{io.init(t,n),J.init(t,n),t.unwrap=()=>t._zod.def.innerType});function Sn(t){return new lr({type:"optional",innerType:t})}const lc=g("ZodNullable",(t,n)=>{oo.init(t,n),J.init(t,n),t.unwrap=()=>t._zod.def.innerType});function wn(t){return new lc({type:"nullable",innerType:t})}const dc=g("ZodDefault",(t,n)=>{ao.init(t,n),J.init(t,n),t.unwrap=()=>t._zod.def.innerType,t.removeDefault=t.unwrap});function uc(t,n){return new dc({type:"default",innerType:t,get defaultValue(){return typeof n=="function"?n():Wn(n)}})}const hc=g("ZodPrefault",(t,n)=>{co.init(t,n),J.init(t,n),t.unwrap=()=>t._zod.def.innerType});function pc(t,n){return new hc({type:"prefault",innerType:t,get defaultValue(){return typeof n=="function"?n():Wn(n)}})}const dr=g("ZodNonOptional",(t,n)=>{lo.init(t,n),J.init(t,n),t.unwrap=()=>t._zod.def.innerType});function mc(t,n){return new dr({type:"nonoptional",innerType:t,..._(n)})}const gc=g("ZodCatch",(t,n)=>{uo.init(t,n),J.init(t,n),t.unwrap=()=>t._zod.def.innerType,t.removeCatch=t.unwrap});function fc(t,n){return new gc({type:"catch",innerType:t,catchValue:typeof n=="function"?n:()=>n})}const xc=g("ZodPipe",(t,n)=>{ho.init(t,n),J.init(t,n),t.in=n.in,t.out=n.out});function zn(t,n){return new xc({type:"pipe",in:t,out:n})}const jc=g("ZodReadonly",(t,n)=>{po.init(t,n),J.init(t,n),t.unwrap=()=>t._zod.def.innerType});function bc(t){return new jc({type:"readonly",innerType:t})}const yc=g("ZodCustom",(t,n)=>{mo.init(t,n),J.init(t,n)});function vc(t,n={}){return ia(yc,t,n)}function Sc(t){return oa(t)}var At={exports:{}},kn;function wc(){return kn||(kn=1,(function(t){var n=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var r=(function(s){var i=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,o=0,a={},l={manual:s.Prism&&s.Prism.manual,disableWorkerMessageHandler:s.Prism&&s.Prism.disableWorkerMessageHandler,util:{encode:function f(p){return p instanceof u?new u(p.type,f(p.content),p.alias):Array.isArray(p)?p.map(f):p.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(f){return Object.prototype.toString.call(f).slice(8,-1)},objId:function(f){return f.__id||Object.defineProperty(f,"__id",{value:++o}),f.__id},clone:function f(p,j){j=j||{};var y,S;switch(l.util.type(p)){case"Object":if(S=l.util.objId(p),j[S])return j[S];y={},j[S]=y;for(var E in p)p.hasOwnProperty(E)&&(y[E]=f(p[E],j));return y;case"Array":return S=l.util.objId(p),j[S]?j[S]:(y=[],j[S]=y,p.forEach(function(Z,T){y[T]=f(Z,j)}),y);default:return p}},getLanguage:function(f){for(;f;){var p=i.exec(f.className);if(p)return p[1].toLowerCase();f=f.parentElement}return"none"},setLanguage:function(f,p){f.className=f.className.replace(RegExp(i,"gi"),""),f.classList.add("language-"+p)},currentScript:function(){if(typeof document>"u")return null;if(document.currentScript&&document.currentScript.tagName==="SCRIPT")return document.currentScript;try{throw new Error}catch(y){var f=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(y.stack)||[])[1];if(f){var p=document.getElementsByTagName("script");for(var j in p)if(p[j].src==f)return p[j]}return null}},isActive:function(f,p,j){for(var y="no-"+p;f;){var S=f.classList;if(S.contains(p))return!0;if(S.contains(y))return!1;f=f.parentElement}return!!j}},languages:{plain:a,plaintext:a,text:a,txt:a,extend:function(f,p){var j=l.util.clone(l.languages[f]);for(var y in p)j[y]=p[y];return j},insertBefore:function(f,p,j,y){y=y||l.languages;var S=y[f],E={};for(var Z in S)if(S.hasOwnProperty(Z)){if(Z==p)for(var T in j)j.hasOwnProperty(T)&&(E[T]=j[T]);j.hasOwnProperty(Z)||(E[Z]=S[Z])}var q=y[f];return y[f]=E,l.languages.DFS(l.languages,function(te,we){we===q&&te!=f&&(this[te]=E)}),E},DFS:function f(p,j,y,S){S=S||{};var E=l.util.objId;for(var Z in p)if(p.hasOwnProperty(Z)){j.call(p,Z,p[Z],y||Z);var T=p[Z],q=l.util.type(T);q==="Object"&&!S[E(T)]?(S[E(T)]=!0,f(T,j,null,S)):q==="Array"&&!S[E(T)]&&(S[E(T)]=!0,f(T,j,Z,S))}}},plugins:{},highlightAll:function(f,p){l.highlightAllUnder(document,f,p)},highlightAllUnder:function(f,p,j){var y={callback:j,container:f,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};l.hooks.run("before-highlightall",y),y.elements=Array.prototype.slice.apply(y.container.querySelectorAll(y.selector)),l.hooks.run("before-all-elements-highlight",y);for(var S=0,E;E=y.elements[S++];)l.highlightElement(E,p===!0,y.callback)},highlightElement:function(f,p,j){var y=l.util.getLanguage(f),S=l.languages[y];l.util.setLanguage(f,y);var E=f.parentElement;E&&E.nodeName.toLowerCase()==="pre"&&l.util.setLanguage(E,y);var Z=f.textContent,T={element:f,language:y,grammar:S,code:Z};function q(we){T.highlightedCode=we,l.hooks.run("before-insert",T),T.element.innerHTML=T.highlightedCode,l.hooks.run("after-highlight",T),l.hooks.run("complete",T),j&&j.call(T.element)}if(l.hooks.run("before-sanity-check",T),E=T.element.parentElement,E&&E.nodeName.toLowerCase()==="pre"&&!E.hasAttribute("tabindex")&&E.setAttribute("tabindex","0"),!T.code){l.hooks.run("complete",T),j&&j.call(T.element);return}if(l.hooks.run("before-highlight",T),!T.grammar){q(l.util.encode(T.code));return}if(p&&s.Worker){var te=new Worker(l.filename);te.onmessage=function(we){q(we.data)},te.postMessage(JSON.stringify({language:T.language,code:T.code,immediateClose:!0}))}else q(l.highlight(T.code,T.grammar,T.language))},highlight:function(f,p,j){var y={code:f,grammar:p,language:j};if(l.hooks.run("before-tokenize",y),!y.grammar)throw new Error('The language "'+y.language+'" has no grammar.');return y.tokens=l.tokenize(y.code,y.grammar),l.hooks.run("after-tokenize",y),u.stringify(l.util.encode(y.tokens),y.language)},tokenize:function(f,p){var j=p.rest;if(j){for(var y in j)p[y]=j[y];delete p.rest}var S=new v;return R(S,S.head,f),z(f,S,p,S.head,0),I(S)},hooks:{all:{},add:function(f,p){var j=l.hooks.all;j[f]=j[f]||[],j[f].push(p)},run:function(f,p){var j=l.hooks.all[f];if(!(!j||!j.length))for(var y=0,S;S=j[y++];)S(p)}},Token:u};s.Prism=l;function u(f,p,j,y){this.type=f,this.content=p,this.alias=j,this.length=(y||"").length|0}u.stringify=function f(p,j){if(typeof p=="string")return p;if(Array.isArray(p)){var y="";return p.forEach(function(q){y+=f(q,j)}),y}var S={type:p.type,content:f(p.content,j),tag:"span",classes:["token",p.type],attributes:{},language:j},E=p.alias;E&&(Array.isArray(E)?Array.prototype.push.apply(S.classes,E):S.classes.push(E)),l.hooks.run("wrap",S);var Z="";for(var T in S.attributes)Z+=" "+T+'="'+(S.attributes[T]||"").replace(/"/g,"&quot;")+'"';return"<"+S.tag+' class="'+S.classes.join(" ")+'"'+Z+">"+S.content+"</"+S.tag+">"};function h(f,p,j,y){f.lastIndex=p;var S=f.exec(j);if(S&&y&&S[1]){var E=S[1].length;S.index+=E,S[0]=S[0].slice(E)}return S}function z(f,p,j,y,S,E){for(var Z in j)if(!(!j.hasOwnProperty(Z)||!j[Z])){var T=j[Z];T=Array.isArray(T)?T:[T];for(var q=0;q<T.length;++q){if(E&&E.cause==Z+","+q)return;var te=T[q],we=te.inside,Gt=!!te.lookbehind,Jt=!!te.greedy,jr=te.alias;if(Jt&&!te.pattern.global){var br=te.pattern.toString().match(/[imsuy]*$/)[0];te.pattern=RegExp(te.pattern.source,br+"g")}for(var Yt=te.pattern||te,ne=y.next,xe=S;ne!==p.tail&&!(E&&xe>=E.reach);xe+=ne.value.length,ne=ne.next){var Re=ne.value;if(p.length>f.length)return;if(!(Re instanceof u)){var Ye=1,fe;if(Jt){if(fe=h(Yt,xe,f,Gt),!fe||fe.index>=f.length)break;var Ke=fe.index,yr=fe.index+fe[0].length,ze=xe;for(ze+=ne.value.length;Ke>=ze;)ne=ne.next,ze+=ne.value.length;if(ze-=ne.value.length,xe=ze,ne.value instanceof u)continue;for(var We=ne;We!==p.tail&&(ze<yr||typeof We.value=="string");We=We.next)Ye++,ze+=We.value.length;Ye--,Re=f.slice(xe,ze),fe.index-=xe}else if(fe=h(Yt,0,Re,Gt),!fe)continue;var Ke=fe.index,Xe=fe[0],bt=Re.slice(0,Ke),Kt=Re.slice(Ke+Xe.length),yt=xe+Re.length;E&&yt>E.reach&&(E.reach=yt);var Qe=ne.prev;bt&&(Qe=R(p,Qe,bt),xe+=bt.length),A(p,Qe,Ye);var vr=new u(Z,we?l.tokenize(Xe,we):Xe,jr,Xe);if(ne=R(p,Qe,vr),Kt&&R(p,ne,Kt),Ye>1){var vt={cause:Z+","+q,reach:yt};z(f,p,j,ne.prev,xe,vt),E&&vt.reach>E.reach&&(E.reach=vt.reach)}}}}}}function v(){var f={value:null,prev:null,next:null},p={value:null,prev:f,next:null};f.next=p,this.head=f,this.tail=p,this.length=0}function R(f,p,j){var y=p.next,S={value:j,prev:p,next:y};return p.next=S,y.prev=S,f.length++,S}function A(f,p,j){for(var y=p.next,S=0;S<j&&y!==f.tail;S++)y=y.next;p.next=y,y.prev=p,f.length-=S}function I(f){for(var p=[],j=f.head.next;j!==f.tail;)p.push(j.value),j=j.next;return p}if(!s.document)return s.addEventListener&&(l.disableWorkerMessageHandler||s.addEventListener("message",function(f){var p=JSON.parse(f.data),j=p.language,y=p.code,S=p.immediateClose;s.postMessage(l.highlight(y,l.languages[j],j)),S&&s.close()},!1)),l;var W=l.util.currentScript();W&&(l.filename=W.src,W.hasAttribute("data-manual")&&(l.manual=!0));function D(){l.manual||l.highlightAll()}if(!l.manual){var H=document.readyState;H==="loading"||H==="interactive"&&W&&W.defer?document.addEventListener("DOMContentLoaded",D):window.requestAnimationFrame?window.requestAnimationFrame(D):window.setTimeout(D,16)}return l})(n);t.exports&&(t.exports=r),typeof Qt<"u"&&(Qt.Prism=r),r.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},r.languages.markup.tag.inside["attr-value"].inside.entity=r.languages.markup.entity,r.languages.markup.doctype.inside["internal-subset"].inside=r.languages.markup,r.hooks.add("wrap",function(s){s.type==="entity"&&(s.attributes.title=s.content.replace(/&amp;/,"&"))}),Object.defineProperty(r.languages.markup.tag,"addInlined",{value:function(i,o){var a={};a["language-"+o]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:r.languages[o]},a.cdata=/^<!\[CDATA\[|\]\]>$/i;var l={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:a}};l["language-"+o]={pattern:/[\s\S]+/,inside:r.languages[o]};var u={};u[i]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return i}),"i"),lookbehind:!0,greedy:!0,inside:l},r.languages.insertBefore("markup","cdata",u)}}),Object.defineProperty(r.languages.markup.tag,"addAttribute",{value:function(s,i){r.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+s+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[i,"language-"+i],inside:r.languages[i]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),r.languages.html=r.languages.markup,r.languages.mathml=r.languages.markup,r.languages.svg=r.languages.markup,r.languages.xml=r.languages.extend("markup",{}),r.languages.ssml=r.languages.xml,r.languages.atom=r.languages.xml,r.languages.rss=r.languages.xml,(function(s){var i=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;s.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+i.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+i.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+i.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+i.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:i,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},s.languages.css.atrule.inside.rest=s.languages.css;var o=s.languages.markup;o&&(o.tag.addInlined("style","css"),o.tag.addAttribute("style","css"))})(r),r.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},r.languages.javascript=r.languages.extend("clike",{"class-name":[r.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),r.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,r.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:r.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:r.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:r.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:r.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:r.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),r.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:r.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),r.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),r.languages.markup&&(r.languages.markup.tag.addInlined("script","javascript"),r.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),r.languages.js=r.languages.javascript,(function(){if(typeof r>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var s="Loading…",i=function(W,D){return"✖ Error "+W+" while fetching file: "+D},o="✖ Error: File does not exist or is empty",a={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},l="data-src-status",u="loading",h="loaded",z="failed",v="pre[data-src]:not(["+l+'="'+h+'"]):not(['+l+'="'+u+'"])';function R(W,D,H){var f=new XMLHttpRequest;f.open("GET",W,!0),f.onreadystatechange=function(){f.readyState==4&&(f.status<400&&f.responseText?D(f.responseText):f.status>=400?H(i(f.status,f.statusText)):H(o))},f.send(null)}function A(W){var D=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(W||"");if(D){var H=Number(D[1]),f=D[2],p=D[3];return f?p?[H,Number(p)]:[H,void 0]:[H,H]}}r.hooks.add("before-highlightall",function(W){W.selector+=", "+v}),r.hooks.add("before-sanity-check",function(W){var D=W.element;if(D.matches(v)){W.code="",D.setAttribute(l,u);var H=D.appendChild(document.createElement("CODE"));H.textContent=s;var f=D.getAttribute("data-src"),p=W.language;if(p==="none"){var j=(/\.(\w+)$/.exec(f)||[,"none"])[1];p=a[j]||j}r.util.setLanguage(H,p),r.util.setLanguage(D,p);var y=r.plugins.autoloader;y&&y.loadLanguages(p),R(f,function(S){D.setAttribute(l,h);var E=A(D.getAttribute("data-range"));if(E){var Z=S.split(/\r\n?|\n/g),T=E[0],q=E[1]==null?Z.length:E[1];T<0&&(T+=Z.length),T=Math.max(0,Math.min(T-1,Z.length)),q<0&&(q+=Z.length),q=Math.max(0,Math.min(q,Z.length)),S=Z.slice(T,q).join(`
`),D.hasAttribute("data-start")||D.setAttribute("data-start",String(T+1))}H.textContent=S,r.highlightElement(H)},function(S){D.setAttribute(l,z),H.textContent=S})}}),r.plugins.fileHighlight={highlight:function(D){for(var H=(D||document).querySelectorAll(v),f=0,p;p=H[f++];)r.highlightElement(p)}};var I=!1;r.fileHighlight=function(){I||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),I=!0),r.plugins.fileHighlight.highlight.apply(this,arguments)}})()})(At)),At.exports}var zc=wc();const ur=Pn(zc),kc=ge({content:P(),imports:P(),mainContent:P(),language:P(),title:P().optional(),snippetName:P().optional(),folder:P().optional(),showImportsToggle:oe(),showCopyButton:oe(),showExpandButton:oe(),maxHeight:P(),isExpanded:oe(),isImportsExpanded:oe(),needsExpansion:oe(),enableDOMObservation:oe(),enablePrismHighlighting:oe(),loading:oe(),error:P().nullable()});class _c extends he{contentRef=null;codeRef=null;resizeObserver=null;mutationObserver=null;resizing=!1;constructor(n){if(!(n.snippetName&&n.language))throw console.log("bad config:",n),new Error("bad Config on CodePanel");super({name:"code-panel",schema:kc,value:{language:n.language,title:n.title,snippetName:n.snippetName,folder:n.folder??"",content:"// Loading",imports:"",mainContent:"",showImportsToggle:!0,showCopyButton:!0,showExpandButton:!0,maxHeight:"300px",isExpanded:!1,isImportsExpanded:!1,needsExpansion:!1,enableDOMObservation:!0,enablePrismHighlighting:!0,loading:!1,error:null}}),this.loadSnippet()}get hasImports(){return this.value.imports.trim().length>0}get hasMainContent(){return this.value.mainContent.trim().length>0}get displayContent(){if(this.value.loading){const n=this.value.snippetName||"snippet",r=this.value.folder;return`// Loading snippet: ${n}${r?` from ${r}`:""}...
// Please wait...`}return this.value.error?`// Failed to load snippet: ${this.value.snippetName||"snippet"}
// Error: ${this.value.error}
// Please check the file path and try again.`:this.hasImports&&this.hasMainContent?this.value.isImportsExpanded?`${this.value.imports}

${this.value.mainContent}`:this.value.mainContent:this.value.content}get fullContent(){return this.hasImports&&this.hasMainContent?`${this.value.imports}

${this.value.mainContent}`:this.value.content}get shouldShowImportsToggle(){return this.value.showImportsToggle&&this.hasImports}toggleExpansion(){this.mutate(n=>{n.isExpanded=!n.isExpanded})}toggleImports(){this.mutate(n=>{n.isImportsExpanded=!n.isImportsExpanded})}setExpanded(n){this.mutate(r=>{r.isExpanded=n})}setImportsExpanded(n){this.mutate(r=>{r.isImportsExpanded=n})}setNeedsExpansion(n){this.mutate(r=>{r.needsExpansion=n})}updateContent(n,r,s){this.mutate(i=>{i.content=n,r!==void 0&&(i.imports=r),s!==void 0&&(i.mainContent=s)})}async loadSnippet(){const{folder:n,snippetName:r,language:s}=this.value,i=s==="tsx"?"tsx":"ts";this.setLoading(!0);try{const o=n?`/snippets/${n}/${r}.${i}`:`/snippets/${r}.${i}`,a=await fetch(o);if(!a.ok)throw console.error("snippet load failure:",this.value,a),new Error(`Failed to load snippet: ${r}`);const u=(await a.text()).split(`
`).filter(v=>!v.startsWith("// Auto-generated snippet from:")).filter(v=>!v.startsWith("// Description:")).filter(v=>!v.startsWith("// Last synced:")).filter(v=>!v.startsWith("// DO NOT EDIT")).join(`
`).replace(/^\n+/,""),{imports:h,mainContent:z}=this.separateImports(u);this.updateContent(u,h,z),this.setLoading(!1)}catch(o){this.setError(o instanceof Error?o.message:"Unknown error")}}separateImports(n){const r=n.split(`
`);let s=-1;for(let l=0;l<r.length;l++)r[l].trim().startsWith("import ")&&(s=l);if(s===-1)return{imports:"",mainContent:n};let i=s;for(let l=s;l<r.length;l++){const u=r[l];if((u.includes("'")||u.includes('"'))&&l<=s+10)i=l;else if(u.trim()===""&&l===i+1){i=l;break}else if(u.trim()!==""&&l>s)break}const o=r.slice(0,i+1).join(`
`),a=r.slice(i+1).join(`
`).replace(/^\n+/,"");return{imports:o,mainContent:a}}setLoading(n){this.mutate(r=>{r.loading=n,n&&(r.error=null)})}setError(n){this.mutate(r=>{r.error=n,r.loading=!1})}setRefs(n,r){this.contentRef=n,this.codeRef=r}checkExpansionNeeds(){if(this.contentRef?.current){const n=this.contentRef.current,r=n.scrollHeight,s=n.clientHeight,i=r>s;i!==this.value.needsExpansion&&this.setNeedsExpansion(i)}}checkExpansionWithHighlight=()=>{this.resizing||(this.checkExpansionNeeds(),this.value.enablePrismHighlighting&&this.codeRef?.current&&(this.resizing=!0,ur.highlightElement(this.codeRef.current),setTimeout(()=>{this.resizing=!1},200)))};startDOMObservation(){!this.value.enableDOMObservation||!this.contentRef?.current||(this.checkExpansionWithHighlight(),this.mutationObserver=new MutationObserver(this.checkExpansionWithHighlight),this.mutationObserver.observe(this.contentRef.current,{childList:!0,subtree:!0,characterData:!0,attributes:!0,attributeFilter:["style","class"]}),window.ResizeObserver&&(this.resizeObserver=new ResizeObserver(this.checkExpansionWithHighlight),this.resizeObserver.observe(this.contentRef.current)))}stopDOMObservation(){this.mutationObserver?.disconnect(),this.resizeObserver?.disconnect(),this.mutationObserver=null,this.resizeObserver=null}async copyToClipboard(){try{return await navigator.clipboard.writeText(this.fullContent),{success:!0,message:"Copied to clipboard"}}catch{return{success:!1,message:"Failed to copy"}}}destroy(){this.stopDOMObservation(),super.destroy?.()}}const Ac=t=>new _c(t),hr=({language:t,snippetName:n,folder:r,ts:s,content:i,children:o,title:a,containerProps:l={},codeProps:u={}})=>{const h=Be("gray.900","gray.800"),z=Be("gray.200","gray.600"),v=Rt(),R={language:t,snippetName:n,folder:r,title:a,content:i||o?.toString()||"",children:o},[A,I]=ye(Ac,R),W=ee.useRef(null),D=ee.useRef(null);ee.useEffect(()=>{I.setRefs(W,D)},[I]),ee.useEffect(()=>{n&&I.loadSnippet(n,r,s)},[n,r,s,I]);const H=async()=>{const f=await I.copyToClipboard();v({title:f.message,status:f.success?"success":"error",duration:2e3,isClosable:!0})};return ee.useEffect(()=>{A.enableDOMObservation?I.startDOMObservation():I.checkExpansionNeeds();const f=setTimeout(()=>{I.checkExpansionWithHighlight()},800);return()=>{clearTimeout(f),I.stopDOMObservation()}},[A.enableDOMObservation,I,I.displayContent]),e.jsxs(d,{border:"1px",borderColor:z,borderRadius:"md",width:"full",overflow:"hidden",my:4,...l,children:[(A.title||a)&&e.jsx(d,{bg:"gray.100",px:4,py:2,borderBottom:"1px",borderColor:z,children:e.jsx(c,{fontSize:"sm",fontWeight:"medium",children:a||A.title})}),e.jsxs(d,{position:"relative",children:[(A.showImportsToggle||A.showCopyButton)&&e.jsxs(Ue,{position:"absolute",top:2,right:8,zIndex:10,align:"center",gap:2,bg:"blackAlpha.300",px:A.showImportsToggle?4:2,py:1,borderRadius:"md",backdropFilter:"blur(4px)",children:[I.shouldShowImportsToggle&&e.jsxs(Ue,{align:"center",gap:1,children:[e.jsx("input",{type:"checkbox",checked:A.isImportsExpanded,onChange:I.$.toggleImports,style:{width:"12px",height:"12px",accentColor:"#3182ce"}}),e.jsx(c,{fontSize:"xs",color:"gray.300",cursor:"pointer",userSelect:"none",onClick:I.$.toggleImports,children:"show imports"})]}),A.showCopyButton&&e.jsx(_r,{"aria-label":"Copy code",icon:e.jsx(Hr,{}),size:"xs",colorScheme:"gray",variant:"ghost",color:"gray.400",_hover:{color:"white",bg:"gray.600"},onClick:H})]}),e.jsx(d,{ref:W,as:"pre",bg:h,color:"white",p:4,overflow:"auto",fontSize:"sm",fontFamily:"mono",lineHeight:"1.5",maxHeight:A.isExpanded?"none":A.maxHeight,transition:"max-height 0.3s ease",...u,children:e.jsx(K,{as:"code",className:`language-${A.language==="tsx"?"typescript":A.language}`,bg:"transparent",color:"inherit",p:0,fontSize:"inherit",fontFamily:"inherit",whiteSpace:"pre",ref:D,children:o??I.displayContent})}),A.showExpandButton&&(A.needsExpansion||A.isExpanded)&&e.jsx(d,{position:"absolute",bottom:0,left:0,right:0,bg:A.isExpanded?"transparent":`linear-gradient(transparent, ${h})`,p:4,children:e.jsx(Ue,{direction:"row",justify:"flex-end",pr:A.showImportsToggle||A.showCopyButton?8:0,children:e.jsx(O,{size:"sm",variant:"outline",colorScheme:"blue",onClick:I.$.toggleExpansion,bg:h,color:"white",borderColor:"blue.400",_hover:{bg:"blue.600"},children:A.isExpanded?"Show Less":"Show More"})})})]})]})},Cc=({tab:t})=>e.jsx(Ar,{p:0,mt:0,children:e.jsx(hr,{language:t.language,snippetName:t.snippet,folder:t.folder,content:t.code,containerProps:{border:"none",borderRadius:0,my:0},codeProps:{bg:"gray.700"}})});var _n={},An;function Fc(){return An||(An=1,(function(t){t.languages.typescript=t.languages.extend("javascript",{"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|type)\s+)(?!keyof\b)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?:\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,lookbehind:!0,greedy:!0,inside:null},builtin:/\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\b/}),t.languages.typescript.keyword.push(/\b(?:abstract|declare|is|keyof|readonly|require)\b/,/\b(?:asserts|infer|interface|module|namespace|type)\b(?=\s*(?:[{_$a-zA-Z\xA0-\uFFFF]|$))/,/\btype\b(?=\s*(?:[\{*]|$))/),delete t.languages.typescript.parameter,delete t.languages.typescript["literal-property"];var n=t.languages.extend("typescript",{});delete n["class-name"],t.languages.typescript["class-name"].inside=n,t.languages.insertBefore("typescript","function",{decorator:{pattern:/@[$\w\xA0-\uFFFF]+/,inside:{at:{pattern:/^@/,alias:"operator"},function:/^[\s\S]+/}},"generic-function":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\s*\()/,greedy:!0,inside:{function:/^#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:n}}}}),t.languages.ts=t.languages.typescript})(Prism)),_n}Fc();(function(t){var n=t.util.clone(t.languages.javascript),r=/(?:\s|\/\/.*(?!.)|\/\*(?:[^*]|\*(?!\/))\*\/)/.source,s=/(?:\{(?:\{(?:\{[^{}]*\}|[^{}])*\}|[^{}])*\})/.source,i=/(?:\{<S>*\.{3}(?:[^{}]|<BRACES>)*\})/.source;function o(u,h){return u=u.replace(/<S>/g,function(){return r}).replace(/<BRACES>/g,function(){return s}).replace(/<SPREAD>/g,function(){return i}),RegExp(u,h)}i=o(i).source,t.languages.jsx=t.languages.extend("markup",n),t.languages.jsx.tag.pattern=o(/<\/?(?:[\w.:-]+(?:<S>+(?:[\w.:$-]+(?:=(?:"(?:\\[\s\S]|[^\\"])*"|'(?:\\[\s\S]|[^\\'])*'|[^\s{'"/>=]+|<BRACES>))?|<SPREAD>))*<S>*\/?)?>/.source),t.languages.jsx.tag.inside.tag.pattern=/^<\/?[^\s>\/]*/,t.languages.jsx.tag.inside["attr-value"].pattern=/=(?!\{)(?:"(?:\\[\s\S]|[^\\"])*"|'(?:\\[\s\S]|[^\\'])*'|[^\s'">]+)/,t.languages.jsx.tag.inside.tag.inside["class-name"]=/^[A-Z]\w*(?:\.[A-Z]\w*)*$/,t.languages.jsx.tag.inside.comment=n.comment,t.languages.insertBefore("inside","attr-name",{spread:{pattern:o(/<SPREAD>/.source),inside:t.languages.jsx}},t.languages.jsx.tag),t.languages.insertBefore("inside","special-attr",{script:{pattern:o(/=<BRACES>/.source),alias:"language-javascript",inside:{"script-punctuation":{pattern:/^=(?=\{)/,alias:"punctuation"},rest:t.languages.jsx}}},t.languages.jsx.tag);var a=function(u){return u?typeof u=="string"?u:typeof u.content=="string"?u.content:u.content.map(a).join(""):""},l=function(u){for(var h=[],z=0;z<u.length;z++){var v=u[z],R=!1;if(typeof v!="string"&&(v.type==="tag"&&v.content[0]&&v.content[0].type==="tag"?v.content[0].content[0].content==="</"?h.length>0&&h[h.length-1].tagName===a(v.content[0].content[1])&&h.pop():v.content[v.content.length-1].content==="/>"||h.push({tagName:a(v.content[0].content[1]),openedBraces:0}):h.length>0&&v.type==="punctuation"&&v.content==="{"?h[h.length-1].openedBraces++:h.length>0&&h[h.length-1].openedBraces>0&&v.type==="punctuation"&&v.content==="}"?h[h.length-1].openedBraces--:R=!0),(R||typeof v=="string")&&h.length>0&&h[h.length-1].openedBraces===0){var A=a(v);z<u.length-1&&(typeof u[z+1]=="string"||u[z+1].type==="plain-text")&&(A+=a(u[z+1]),u.splice(z+1,1)),z>0&&(typeof u[z-1]=="string"||u[z-1].type==="plain-text")&&(A=a(u[z-1])+A,u.splice(z-1,1),z--),u[z]=new t.Token("plain-text",A,null,A)}v.content&&typeof v.content!="string"&&l(v.content)}};t.hooks.add("after-tokenize",function(u){u.language!=="jsx"&&u.language!=="tsx"||l(u.tokens)})})(Prism);const de=({tabs:t,defaultIndex:n=0})=>{const r=Be("gray.200","gray.600"),[s,i]=pe.useState(n);return ee.useEffect(()=>{setTimeout(()=>ur.highlightAll(),10)},[s]),e.jsx(d,{border:"1px",borderColor:r,borderRadius:"md",overflow:"hidden",my:4,width:"full",children:e.jsxs(Cr,{index:s,onChange:i,variant:"enclosed",children:[e.jsx(Fr,{bg:"gray.100",borderBottom:"1px",borderColor:r,children:t.map((o,a)=>e.jsx(Tr,{fontSize:"sm",fontWeight:"medium",_selected:{bg:"black",color:"white",borderBottomColor:"black"},children:o.label},a))}),e.jsx(Er,{mt:0,children:t.map((o,a)=>e.jsx(Cc,{tab:o,tabIndex:a},a))})]})})},C=({children:t,title:n,titleSize:r="xl",spacing:s=6,noVStack:i=!1,...o})=>{const a=n?e.jsx(m,{textAlign:"center",size:r,children:n}):"";return e.jsx(En,{width:"full",mb:3,children:e.jsxs($n,{...o,children:[a,i?t:e.jsx(x,{spacing:s,align:"stretch",children:t})]})})};class Tc extends he{constructor(){super({name:"demo-counter",value:{count:0}})}increment(){this.mutate(n=>{n.count+=1})}decrement(){this.mutate(n=>{n.count-=1})}reset(){this.mutate(n=>{n.count=0})}}const Ec=()=>new Tc,$c=()=>{const[t,n]=ye(Ec),{count:r}=t;return e.jsxs(d,{p:6,bg:"gray.100",borderRadius:"md",textAlign:"center",minW:"300px",children:[e.jsx(c,{fontSize:"3xl",fontWeight:"bold",color:"forest.600",mb:4,children:r}),e.jsxs($,{spacing:4,justify:"center",children:[e.jsx(O,{colorScheme:"forest",onClick:n.$.increment,children:"+1"}),e.jsx(O,{variant:"outline",onClick:n.$.decrement,children:"-1"}),e.jsx(O,{colorScheme:"red",variant:"outline",onClick:n.$.reset,children:"Reset"})]})]})},Ic=()=>e.jsxs(ie,{maxW:"container.xl",py:8,children:[" ",e.jsxs($,{spacing:2,width:"full",justify:"space-between",align:"flex-start",children:[e.jsx(O,{as:Q,to:"/why",colorScheme:"forest",size:"lg",children:"Why Forestry?"}),e.jsxs(x,{spacing:2,textAlign:"center",mb:6,children:[e.jsxs($,{align:"center",gap:6,children:[e.jsx(Zt,{w:"64px",h:"64px",src:"/img/logo.png"}),e.jsx(m,{size:"2xl",color:"gray.800",m:0,children:"Forestry 4.0"})]}),e.jsxs(d,{children:[e.jsx(c,{textStyle:"hero",children:"A simple, powerful state management library for React."}),e.jsx(c,{textStyle:"hero",children:"Forestry allows you to collect instances that manage values with predefined schema and modify them with custom methods. It allows you to create control systems that are faster, more consistent, and more reliable update systems."}),e.jsx(c,{textStyle:"hero",children:"It is designed not only to supercharge short term execution but to enhance project evolution including testing, variation, and delegation."})]})]}),e.jsx(O,{as:Q,to:"/store",variant:"outline",size:"lg",children:"Get Started"})]}),e.jsxs(X,{columns:{base:1,lg:2},spacing:8,mb:12,children:[e.jsxs(C,{children:[e.jsxs(x,{spacing:0,children:[e.jsx(m,{size:"lg",color:"forest.700",my:2,children:"Get productive in 5 minutes"}),e.jsx(c,{color:"gray.600",children:"Everything you need to manage state in React applications. Simple, predictable, and powerful."})]}),e.jsxs(x,{align:"start",spacing:2,fontSize:"sm",children:[e.jsxs($,{children:[e.jsx(c,{children:"✅"}),e.jsx(c,{as:Q,to:"/store",color:"forest.600",_hover:{textDecoration:"underline"},children:"Create stores with initial state"})]}),e.jsxs($,{children:[e.jsx(c,{children:"✅"}),e.jsx(c,{as:Q,to:"/actions",color:"forest.600",_hover:{textDecoration:"underline"},children:"Define actions for state updates"})]}),e.jsxs($,{children:[e.jsx(c,{children:"✅"}),e.jsx(c,{as:Q,to:"/react",color:"forest.600",_hover:{textDecoration:"underline"},children:"React hooks integration"})]}),e.jsxs($,{children:[e.jsx(c,{children:"✅"}),e.jsx(c,{as:Q,to:"/store",color:"forest.600",_hover:{textDecoration:"underline"},children:"TypeScript support"})]})]})]}),e.jsxs(C,{children:[e.jsxs(x,{spacing:0,align:"start",children:[e.jsx(m,{size:"lg",color:"purple.700",my:2,children:"Advanced capabilities"}),e.jsx(c,{color:"gray.600",children:"Unlock advanced features for complex applications: validation, transactions, and reactive patterns."})]}),e.jsxs(x,{align:"start",spacing:2,fontSize:"sm",children:[e.jsxs($,{children:[e.jsx(c,{children:"🔧"}),e.jsx(c,{as:Q,to:"/validation",color:"purple.600",_hover:{textDecoration:"underline"},children:"Built-in validation system"})]}),e.jsxs($,{children:[e.jsx(c,{children:"🔧"}),e.jsx(c,{as:Q,to:"/transactions",color:"purple.600",_hover:{textDecoration:"underline"},children:"Atomic transactions with rollback"})]}),e.jsxs($,{children:[e.jsx(c,{children:"🔧"}),e.jsx(c,{as:Q,to:"/rxjs",color:"purple.600",_hover:{textDecoration:"underline"},children:"RxJS reactive programming"})]}),e.jsxs($,{children:[e.jsx(c,{children:"🔧"}),e.jsx(c,{as:Q,to:"/examples",color:"purple.600",_hover:{textDecoration:"underline"},children:"Advanced patterns & debugging"})]})]})]})]}),e.jsxs(C,{title:"Example - basic counter",children:[e.jsx($c,{}),e.jsx(Ne,{}),e.jsx(de,{tabs:[{label:"Store Factory",language:"typescript",snippet:"demo-store-definition",folder:"home"},{label:"Component",language:"tsx",snippet:"demo-jsx-template",folder:"home"}]})]})]}),Zc=()=>e.jsxs(x,{spacing:8,align:"stretch",children:[e.jsxs(d,{textAlign:"center",children:[e.jsx(m,{size:"xl",mb:4,children:"Why Choose Forestry?"}),e.jsx(c,{fontSize:"lg",color:"gray.600",maxW:"3xl",mx:"auto",children:"Forestry provides a powerful, type-safe, and intuitive approach to state management that scales from simple components to complex applications."})]}),e.jsxs(X,{columns:{base:1,md:2,lg:3},spacing:6,children:[e.jsxs(d,{layerStyle:"card",bg:"blue.50",children:[e.jsx(Te,{as:Ee,color:"blue.500",boxSize:8,mb:4}),e.jsx(m,{variant:"card",color:"blue.700",children:"Type Safety First"}),e.jsxs(se,{spacing:2,children:[e.jsxs(b,{children:[e.jsx(F,{as:V,color:"blue.500"}),"Full TypeScript integration"]}),e.jsxs(b,{children:[e.jsx(F,{as:V,color:"blue.500"}),"Compile-time error detection"]}),e.jsxs(b,{children:[e.jsx(F,{as:V,color:"blue.500"}),"IntelliSense support"]}),e.jsxs(b,{children:[e.jsx(F,{as:V,color:"blue.500"}),"Zod schema validation"]})]})]}),e.jsxs(d,{layerStyle:"card",bg:"green.50",children:[e.jsx(Te,{as:Ee,color:"green.500",boxSize:8,mb:4}),e.jsx(m,{variant:"card",color:"green.700",children:"Reactive by Design"}),e.jsxs(se,{spacing:2,children:[e.jsxs(b,{children:[e.jsx(F,{as:V,color:"green.500"}),"RxJS-powered reactivity"]}),e.jsxs(b,{children:[e.jsx(F,{as:V,color:"green.500"}),"Automatic UI updates"]}),e.jsxs(b,{children:[e.jsx(F,{as:V,color:"green.500"}),"Efficient change detection"]}),e.jsxs(b,{children:[e.jsx(F,{as:V,color:"green.500"}),"Subscription management"]})]})]}),e.jsxs(d,{layerStyle:"card",bg:"purple.50",children:[e.jsx(Te,{as:Ee,color:"purple.500",boxSize:8,mb:4}),e.jsx(m,{variant:"card",color:"purple.700",children:"Developer Experience"}),e.jsxs(se,{spacing:2,children:[e.jsxs(b,{children:[e.jsx(F,{as:V,color:"purple.500"}),"Intuitive API design"]}),e.jsxs(b,{children:[e.jsx(F,{as:V,color:"purple.500"}),"Minimal boilerplate"]}),e.jsxs(b,{children:[e.jsx(F,{as:V,color:"purple.500"}),"Built-in testing tools"]}),e.jsxs(b,{children:[e.jsx(F,{as:V,color:"purple.500"}),"Excellent debugging"]})]})]}),e.jsxs(d,{layerStyle:"card",bg:"orange.50",children:[e.jsx(Te,{as:Ee,color:"orange.500",boxSize:8,mb:4}),e.jsx(m,{variant:"card",color:"orange.700",children:"Validation & Quality"}),e.jsxs(se,{spacing:2,children:[e.jsxs(b,{children:[e.jsx(F,{as:V,color:"orange.500"}),"Three-layer validation"]}),e.jsxs(b,{children:[e.jsx(F,{as:V,color:"orange.500"}),"Runtime type checking"]}),e.jsxs(b,{children:[e.jsx(F,{as:V,color:"orange.500"}),"Quality feedback system"]}),e.jsxs(b,{children:[e.jsx(F,{as:V,color:"orange.500"}),"Error boundary support"]})]})]}),e.jsxs(d,{layerStyle:"card",bg:"teal.50",children:[e.jsx(Te,{as:Ee,color:"teal.500",boxSize:8,mb:4}),e.jsx(m,{variant:"card",color:"teal.700",children:"Scalable Architecture"}),e.jsxs(se,{spacing:2,children:[e.jsxs(b,{children:[e.jsx(F,{as:V,color:"teal.500"}),"Modular store design"]}),e.jsxs(b,{children:[e.jsx(F,{as:V,color:"teal.500"}),"Forest branching system"]}),e.jsxs(b,{children:[e.jsx(F,{as:V,color:"teal.500"}),"Factory pattern support"]}),e.jsxs(b,{children:[e.jsx(F,{as:V,color:"teal.500"}),"Dependency injection"]})]})]}),e.jsxs(d,{layerStyle:"card",bg:"red.50",children:[e.jsx(Te,{as:Ee,color:"red.500",boxSize:8,mb:4}),e.jsx(m,{variant:"card",color:"red.700",children:"React Integration"}),e.jsxs(se,{spacing:2,children:[e.jsxs(b,{children:[e.jsx(F,{as:V,color:"red.500"}),"Custom React hooks"]}),e.jsxs(b,{children:[e.jsx(F,{as:V,color:"red.500"}),"Automatic cleanup"]}),e.jsxs(b,{children:[e.jsx(F,{as:V,color:"red.500"}),"SSR compatibility"]}),e.jsxs(b,{children:[e.jsx(F,{as:V,color:"red.500"}),"DevTools integration"]})]})]})]})]}),Rc=()=>e.jsxs(x,{spacing:8,align:"stretch",children:[e.jsx(m,{variant:"page",children:"Yet Another Store System?"}),e.jsx(d,{children:e.jsxs(C,{title:"Yes and here's why",children:[e.jsxs(d,{children:[e.jsx(c,{textStyle:"body",children:"Forestry grew from a profound disaffection in the status quo. Redux, mainly but also a lot of other alternatives including hooks. I saw the same patterns happening over and over again:"}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("b",{children:"A lack of the ability to synchronously update state"}),". There is no (good) reason that local state needs to be forced into async patterns. (as is the case in hooks) like RxJs (the backbone of Forestry) you should be able to change state and see results in real time. hooks for instance are particularly poor at reflecting the real time state of anything given the large refresh cycle of useState. In my experience, the federation that asynchronous code creates is a drag on comprehension, testability, reliability and maintainability; if it is not a natural side effect of activities that are naturally async, you're paying these costs not because your use case demands it but because you have adopted a control system that uses async processes for no good reason."]}),e.jsxs("li",{children:[e.jsx("b",{children:"Far too much magic"}),". Actions should be straight up javascript code with as little magic as necessary."]}),e.jsxs("li",{children:[e.jsx("b",{children:"Had coded state that is difficult to test"}),". Most state systems are so wed to their context that they are difficult to isolate; this violates separation of concerns and frankly most React testing is so painful that it behooves you to extricate the business logic and enable independent testing."]}),e.jsxs("li",{children:[e.jsx("b",{children:"Abdication of responsibility for schema enforcement"}),'; validation of change values before they are submitted into state is not something to be put in as optional nice to have or assumed to be a "solved problem" with typescript. State data is dynamic and often comes from sources outside the codebase (fetch), so typescript cannot enforce type sanity - state must take that responsibility to heart.']}),e.jsxs("li",{children:[e.jsx("b",{children:"Lack of transactional atomicity"}),"; often you need to make several changes in sequence and have them all succeed or fail; especially important with the use of nested actions. Forestry even allows you to temporarily suspend validation constraints while you change state over several steps as long as the net effect of transactions produce valid data."]}),e.jsxs("li",{children:[e.jsx("b",{children:"Nested Actions"}),"; composition is very difficult or impossible in many state systems; Forestry allows you to drill deep into multiple actions."]}),e.jsxs("li",{children:[e.jsx("b",{children:'Complex or "magical" architecture'}),"; it's easy to develop insular meta-languages that steepen the learning curve without commensurate gains in performance or scalability. This is true of Redux and equally true of systems like Saga."]})]}),e.jsxs(c,{textStyle:"body",children:['Foresty has been written to address these features point by point. Many of the solutions are "passive" - some like ',e.jsx(Q,{to:"/validation",children:"Validation"}),"require some tooling."]})]}),e.jsxs(d,{children:[e.jsx(m,{variant:"subtle",children:"Simplicity that doesn't scale is a net loss in productivity"}),e.jsx(c,{textStyle:"body",children:'A lot of stores exist and trade off of their "simplicity". This is well and good - but simplicity is only good if it scales. Part of this is "can it be tested"; but part is also does it address mid and long term concerns or force the developers to invent custom solutions for routine tasks.'}),e.jsxs(c,{textStyle:"body",children:["Its easy to assume that TypeScript will enforce type sanity; however Typescript only ensures that the elements ",e.jsx("i",{children:"coded by you"}),' are internally consistent; and since you are chored with writing your own gate functions, even that is not always guaranteed. Real databases always ensure that the structure of your updates is consistent with the store. "Unopinionated" stores like Redux or hooks abdicate this responsibility to the developer.']}),e.jsxs(c,{textStyle:"body",children:[`Similarly most backend controllers execute multiple sub-tasks with changes including validation, distribution of data, comparison with existing conditions and other "change triggered" utilities. Designing change systems that don't allow for "strategic" actions to trigger sub-actions for a more orchestrated process.`," "]}),e.jsx(c,{textStyle:"body",children:"This is key for scaling apps past inception because at some point the strategic methods may delegate to variations based on conditions; using sub-actions that you can switch is much more scalable than creating multiple nearly identical top-level actions. Consider for instance, a work flow that has three stages with two variations for each stage. Varying this requires either one central method with complex switching boilerplate inside it, or eight different top level functions with severe repetition."})]})]})}),e.jsxs(d,{layerStyle:"card",bg:"gray.50",children:[e.jsx(m,{variant:"section",children:"Feature Comparison"}),e.jsx($r,{children:e.jsxs(In,{variant:"simple",size:"sm",children:[e.jsx(Zn,{children:e.jsxs(ae,{children:[e.jsx(ve,{children:"Feature"}),e.jsx(ve,{textAlign:"center",children:"Forestry"}),e.jsx(ve,{textAlign:"center",children:"Redux"}),e.jsx(ve,{textAlign:"center",children:"Zustand"}),e.jsx(ve,{textAlign:"center",children:"Jotai"})]})}),e.jsxs(Rn,{children:[e.jsxs(ae,{children:[e.jsx(k,{fontWeight:"semibold",children:"TypeScript Support"}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"green",children:"Excellent"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"yellow",children:"Good"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"green",children:"Excellent"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"green",children:"Excellent"})})]}),e.jsxs(ae,{children:[e.jsx(k,{fontWeight:"semibold",children:"Boilerplate"}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"green",children:"Minimal"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"red",children:"Heavy"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"green",children:"Minimal"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"yellow",children:"Medium"})})]}),e.jsxs(ae,{children:[e.jsx(k,{fontWeight:"semibold",children:"Validation"}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"green",children:"Built-in"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"red",children:"External"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"red",children:"External"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"red",children:"External"})})]}),e.jsxs(ae,{children:[e.jsx(k,{fontWeight:"semibold",children:"Reactivity"}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"green",children:"RxJS"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"yellow",children:"Manual"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"yellow",children:"Manual"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"green",children:"Automatic"})})]}),e.jsxs(ae,{children:[e.jsx(k,{fontWeight:"semibold",children:"DevTools"}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"green",children:"Built-in"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"green",children:"Excellent"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"yellow",children:"Basic"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"yellow",children:"Basic"})})]}),e.jsxs(ae,{children:[e.jsx(k,{fontWeight:"semibold",children:"Learning Curve"}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"green",children:"Gentle"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"red",children:"Steep"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"green",children:"Gentle"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"yellow",children:"Medium"})})]}),e.jsxs(ae,{children:[e.jsx(k,{fontWeight:"semibold",children:"Action Testability"}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"green",children:"Excellent"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"yellow",children:"Complex"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"yellow",children:"Manual"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"yellow",children:"Manual"})})]}),e.jsxs(ae,{children:[e.jsx(k,{fontWeight:"semibold",children:"Atomic Operations"}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"green",children:"Built-in"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"red",children:"Manual"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"red",children:"Manual"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"red",children:"Manual"})})]}),e.jsxs(ae,{children:[e.jsx(k,{fontWeight:"semibold",children:"Context Independence"}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"green",children:"Complete"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"red",children:"Coupled"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"yellow",children:"Partial"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"yellow",children:"Partial"})})]}),e.jsxs(ae,{children:[e.jsx(k,{fontWeight:"semibold",children:"Real-time Feedback"}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"green",children:"Synchronous"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"red",children:"Async Only"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"yellow",children:"Limited"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"yellow",children:"Limited"})})]}),e.jsxs(ae,{children:[e.jsx(k,{fontWeight:"semibold",children:"Bundle Size"}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"yellow",children:"Medium"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"red",children:"Large"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"green",children:"Small"})}),e.jsx(k,{textAlign:"center",children:e.jsx(w,{colorScheme:"green",children:"Small"})})]})]})]})})]}),e.jsxs(X,{columns:{base:1,lg:2},spacing:6,children:[e.jsxs(d,{layerStyle:"card",bg:"green.50",children:[e.jsx(m,{variant:"card",color:"green.700",children:"✅ Forestry Advantages"}),e.jsxs(x,{spacing:3,align:"stretch",children:[e.jsxs(c,{fontSize:"sm",children:[e.jsx("strong",{children:"Built-in Validation:"})," Three-layer validation system with runtime checks"]}),e.jsxs(c,{fontSize:"sm",children:[e.jsx("strong",{children:"RxJS Integration:"})," Powerful reactive programming capabilities"]}),e.jsxs(c,{fontSize:"sm",children:[e.jsx("strong",{children:"Forest Branching:"})," Unique field-level state management for forms"]}),e.jsxs(c,{fontSize:"sm",children:[e.jsx("strong",{children:"Quality Feedback:"})," User-friendly validation messages"]}),e.jsxs(c,{fontSize:"sm",children:[e.jsx("strong",{children:"Factory Pattern:"})," Dependency injection and reusable store creation"]})]})]}),e.jsxs(d,{layerStyle:"card",bg:"orange.50",children:[e.jsx(m,{variant:"card",color:"orange.700",children:"⚠️ Trade-offs"}),e.jsxs(x,{spacing:3,align:"stretch",children:[e.jsxs(c,{fontSize:"sm",children:[e.jsx("strong",{children:"Learning Curve:"})," New concepts like Forest branching and validation layers"]}),e.jsxs(c,{fontSize:"sm",children:[e.jsx("strong",{children:"Bundle Size:"})," RxJS dependency adds to bundle size"]}),e.jsxs(c,{fontSize:"sm",children:[e.jsx("strong",{children:"Ecosystem:"})," Newer library with smaller community"]}),e.jsxs(c,{fontSize:"sm",children:[e.jsx("strong",{children:"Documentation:"})," Still growing compared to established solutions"]})]})]})]})]}),It=100,pr=ge({id:ue().positive("Todo ID must be positive"),text:P().min(1,"Todo text cannot be empty").max(It,"Todo text too long"),completed:oe()}),Dc=ge({todos:Je(pr).max(100,"Too many todos"),filter:qe(["all","active","completed"]),newTodoText:P().max(200,"New todo text too long")});function Cn(t){return typeof t!="string"?"":t.trim().toLocaleLowerCase()}class Pc extends he{constructor(){const n=[{id:1,text:"Learn Forestry 4",completed:!0},{id:2,text:"Build a React app",completed:!1},{id:3,text:"Master state management",completed:!1}];super({name:"todo-app",value:{todos:n,filter:"all",newTodoText:""},schema:Dc,tests:[r=>{const s=r.todos.map(i=>i.text.toLowerCase()).filter((i,o,a)=>a.indexOf(i)!==o);return s.length>0?`Duplicate todos found: ${s.join(", ")}`:null}]})}get newTodoTextIsValid(){return!this.newTodoErrors}get newTodoErrors(){if(this.value.todos.find(r=>Cn(r.text)===Cn(this.value.newTodoText)))return"Todo exists in collection";const{newTodoText:n}=this.value;return n.length>It?`Todo too long (${n.length} chars, ${n.length-It} over)`:""}get filteredTodos(){const n=this.value;switch(n.filter){case"active":return n.todos.filter(r=>!r.completed);case"completed":return n.todos.filter(r=>r.completed);default:return n.todos}}get completedCount(){return this.value.todos.filter(n=>n.completed).length}get activeCount(){return this.value.todos.filter(n=>!n.completed).length}isAddDisabled(){return!this.value.newTodoText.trim()}setFilterAll(){this.setFilter("all")}setFilterActive(){this.setFilter("active")}setFilterCompleted(){this.setFilter("completed")}handleKeyPress(n){n.key==="Enter"&&this.addTodo()}createToggleTodo(n){return()=>this.toggleTodo(n)}createRemoveTodo(n){return()=>this.removeTodo(n)}onChange(n){const{name:r,value:s}=n.target;this.set(r,s)}addTodo(){const n=this.value;if(!n.newTodoText.trim())return;const r={id:Date.now(),text:n.newTodoText.trim(),completed:!1},s=pr.safeParse(r);if(!s.success){console.error("Invalid todo item:",s.error.issues);return}this.mutate(i=>{i.todos.push(r),i.newTodoText=""})}toggleTodo(n){const r=this.value.todos.map(s=>s.id===n?{...s,completed:!s.completed}:s);this.set("todos",r)}removeTodo(n){const r=this.value.todos.filter(s=>s.id!==n);this.set("todos",r)}setFilter(n){this.set("filter",n)}clearCompleted(){const n=this.value.todos.filter(r=>!r.completed);this.set("todos",n)}}const Oc=()=>new Pc,Nc=({count:t,children:n})=>e.jsx(w,{position:"absolute",top:"-6px",right:"-6px",borderRadius:"full",colorScheme:"red",variant:"solid",minW:"18px",h:"18px",display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:"xs",lineHeight:"none",border:"1px solid",borderColor:"white",children:t??n}),ot=ee.memo(Nc),Bt=()=>{const[t,n]=ye(Oc);if(!t)return e.jsx(c,{children:"Loading..."});const r=n.filteredTodos;return e.jsxs(X,{columns:{base:1,xl:2},spacing:6,children:[e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsxs($,{width:"full",justify:"between",children:[e.jsx(m,{variant:"card",flex:1,children:"Todo List"}),n.completedCount>0?e.jsxs(O,{size:"sm",colorScheme:"red",variant:"solid",disabled:!n.completedCount,onClick:n.$.clearCompleted,children:["Clear Completed",e.jsx(ot,{children:n.completedCount})]}):null]}),e.jsx(d,{maxH:"400px",overflowY:"auto",border:"1px solid",borderColor:"gray.200",borderRadius:"md",p:4,children:r.length===0?e.jsx(c,{color:"gray.500",fontStyle:"italic",textAlign:"center",children:t.filter==="all"?"No todos yet!":t.filter==="active"?"No active todos!":"No completed todos!"}):e.jsx(x,{spacing:3,align:"stretch",children:r.map(s=>e.jsxs($,{p:3,bg:"gray.50",borderRadius:"md",children:[e.jsx(Ir,{isChecked:s.completed,title:"click to complete task",onChange:n.$.createToggleTodo(s.id)}),e.jsx(c,{flex:1,textDecoration:s.completed?"line-through":"none",color:s.completed?"gray.500":"inherit",children:s.text}),e.jsx(Dn,{size:"sm",colorScheme:"red",variant:"ghost",onClick:n.$.createRemoveTodo(s.id)})]},s.id))})})]}),e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsxs(d,{children:[e.jsx(m,{variant:"card",children:"Add New Todo"}),e.jsxs($,{children:[e.jsx($e,{name:"newTodoText",placeholder:"What needs to be done?",value:t.newTodoText,onChange:n.$.onChange,okKeyUp:n.$.handleKeyPress}),e.jsx(O,{colorScheme:"forest",onClick:n.$.addTodo,isDisabled:!n.newTodoTextIsValid,children:"Add"})]}),!t.newTodoText||n.newTodoTextIsValid?null:e.jsx(c,{color:"red",children:n.newTodoErrors})]}),e.jsxs(d,{children:[e.jsx(m,{variant:"card",children:"Filter Todos"}),e.jsxs($,{children:[e.jsxs(O,{size:"sm",variant:t.filter==="all"?"solid":"outline",colorScheme:"forest",onClick:n.$.setFilterAll,children:["Show All Tasks",t.todos.length&&e.jsx(ot,{children:t.todos.length})]}),e.jsxs(O,{size:"sm",variant:t.filter==="active"?"solid":"outline",colorScheme:"forest",onClick:n.$.setFilterActive,children:["Active",n.activeCount?e.jsx(ot,{children:n.activeCount}):null]}),e.jsxs(O,{size:"sm",variant:t.filter==="completed"?"solid":"outline",colorScheme:"forest",onClick:n.$.setFilterCompleted,children:["Completed",n.completedCount?e.jsx(ot,{children:n.completedCount}):null]})]})]})]})]})},Mc=()=>e.jsx(ie,{maxW:"6xl",py:8,children:e.jsxs(x,{spacing:12,align:"stretch",children:[e.jsxs(d,{textAlign:"center",children:[e.jsx(m,{size:"3xl",mb:6,children:"Why Forestry?"}),e.jsx(c,{textStyle:"hero",children:"Forestry is a next-generation state management library that combines the power of RxJS reactivity with TypeScript safety and an intuitive developer experience."})]}),e.jsx(Rc,{}),e.jsx(Ne,{}),e.jsx(Zc,{}),e.jsx("iframe",{width:"560",height:"315",src:"https://www.youtube.com/embed/bGzanfKVFeU?si=XVsdcSKOh3CcEYFm",title:"YouTube video player",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",referrerPolicy:"strict-origin-when-cross-origin",allowFullScreen:!0}),e.jsx(c,{children:"Why useEffect is not a panacea"}),e.jsx(Ne,{}),e.jsx(C,{title:"Try Forestry Live",children:e.jsx(Bt,{})}),e.jsx(C,{title:"Implementation",children:e.jsx(de,{tabs:[{label:"Store Structure",language:"typescript",snippet:"createTodoStore"},{label:"Component Usage",language:"tsx",snippet:"TodoApp"}]})})]})}),M=({title:t,language:n,code:r,children:s,snippetName:i,folder:o,ts:a})=>e.jsx(hr,{title:t,language:n,content:r,snippetName:i,folder:o,ts:a,children:s}),Vc=ge({name:P(),age:ue,email:Ta()});function Lc(){return new he({name:"user-store",value:{name:"John Doe",age:30,email:"john@example.com"},schema:Vc,actions:{onChange(t,n){const{name:r,value:s,type:i}=n.target,o=i==="number"?parseInt(s)||0:s;this.set(r,o)},setName(t,n){this.set("name",n)},setAge(t,n){this.set("age",n)},setEmail(t,n){this.set("email",n)},updateProfile:function(t,n){this.next({...t,...n})},reset:function(){this.next({name:"John Doe",age:30,email:"john@example.com"})}},tests:[t=>t.age<0?"Age cannot be negative":null,t=>t.age>150?"Age seems unrealistic":null,t=>t.email.includes("@")?null:"Invalid email format",t=>t.name.length===0?"Name cannot be empty":null]})}const Wc=()=>{const[t,n]=ye(Lc),[r,s]=ee.useState("");return e.jsxs(X,{columns:{base:1,lg:2},spacing:8,children:[e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsx(m,{size:"md",children:"Update Profile"}),e.jsxs(Ie,{children:[e.jsx(Ze,{children:"Name"}),e.jsx($e,{name:"name",value:t.name,onChange:n?.$.onChange})]}),e.jsxs(Ie,{children:[e.jsx(Ze,{children:"Age"}),e.jsx($e,{name:"age",type:"number",value:t.age.toString(),onChange:n?.$.onChange})]}),e.jsxs(Ie,{children:[e.jsx(Ze,{children:"Email"}),e.jsx($e,{name:"email",type:"email",value:t.email,onChange:n?.$.onChange})]}),e.jsx($,{children:e.jsx(O,{variant:"outline",onClick:()=>n?.$.reset(),children:"Reset to Defaults"})}),r&&e.jsxs(je,{status:"error",children:[e.jsx(be,{}),r]})]}),e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsx(m,{size:"md",children:"Current State"}),e.jsx(d,{bg:"gray.50",p:4,borderRadius:"md",children:e.jsx("pre",{children:JSON.stringify(t,null,2)})}),e.jsxs(d,{children:[e.jsx(c,{fontWeight:"semibold",mb:2,children:"Profile Stats:"}),e.jsxs(x,{align:"start",spacing:1,fontSize:"sm",children:[e.jsxs(c,{children:["Name length: ",e.jsx(w,{children:t.name.length})]}),e.jsxs(c,{children:["Valid email:"," ",e.jsx(w,{colorScheme:t.email.includes("@")?"green":"red",children:t.email.includes("@")?"Yes":"No"})]}),e.jsxs(c,{children:["Age range:"," ",e.jsx(w,{colorScheme:t.age>=0&&t.age<=150?"green":"red",children:t.age>=0&&t.age<=150?"Valid":"Invalid"})]})]})]})]})]})},Uc=[{label:"Basic Store",language:"typescript",snippet:"basicStore",folder:"StoreBasics"},{label:"With Validation",language:"typescript",snippet:"storeWithValidation",folder:"StoreBasics"},{label:"React Hook",language:"tsx",snippet:"reactHookPattern",folder:"StoreBasics"}],Bc=()=>e.jsx(ie,{maxW:"container.xl",py:8,children:e.jsxs(x,{spacing:8,align:"stretch",children:[e.jsxs(d,{children:[e.jsx(m,{variant:"page",children:"Forest Overview"}),e.jsx(c,{fontSize:"lg",color:"gray.600",children:"The Forest class is the core of Forestry 4, providing reactive state management with validation and transaction support. Stores extend off of this class to decorate it with actions and property selectors"})]}),e.jsxs(C,{title:"Constructor",children:[e.jsxs(c,{color:"gray.600",children:["Create a new Forest class for the root Store, with configuration options and"," ",e.jsx(Q,{to:"actions",children:"methods for modifying state"}),". They are all optional except for value."]}),e.jsx(M,{language:"typescript",snippetName:"storeConstructorSignature",folder:"StoreBasics",ts:!0}),e.jsx(m,{variant:"subtle",children:"Config properties"}),e.jsxs(X,{columns:{base:1,md:2},spacing:6,children:[e.jsxs(d,{children:[e.jsxs(m,{size:"md",mb:3,children:["value ",e.jsx(w,{colorScheme:"red",children:"Required"})]}),e.jsx(c,{color:"gray.600",mb:3,children:"Initial state value for the store. It can be an object, static (number, string), Map, Set, Array, etc.; it is an Immerable value; in short any JSON-able entity with the addition of Map and Set options."}),e.jsx(M,{language:"typescript",snippetName:"valueExample",folder:"StoreBasics",ts:!0})]}),e.jsxs(d,{children:[e.jsxs(m,{size:"md",mb:3,children:["tests ",e.jsx(w,{colorScheme:"orange",children:"Function | Function[]"})," and schema"," ",e.jsx(w,{colorScheme:"orange",children:"Zod instance"})]}),e.jsx(c,{color:"gray.600",mb:3,children:e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("b",{children:"Schema"}),e.jsx("br",{})," (a la Zod) defines the required structure of data in the value."]}),e.jsxs("li",{children:[e.jsx("b",{children:"tests"}),e.jsx("br",{}),"A function (or an array of functions) to ensure state integrity."]})]})}),e.jsx(M,{language:"typescript",snippetName:"testsExample",folder:"StoreBasics",ts:!0}),e.jsxs(c,{size:"sm",children:["See ",e.jsx(Q,{to:"/validation",children:"Validation"})," for more details on Vaidation parameters"]})]}),e.jsxs(d,{children:[e.jsxs(m,{size:"md",mb:3,children:["name ",e.jsx(w,{colorScheme:"blue",children:"string"})]}),e.jsx(c,{color:"gray.600",mb:3,children:"Unique identifier for the store instance."}),e.jsx(M,{language:"typescript",snippetName:"nameExample",folder:"StoreBasics",ts:!0})]})]})]}),e.jsxs(C,{children:[e.jsx(m,{children:"The Forestry Lifecycle"}),e.jsx(Zt,{src:"/img/forstry-flowchart-simple.svg",width:"full",mx:8,maxHeight:"80vh"}),e.jsx(c,{children:"Instead of an unregulated update (as is the case with useState/Redux) Forest offers optional interrupts to both sanitize and validate the data before it is committed. This includes comparing it to the defined schema and running any manual test functions."})]}),e.jsx(C,{title:"Code Examples",children:e.jsx(de,{tabs:Uc})}),e.jsxs(C,{title:"Live Example",children:[e.jsx(c,{color:"gray.600",children:"Try updating the user profile below to see validation in action:"}),e.jsx(Wc,{})]}),e.jsxs(C,{title:"Update Patterns",children:[e.jsx(c,{color:"gray.600",children:"Forestry 4 provides different methods for updating store values efficiently:"}),e.jsx(de,{tabs:[{label:"Form onChange Handler",language:"typescript",snippet:"formOnChangeHandler",folder:"StoreBasics"},{label:"Single Field Updates",language:"typescript",snippet:"singleFieldUpdates",folder:"StoreBasics"},{label:"Multiple Field Updates",language:"typescript",snippet:"multipleFieldUpdates",folder:"StoreBasics"},{label:"Complex Updates",language:"typescript",snippet:"complexUpdates",folder:"StoreBasics"},{label:"Validation Patterns",language:"typescript",snippet:"validationPatterns",folder:"StoreBasics"}]})]}),e.jsxs(C,{title:"Live Example Source Code",children:[e.jsx(c,{color:"gray.600",children:"Here's the complete source code for the user profile demo above:"}),e.jsx(de,{tabs:[{label:"Store Definition",language:"typescript",snippet:"liveExampleStoreDefinition",folder:"StoreBasics"},{label:"React Integration",language:"tsx",snippet:"reactIntegration",folder:"StoreBasics"},{label:"Form Component",language:"tsx",snippet:"formComponent",folder:"StoreBasics"}]})]})]})}),Hc=ge({count:ue().int(),history:Je(P()),multiplier:ue().int().min(0),qualityMessage:P()});class qc extends he{constructor(){super({name:"actions-demo",value:{count:0,history:[],multiplier:1,qualityMessage:""},schema:Hc})}increment(){this.mutate(n=>{const r=n.count+n.multiplier;n.count=r,n.history.push(`Incremented to ${r}`)})}decrement(){this.mutate(n=>{const r=n.count-n.multiplier;n.count=r,n.history.push(`Decremented to ${r}`)})}setMultiplier(n){this.set("multiplier",n)}doubleAndLog(){this.mutate(n=>{const r=n.count;n.count=r*2,n.history.push(`Doubled from ${r} to ${n.count}`)})}incrementTwice(){this.$.increment(),this.$.increment()}reset(){this.next({count:0,history:["Reset to 0"],multiplier:1,qualityMessage:""})}clearHistory(){this.mutate(n=>{n.history.length=0})}prep(n,r){const s={...r,...n};let i="";return s.count<-100?i="Count is getting very low":s.count>100?i="Count is getting very high":s.multiplier<1&&(i="Multiplier works best at 1 or higher"),{...s,qualityMessage:i}}}function Gc(){return new qc}const Jc=()=>{const[t,n]=ye(Gc);return e.jsxs(X,{columns:{base:1,lg:2},spacing:6,children:[e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsxs(d,{children:[e.jsx(c,{fontSize:"lg",fontWeight:"semibold",mb:3,children:"Counter Controls"}),e.jsxs(x,{spacing:3,align:"stretch",children:[e.jsxs($,{children:[e.jsxs(O,{colorScheme:"forest",onClick:()=>n.$.increment(),children:["+",t.multiplier]}),e.jsxs(O,{colorScheme:"forest",variant:"outline",onClick:()=>n.$.decrement(),children:["-",t.multiplier]}),e.jsx(O,{colorScheme:"blue",onClick:()=>n.$.doubleAndLog(),children:"Double"})]}),e.jsxs($,{children:[e.jsxs(O,{colorScheme:"purple",onClick:()=>n.$.incrementTwice(),children:["+",t.multiplier*2," (Twice)"]}),e.jsx(O,{variant:"outline",onClick:()=>n.$.reset(),children:"Reset"})]})]})]}),e.jsx(d,{children:e.jsxs(Ie,{children:[e.jsx(Ze,{children:"Multiplier"}),e.jsx($e,{type:"number",value:t.multiplier,onChange:r=>n.$.setMultiplier(parseInt(r.target.value)||1)})]})}),t.qualityMessage&&e.jsxs(je,{status:"info",children:[e.jsx(be,{}),t.qualityMessage]})]}),e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsxs(d,{children:[e.jsx(c,{fontSize:"lg",fontWeight:"semibold",mb:3,children:"Current State"}),e.jsxs(d,{p:4,bg:"gray.50",borderRadius:"md",children:[e.jsxs($,{mb:2,children:[e.jsx(c,{fontWeight:"semibold",children:"Count:"}),e.jsx(w,{colorScheme:t.count===0?"gray":t.count>0?"green":"red",fontSize:"lg",children:t.count})]}),e.jsxs($,{children:[e.jsx(c,{fontWeight:"semibold",children:"Multiplier:"}),e.jsx(w,{colorScheme:"blue",children:t.multiplier})]})]})]}),e.jsxs(d,{children:[e.jsxs($,{justify:"space-between",align:"center",mb:3,children:[e.jsx(c,{fontSize:"lg",fontWeight:"semibold",children:"Action History"}),e.jsx(O,{size:"sm",variant:"ghost",onClick:()=>n.$.clearHistory(),isDisabled:t.history.length===0,children:"Clear"})]}),e.jsx(d,{maxH:"200px",overflowY:"auto",border:"1px solid",borderColor:"gray.200",borderRadius:"md",p:3,children:t.history.length===0?e.jsx(c,{color:"gray.500",fontStyle:"italic",textAlign:"center",children:"No actions yet"}):e.jsx(x,{spacing:1,align:"stretch",children:t.history.map((r,s)=>e.jsxs(c,{fontSize:"sm",fontFamily:"mono",children:[s+1,". ",r]},s))})})]}),e.jsx(d,{children:e.jsxs(c,{fontSize:"sm",color:"gray.600",children:[e.jsx("strong",{children:"Try:"})," Use different multipliers, try to exceed limits (-100 to +100), or set multiplier below 1 to see validation in action."]})})]})]})},G=({title:t,children:n,code:r,snippetName:s,snippetFolder:i,language:o="typescript",codeTitle:a,titleSize:l="sm",titleAsCode:u=!1,codeColorScheme:h="",ts:z=!1})=>{const v=r||s;return ee.useEffect(()=>{v&&typeof window<"u"&&window.Prism&&setTimeout(()=>{window.Prism.highlightAll()},100)},[v,s,r]),e.jsxs(d,{children:[e.jsx(m,{size:l,layerStyle:"methodSignature",children:u?e.jsx(K,{fontSize:"sm",colorScheme:h,mb:1,children:t}):t}),e.jsx(c,{textStyle:"body",fontSize:u?"sm":void 0,color:u?"gray.600":void 0,mt:u?1:3,children:n}),v&&e.jsx(d,{mt:4,children:s?e.jsx(M,{title:a,language:o,snippetName:s,folder:i,ts:z}):e.jsx(M,{language:o,title:a,children:r})})]})},Yc=()=>e.jsx(ie,{maxW:"container.xl",py:8,children:e.jsxs(x,{spacing:8,align:"stretch",children:[e.jsxs(d,{children:[e.jsxs(m,{size:"xl",mb:4,children:["Actions & State Management",e.jsx(w,{ml:3,colorScheme:"forest",children:"Essential"})]}),e.jsx(c,{fontSize:"lg",color:"gray.600",children:"Learn how to define actions and manage state updates in Forestry 4."})]}),e.jsxs(C,{title:"Action Principles",children:[e.jsx(c,{color:"gray.600",children:"Understanding the core principles of actions will help you write better, more maintainable state management code."}),e.jsxs(je,{status:"warning",children:[e.jsx(be,{}),e.jsxs(x,{spacing:2,align:"stretch",children:[e.jsx(c,{fontSize:"sm",fontWeight:"bold",children:"🚨 Forestry is NOT Redux!"}),e.jsxs(c,{fontSize:"sm",children:["Actions don't return the next state iteration. State is changed imperatively with",e.jsx("code",{children:"next"}),", ",e.jsx("code",{children:"set"}),", and ",e.jsx("code",{children:"mutate"}),". Actions don't even have to return anything. When they do return values, it's useful data for the caller (summaries, composites, reporting) - not values that Forestry itself uses."]})]})]}),e.jsxs(je,{status:"info",children:[e.jsx(be,{}),e.jsxs(c,{fontSize:"sm",children:[e.jsx("strong",{children:"Key Rule:"})," Actions must be functions or object methods - NOT arrow functions/lambdas. Arrow functions cannot be properly bound with ",e.jsx("code",{children:"call"})," and will lose their ",e.jsx("code",{children:"this"})," context."]})]}),e.jsx(m,{size:"md",children:"Why not use general functions?"}),e.jsx(x,{spacing:2,align:"stretch",children:e.jsxs(d,{layerStyle:"card",children:[`Actions are not "magic" - they are bound to the state's context like class instance methods but you can if you prefer use `,e.jsx("i",{children:"external functions"})," instead of actions and just pass state as an argument and modify the state from the outside."]})}),e.jsx(m,{size:"md",children:"Can actions be async?"}),e.jsx(x,{spacing:2,align:"stretch",children:e.jsxs(d,{layerStyle:"card",children:["Yes - even external ones can be async. However a few considerations:",e.jsxs("ul",{children:[e.jsxs("li",{children:["Transactions cannot contain async actions. Its just not tenable to implement rollback and async behavior in the same system. however you can call (sync) transactions from ",e.jsx("i",{children:"inside"})," an async function."]}),e.jsx("li",{children:"You may find it slightly more work to test external functions."}),e.jsx("li",{children:'You can use external "helper functions" like lodash utilities, inside an action provided they can handle immutable inputs'})]})]})}),e.jsx(m,{size:"md",children:"What is an action?"}),e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsxs(d,{layerStyle:"card",children:[e.jsx(c,{fontWeight:"semibold",mb:2,children:"Actions Have Two Purposes"}),e.jsxs("ul",{children:[e.jsxs(c,{fontSize:"sm",as:"li",children:[e.jsx("strong",{children:"State Mutation:"})," Update the store's value using mutate, set, or next"]}),e.jsxs(c,{fontSize:"sm",as:"li",children:[e.jsx("strong",{children:"Selectors/Computed Values:"})," you can express summary or portions of state out of actions and return it to the calling context."]})]})]}),e.jsxs(d,{layerStyle:"card",bg:"gray.50",children:[e.jsx(c,{fontWeight:"semibold",mb:2,children:"Actions are bound to the Store"}),e.jsxs(c,{fontSize:"sm",children:[e.jsx("code",{children:"this"})," in actions refers to the store itself. You can use"," ",e.jsx("code",{children:"this.$"}),",",e.jsx("code",{children:"this.set"}),", ",e.jsx("code",{children:"this.next"}),","," ",e.jsx("code",{children:"this.value"}),", etc."]})]})]}),e.jsx(m,{size:"md",children:"The Value parameter"}),e.jsx(x,{spacing:2,align:"stretch",children:e.jsx(d,{layerStyle:"card",children:e.jsxs(c,{fontSize:"sm",children:["The first parameter ",e.jsx("code",{children:"value"})," is the state's value property,"," ",e.jsx("i",{children:"when the action started"})," . If your action changes state and you want to get the most current version of state, examine ",e.jsx("code",{children:"this.value"})," or"," ",e.jsx("code",{children:"this.get('path')"})," to get the latest state value.",e.jsx("br",{}),e.jsx("br",{}),"You ",e.jsx("i",{children:"must"})," add it as the first parameter in your action, but when you"," ",e.jsx("i",{children:"call"})," your action, you don't have to add it in - Forestry will automatically prepend it to any input arguments internally.",e.jsx(M,{snippetName:"counter-example",folder:"actions-state",language:"typescript",ts:!0})]})})}),e.jsx(m,{size:"md",children:"How to update state"}),e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsxs(je,{status:"info",children:[e.jsx(be,{}),e.jsxs(c,{fontSize:"sm",children:["Unlike Redux, ",e.jsx("strong",{children:"the return value of actions does NOT update state"}),". Updating state is done imperatively by calling state methods."]})]}),e.jsx(G,{title:"set(path: string | string[], value: any): void",titleAsCode:!0,snippetName:"set-examples",snippetFolder:"actions-state",language:"typescript",ts:!0,children:"Sets a property in the state structure with a new value. Path can be a string or dot-separated deep path."}),e.jsx(G,{title:"mutate(updater: (draft: T) => void | T): void",titleAsCode:!0,snippetName:"mutate-examples",snippetFolder:"actions-state",language:"typescript",ts:!0,children:"Allows you to edit the state as a normal mutable JavaScript object using Immer's produce function."}),e.jsx(G,{title:"next(value: T): void",titleAsCode:!0,snippetName:"next-examples",snippetFolder:"actions-state",language:"typescript",ts:!0,children:"Replaces the entire state with a new value. Generally the least useful method - prefer set() or mutate() for most cases."})]})]}),e.jsxs(C,{title:"Action Patterns in Practice",children:[e.jsx(d,{layerStyle:"card",children:e.jsx(c,{children:"Practical examples showing the recommended patterns for different types of state updates."})}),e.jsxs(X,{columns:{base:1,lg:2},spacing:6,children:[e.jsxs(d,{children:[e.jsx(m,{size:"md",mb:3,children:"Actions can call othe ractions"}),e.jsx(c,{color:"gray.600",mb:4,children:"High-level actions that orchestrate multiple tactical operations."}),e.jsx(M,{language:"typescript",snippetName:"strategicActions",folder:"ActionsState"})]}),e.jsxs(d,{children:[e.jsx(m,{size:"md",mb:3,children:"Tactical Actions"}),e.jsx(c,{color:"gray.600",mb:4,children:"Low-level, reusable utilities that handle specific mutations."}),e.jsx(M,{language:"typescript",snippetName:"tacticalActions",folder:"ActionsState"})]})]})]}),e.jsxs(C,{title:"Interactive Actions Demo",children:[e.jsx(c,{color:"gray.600",children:"Try different action patterns and see how they update the state:"}),e.jsx(Jc,{})]}),e.jsxs(C,{title:"Complete Source Code",children:[e.jsx(c,{color:"gray.600",children:"Here's the complete implementation of the actions demo above:"}),e.jsx(de,{tabs:[{label:"Store Definition",language:"typescript",snippet:"storeDefinition",folder:"ActionsState"},{label:"React Integration",language:"tsx",snippet:"reactIntegrationDemo",folder:"ActionsState"},{label:"Action Patterns",language:"typescript",snippet:"actionPatterns",folder:"ActionsState"}]})]}),e.jsx(C,{title:"Action Best Practices",children:e.jsxs(X,{columns:{base:1,lg:2},spacing:6,children:[e.jsxs(d,{children:[e.jsx(m,{size:"md",mb:3,color:"green.600",children:"✅ Best Practices for Actions"}),e.jsxs(x,{spacing:3,align:"stretch",children:[e.jsxs(d,{p:3,bg:"green.50",borderRadius:"md",children:[e.jsx(c,{fontWeight:"semibold",children:"Keep actions focused"}),e.jsx(c,{fontSize:"sm",color:"gray.600",children:"One action should do one thing well; take advantage of nested actions to break up complex behaviors into several small helpers"})]}),e.jsxs(d,{p:3,bg:"green.50",borderRadius:"md",children:[e.jsx(c,{fontWeight:"semibold",children:"Compose with nested actions"}),e.jsxs(c,{fontSize:"sm",color:"gray.600",children:[e.jsx("code",{children:"this.$.otherAction()"})," for reusability"]})]}),e.jsxs(d,{p:3,bg:"green.50",borderRadius:"md",children:[e.jsx(c,{fontWeight:"semibold",children:"Use actions in place of hooks or wrappers"}),e.jsxs(c,{fontSize:"sm",color:"gray.600",children:["Because actions are bound to store context you can use them directly to respond to events - you don't have to wrap them in lambdas or ",e.jsx("code",{children:"useCallback"}),". You can write actions to deconstruct events and pass them directly to"," ",e.jsx("code",{children:"onChange(state.$.onFieldChange"}),". You can even attach data-keys to qualify the behavior of the actions to reduce having to write new handlers for each event use case."]})]})]})]}),e.jsxs(d,{children:[e.jsx(m,{size:"md",mb:3,color:"red.600",children:"❌ Things that won't work"}),e.jsxs(x,{spacing:3,align:"stretch",children:[e.jsxs(d,{p:3,bg:"red.50",borderRadius:"md",children:[e.jsx(c,{fontWeight:"semibold",children:"You cannot edit the value parameter"}),e.jsxs(c,{fontSize:"sm",color:"gray.600",children:["the value parameter ",e.jsx("i",{children:"and"})," ",e.jsx("code",{children:"this.value"})," are both",e.jsx("a",{href:"https://immerjs.github.io/immer/",children:"Immer"})," immutables that"," ",e.jsx("i",{children:"cannot be edited"}),' - this is even "more const than const";',e.jsx("code",{children:"Map.set"})," or ",e.jsx("code",{children:"array.push/pop/etc"})," do not work on values. (this by the way is also true of Redux Toolkit actions).",e.jsx("br",{}),e.jsx("br",{}),"The ",e.jsx("code",{children:".mutate(lambda)"})," method is how you can directly edit state value."]})]}),e.jsxs(d,{p:3,bg:"red.50",borderRadius:"md",children:[e.jsx(c,{fontWeight:"semibold",children:"Actions cannot be arrow functions (lambdas)"}),e.jsxs(c,{fontSize:"sm",color:"gray.600",children:["you cannot bind or change a lambdas' definiton of this so actions cannot be bound to state from the constructor definitions: eg.,",e.jsx(M,{snippetName:"arrow-function-antipattern",folder:"actions-state",language:"typescript",ts:!0}),'will not give you the desired result as "this" will not be the store.']})]})]})]})]})})]})}),Kc=()=>e.jsx(C,{children:e.jsxs(x,{layerStyle:"section",children:[e.jsx(m,{size:"lg",children:"Integration Patterns"}),e.jsx(c,{textStyle:"body",children:"Forestry 4 integrates seamlessly with React using standard hooks and patterns."}),e.jsxs(d,{width:"full",children:[e.jsx(m,{size:"md",mb:3,children:"Hook Usage"}),e.jsx(c,{textStyle:"body",children:"Use Forestry hooks to connect stores to React components."}),e.jsx(M,{language:"typescript",snippetName:"forestryHooks",folder:"ReactIntegration"})]})]})}),Xc=()=>e.jsx(C,{children:e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsx(m,{size:"lg",children:"Live Todo App Demo"}),e.jsx(c,{color:"gray.600",children:"A complete todo app showing React + Forestry 4 integration patterns:"}),e.jsx(Bt,{})]})}),Qc=()=>e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsx(C,{title:"React Hook Patterns",children:e.jsxs(d,{children:[e.jsx(m,{size:"md",mb:3,children:"Forestry Hook Source Code"}),e.jsx(c,{textStyle:"body",children:"Here are the complete implementations of Forestry's React integration hooks:"}),e.jsxs(x,{layerStyle:"section",align:"stretch",width:"full",children:[e.jsxs(d,{children:[e.jsx(c,{fontWeight:"bold",mb:2,children:"useForestryLocal - Local Store Management"}),e.jsx(c,{textStyle:"description",children:"Creates and manages a store instance using useRef pattern, returns [value, store]"}),e.jsx(M,{language:"typescript",snippetName:"useForestryLocalSource",folder:"ReactIntegration"})]}),e.jsxs(d,{children:[e.jsx(c,{fontWeight:"bold",mb:2,children:"useObserveForest - External Store Observation"}),e.jsx(c,{textStyle:"description",children:"Observes an existing store/forest instance, returns just the value"}),e.jsx(M,{language:"typescript",snippetName:"useObserveForestSource",folder:"ReactIntegration"})]})]})]})}),e.jsxs(C,{title:"Referential Integrity with Immer",children:[e.jsx(c,{textStyle:"body",children:"Forestry uses Immer internally, which ensures that any changed value is always referentially unique. This means you can trust any component of state to drive useEffect dependencies correctly."}),e.jsx(M,{language:"typescript",snippetName:"referentialIntegrity",folder:"ReactIntegration"}),e.jsxs(je,{status:"info",mt:4,children:[e.jsx(be,{}),e.jsxs(d,{children:[e.jsx(c,{fontWeight:"bold",children:"Key Benefit:"}),e.jsx(c,{children:"Unlike manual state management where you might accidentally mutate objects and break React's dependency system, Forestry eliminates this entire class of bugs through Immer's referential integrity."})]})]})]})]}),el=()=>e.jsx(C,{children:e.jsxs(x,{layerStyle:"section",children:[e.jsx(m,{size:"lg",children:"Complete Source Code"}),e.jsx(c,{textStyle:"body",children:"Here's the complete implementation of the todo app above:"}),e.jsx(de,{tabs:[{label:"Store Factory",language:"typescript",snippet:"todoStoreFactory",folder:"ReactIntegration"},{label:"React Component",language:"tsx",snippet:"todoAppComponent",folder:"ReactIntegration"}]})]})}),tl=()=>e.jsx(C,{children:e.jsxs(x,{layerStyle:"section",children:[e.jsx(m,{size:"lg",children:"React Integration Best Practices"}),e.jsx(c,{children:'React is "quirky" about some features; the hooks above take care of all these concerns but if you plan to integrate Forestry with your own code or custom hooks follow these guidelines.'}),e.jsxs(X,{columns:{base:1,lg:2},spacing:6,children:[e.jsxs(d,{children:[e.jsx(m,{size:"md",mb:3,color:"green.600",children:"✅ Best Practices"}),e.jsxs(x,{layerStyle:"section",spacing:3,align:"stretch",children:[e.jsxs(d,{p:3,bg:"green.50",borderRadius:"md",children:[e.jsx(c,{fontWeight:"semibold",children:"Use Forestry hooks to reduce blend boilerplate"}),e.jsx(c,{fontSize:"sm",color:"gray.600",children:"You can subscribe in useEffect and store stores in ref -- but the hooks take care of a lot of housekeeping. At this point the hooks are not in the component - you'll have to bring the in, because it frees you to use your current react version (or Preact or whatever)"})]}),e.jsxs(d,{p:3,bg:"green.50",borderRadius:"md",children:[e.jsx(c,{fontWeight:"semibold",children:"Trust referential integrity"}),e.jsx(c,{fontSize:"sm",color:"gray.600",children:"given all parts of a store changes when part of it changes, you can trust any part of the store in dependency arrays to properly trigger useEffect"})]}),e.jsxs(d,{p:3,bg:"green.50",borderRadius:"md",children:[e.jsx(c,{fontWeight:"semibold",children:"Diminish Hooks whenever possible"}),e.jsx(c,{fontSize:"sm",color:"gray.600",children:"Using store values or selector actions reduces the number of callbacks or memos you have to put in your component body."})]}),e.jsxs(d,{p:3,bg:"green.50",borderRadius:"md",children:[e.jsx(c,{fontWeight:"semibold",children:"Pass whole stores via context or params"}),e.jsx(c,{fontSize:"sm",color:"gray.600",children:"Rather than deconstructing actions or values down deep paths, pass the whole store and its value down or through context."})]})]})]}),e.jsxs(d,{children:[e.jsx(m,{size:"md",mb:3,color:"red.600",children:"❌ Things that will not work well"}),e.jsxs(x,{layerStyle:"section",spacing:3,align:"stretch",children:[e.jsxs(d,{p:3,bg:"red.50",borderRadius:"md",children:[e.jsx(c,{fontWeight:"semibold",children:"Mutate store values directly"}),e.jsx(c,{fontSize:"sm",color:"gray.600",children:"Immer won't let you do that - use mutate or set to alter parts or all of the store value."})]}),e.jsxs(d,{p:3,bg:"red.50",borderRadius:"md",children:[e.jsx(c,{fontWeight:"semibold",children:"Create stores in component function body"}),e.jsx(c,{fontSize:"sm",color:"gray.600",children:"If you don't use the factory hooks, create stores in memos or via careful use of refs."})]})]})]})]})]})}),nl=()=>e.jsx(ie,{maxW:"container.xl",py:8,children:e.jsxs(x,{layerStyle:"section",spacing:8,children:[e.jsxs(d,{children:[e.jsx(m,{size:"xl",mb:4,children:"React Integration"}),e.jsx(c,{fontSize:"lg",color:"gray.600",children:"Learn how to integrate Forestry 4 stores with React components and hooks."})]}),e.jsx(Kc,{}),e.jsx(Xc,{}),e.jsx(Qc,{}),e.jsx(el,{}),e.jsx(tl,{})]})});function Ht(){const t=Rt(),n=ee.useCallback((i,o)=>{const a=typeof i=="string"?i:i.message;t({title:o||"Validation Error",description:a,status:"error",duration:4e3,isClosable:!0})},[t]),r=ee.useCallback((i,o)=>{t({title:o||"Success",description:i,status:"success",duration:3e3,isClosable:!0})},[t]),s=ee.useCallback((i,o)=>{t({title:o||"Warning",description:i,status:"warning",duration:4e3,isClosable:!0})},[t]);return{handleError:n,handleSuccess:r,handleWarning:s}}const Oe=[{id:"laptop",name:"Gaming Laptop",price:1299.99,inStock:5},{id:"mouse",name:"Wireless Mouse",price:49.99,inStock:20},{id:"keyboard",name:"Mechanical Keyboard",price:129.99,inStock:8}];class rl extends he{constructor(n){super({name:"shopping-cart",value:{items:[],totalCost:0},tests:[function(r){const s=r.items.map(o=>o.productId),i=new Set(s);return s.length!==i.size?"Cannot have the same product multiple times in cart - use quantity instead":null},r=>r.items.filter(i=>i.quantity<=0).length>0?"Cart cannot contain items with zero or negative quantities":null,r=>r.items.filter(i=>!Oe.find(o=>o.id===i.productId)).length>0?"Cart contains products that no longer exist":null,function(r){return r.items.filter(i=>{const o=Oe.find(a=>a.id===i.productId);return o&&i.quantity>o.inStock}).length>0?"Cannot add more items than available in stock":null},function(r){const s=r.items.reduce((i,o)=>{const a=Oe.find(l=>l.id===o.productId);return i+(a?a.price*o.quantity:0)},0);return Math.abs(r.totalCost-s)>.01?"Total cost calculation is incorrect - financial integrity violation":null},function(r){return r.items.reduce((i,o)=>i+o.quantity,0)>100?"Cart cannot contain more than 100 total items":null}]}),this.handleError=n}addItem(n,r){const s=this.value.items.findIndex(i=>i.productId===n);this.mutate(i=>{s>=0?i.items[s].quantity+=r:i.items.push({productId:n,quantity:r})})}addItemFromEvent(n){const r=n.currentTarget,s=r.dataset.productId,i=parseInt(r.dataset.quantity||"1");if(!s){console.error("addItemFromEvent: missing data-product-id attribute");return}this.addItem(s,i)}removeItem(n){this.mutate(r=>{r.items=r.items.filter(s=>s.productId!==n)})}updateQuantity(n,r){this.mutate(s=>{const i=s.items.find(o=>o.productId===n);i&&(i.quantity=r)})}updateProduct(n,r){this.updateQuantity(n,r)}clearCart(){this.mutate(n=>{n.items=[],n.totalCost=0})}safeAddItemFromEvent(n){if(!this.handleError)return this.addItemFromEvent(n);try{this.addItemFromEvent(n)}catch(r){this.handleError(r,"Cannot Add Item")}}safeUpdateQuantity(n,r){if(!this.handleError)return this.updateQuantity(n,r);try{this.updateQuantity(n,r)}catch(s){this.handleError(s,"Cannot Update Quantity")}}safeUpdateProduct(n,r){if(!this.handleError)return this.updateProduct(n,r);try{this.updateProduct(n,r)}catch(s){this.handleError(s,"Cannot Update Quantity")}}safeAddItem(n,r){if(!this.handleError)return this.addItem(n,r);try{this.addItem(n,r)}catch(s){this.handleError(s,"Cannot Add Item")}}prep(n,r){const s=n.items||r.items,i=s.reduce((o,a)=>{const l=Oe.find(u=>u.id===a.productId);return o+(l?l.price*a.quantity:0)},0);return{items:s,totalCost:i}}}function sl(t){return new rl(t)}const Ct=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),il=()=>{const{handleError:t}=Ht(),[n,r]=ye(sl,t);return e.jsxs(X,{columns:{base:1,lg:2},spacing:6,children:[e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsx(m,{size:"md",children:"Available Products"}),Oe.map(s=>e.jsx(d,{p:3,border:"1px",borderColor:"gray.200",borderRadius:"md",children:e.jsxs($,{justify:"space-between",children:[e.jsxs(x,{align:"start",spacing:1,children:[e.jsx(c,{fontWeight:"semibold",children:s.name}),e.jsxs(c,{fontSize:"sm",color:"gray.600",children:["$",s.price]}),e.jsxs(c,{fontSize:"xs",color:"gray.500",children:["Stock: ",s.inStock]})]}),e.jsx(O,{size:"sm",colorScheme:"forest","data-product-id":s.id,"data-quantity":"1",onClick:r.$.safeAddItemFromEvent,children:"Add to Cart"})]})},s.id)),e.jsxs(X,{columns:{base:1,md:2},spacing:3,children:[e.jsx(O,{colorScheme:"red",variant:"outline",size:"sm","data-product-id":"invalid-product","data-quantity":"1",onClick:r.$.safeAddItemFromEvent,children:"Add Invalid Product"}),e.jsx(O,{colorScheme:"red",variant:"outline",size:"sm","data-product-id":"laptop","data-quantity":"10",onClick:r.$.safeAddItemFromEvent,children:"Exceed Stock"})]})]}),e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsxs($,{justify:"space-between",children:[e.jsx(m,{size:"md",children:"Shopping Cart"}),e.jsx(O,{colorScheme:"red",variant:"outline",onClick:r.$.clearCart,children:"Clear Cart"})]}),n.items.length===0?e.jsx(c,{color:"gray.500",textAlign:"center",py:4,children:"Cart is empty"}):e.jsxs(x,{spacing:3,align:"stretch",children:[n.items.map(s=>{const i=Oe.find(l=>l.id===s.productId),o=i?i.price:0,a=s.quantity*o;return e.jsxs(d,{p:3,children:[e.jsxs($,{justify:"space-between",children:[e.jsx(x,{align:"start",spacing:1,children:e.jsxs($,{children:[e.jsx(Dn,{colorScheme:"red",onClick:()=>r.$.removeItem(s.productId)}),e.jsx(c,{fontWeight:"semibold",children:i?i.name:`Unknown (${s.productId})`})]})}),e.jsx($,{spacing:2,children:e.jsx(Zr,{size:"sm",value:s.quantity,min:0,width:"100px",style:{textAlign:"right"},onChange:l=>{const u=parseInt(l)||0;r.$.safeUpdateProduct(s.productId,u)},children:e.jsx(Rr,{textAlign:"right"})})})]}),e.jsxs($,{width:"full",justify:"space-between",children:[e.jsxs(c,{fontSize:"sm",color:"gray.600",children:[Ct.format(o)," each"]}),e.jsx(c,{fontSize:"sm",color:"gray.600",children:Ct.format(a)})]})]},s.productId)}),e.jsxs($,{width:"full",justify:"space-between",px:4,children:[e.jsx(c,{children:"Total:"}),e.jsxs(c,{fontWeight:800,children:[" $",Ct.format(n.totalCost)]})]})]})]})]})},mr=()=>e.jsx(C,{children:e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsx(il,{}),e.jsxs(d,{children:[e.jsx(m,{size:"md",mb:4,children:"Source Code - Error Handling with Toasts"}),e.jsx(c,{color:"gray.600",mb:4,children:"Here's how to implement global error handling with Chakra UI toasts for validation errors:"}),e.jsx(de,{tabs:[{label:"Demo Component",language:"tsx",snippet:"shopping-cart-demo-component"},{label:"Store Factory",language:"typescript",snippet:"shoppingCartStoreFactory"},{label:"Schema & Validation",language:"typescript",snippet:"shopping-cart-schema-validation"},{label:"Unit Tests",language:"typescript",snippet:"shopping-cart-example-tests"}]})]})]})}),qt=t=>ge({value:t,isDirty:oe(),error:P().nullable(),title:P(),type:P()}),mt=qt(P()),gr=qt(ue());qt(oe());const ol=ge({username:mt,email:mt,age:gr,isSubmitting:oe(),canSubmit:oe(),submitError:P()}),Fn={username:{value:"",isDirty:!1,error:null,title:"Username",type:"text"},email:{value:"",isDirty:!1,error:null,title:"Email",type:"email"},age:{value:0,isDirty:!1,error:null,title:"Age",type:"number"},isSubmitting:!1,canSubmit:!1,submitError:""};class al extends he{constructor(n,r){super({name:"advanced-form",schema:ol,value:Fn,res:new Map([["handleError",n],["handleSuccess",r]]),prep:(s,i)=>{const o={...i,...s},a=!!o.username.error,l=!!o.email.error,u=!!o.age.error,h=a||l||u,z=o.username.value.length>0,v=o.email.value.length>0,R=o.age.value>0;return z&&v&&R?h?(o.canSubmit=!1,o.submitError="Please fix validation errors before submitting"):(o.canSubmit=!0,o.submitError=""):(o.canSubmit=!1,o.submitError="Please fill out all fields"),o},tests:[s=>s.username.value==="admin"&&s.email.value.includes("admin")?"Username and email combination already exists":null]})}setSubmitting(n){this.set("isSubmitting",!!n)}onChange(n){const{name:r,value:s,type:i}=n.target,o=i==="number"?parseInt(s)||0:s;this.set([r,"value"],o)}reset(){this.next(Fn)}get isFormValid(){return!this.value.username.error&&!this.value.email.error&&!this.value.age.error}get canSubmit(){return this.value.canSubmit&&!this.value.isSubmitting}get isFormFilled(){return this.value.username.value.length>0&&this.value.email.value.length>0&&this.value.age.value>0}submit(){if(!this.canSubmit)return this.$res.get("handleError")?.("you cannot submit data","Submission Blocked");this.set("isSubmitting",!0),this.$res.get("handleSuccess")?.("Your data has been submitted","Sim Submit");const n=this;setTimeout(()=>{n.reset()},2e3)}get hasErrors(){return!this.isFormValid}get isDirty(){return this.value.username.isDirty||this.value.email.isDirty||this.value.age.isDirty}}function cl(t,n){return new al(t,n)}const ll=[t=>t.length<3?"Username too short (min 3 characters)":null,t=>t.length>20?"Username too long (max 20 characters)":null,t=>t.includes(" ")?"Username cannot contain spaces":null,t=>["admin","root","system","api","null","undefined"].includes(t.toLowerCase())?"Username is reserved and cannot be used":null,t=>["spam","test123","delete","hack"].some(r=>t.toLowerCase().includes(r))?"Username contains inappropriate content":null];class dl extends he{constructor(n){super({...n,prep:(r,s)=>{const i={...s,...r};this.$res.has("initialValue")||this.$res.set("initialValue",s.value);const o=this.$res.get("initialValue");i.isDirty||(i.isDirty=i.value!==o);let a=null;if(i.isDirty)for(const l of ll){const u=l(i.value);if(u){a=u;break}}return i.error=a,i}})}setFromEvent(n){this.$root?.value?.isSubmitting||this.setValue(n.target.value)}setValue(n){this.$root?.value?.isSubmitting||this.mutate(r=>{r.value=n,r.isDirty=!0})}clear(){this.$root?.value?.isSubmitting||this.setValue("")}get isValidLength(){const n=this.value.value.length;return n>=3&&n<=20}get isAvailable(){return!["admin","root","system","api","null","undefined"].includes(this.value.value.toLowerCase())}}function ul(){return{subclass:dl,schema:mt}}const hl=[t=>t.length>100?"Email too long (max 100 characters)":null,t=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)?null:"Invalid email format",t=>{const n=t.split("@")[1]?.toLowerCase();return n&&["10minutemail.com","tempmail.org","guerrillamail.com","mailinator.com"].includes(n)?"Disposable email addresses are not allowed":null},t=>{const n=t.split("@")[1]?.toLowerCase();return n&&["competitor.com","blocked-company.com"].includes(n)?"Email domain is not allowed for registration":null}];class pl extends he{constructor(n){super({...n,prep:(r,s)=>{const i={...s,...r};this.$res.has("initialValue")||this.$res.set("initialValue",s.value);const o=this.$res.get("initialValue");i.isDirty||(i.isDirty=i.value!==o);let a=null;if(i.isDirty)for(const l of hl){const u=l(i.value);if(u){a=u;break}}return i.error=a,i}})}setFromEvent(n){this.$root?.value?.isSubmitting||this.setValue(n.target.value)}setValue(n){this.$root?.value?.isSubmitting||this.mutate(r=>{r.value=n,r.isDirty=!0})}clear(){this.$root?.value?.isSubmitting||this.setValue("")}get domain(){const r=this.value.value.split("@");return r.length===2?r[1].toLowerCase():null}get isValidFormat(){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.value.value)}get isDisposable(){const n=this.domain;return n?["10minutemail.com","tempmail.org","guerrillamail.com","mailinator.com"].includes(n):!1}get isRestricted(){const n=this.domain;return n?["competitor.com","blocked-company.com"].includes(n):!1}}function ml(){return{subclass:pl,schema:mt}}const gl=[t=>Number.isFinite(t)?null:"Please enter a valid number",t=>t<0?"Age cannot be negative":null,t=>Number.isInteger(t)?null:"Age must be a whole number",t=>t<13?"Users under 13 cannot create accounts due to COPPA regulations":null,t=>t>120?"Age must be realistic (max 120)":null];class fl extends he{constructor(n){super({...n,prep:(r,s)=>{const i={...s,...r};this.$res.has("initialValue")||this.$res.set("initialValue",s.value);const o=this.$res.get("initialValue");i.isDirty||(i.isDirty=i.value!==o);let a=null;if(i.isDirty)for(const l of gl){const u=l(i.value);if(u){a=u;break}}return i.error=a,i}})}setFromEvent(n){if(this.$root?.value?.isSubmitting)return;const r=parseInt(n.target.value)||0;this.setValue(r)}setValue(n){this.$root?.value?.isSubmitting||this.mutate(r=>{r.value=n,r.isDirty=!0})}clear(){this.$root?.value?.isSubmitting||this.setValue(0)}increment(){this.$root?.value?.isSubmitting||this.setValue(this.value.value+1)}decrement(){this.$root?.value?.isSubmitting||this.value.value>0&&this.setValue(this.value.value-1)}get isMinor(){return this.value.value<18}get isSenior(){return this.value.value>=65}get isValidForRegistration(){return this.value.value>=13&&this.value.value<=120}get ageGroup(){const n=this.value.value;return n<0||n>120?"invalid":n<13?"child":n<18?"teen":n<65?"adult":"senior"}}function xl(){return{subclass:fl,schema:gr}}function jl(t,n,r,...s){const i=ee.useRef(null);if(!i.current&&t&&typeof t?.$branch=="function"){const l=r(...s);i.current=t.$branch(n,l)}else i.current||console.error("bad store ",t);const[o,a]=ee.useState(i.current?.value);return ee.useEffect(()=>{if(i.current){const l=i.current.subscribe(a);return()=>{l?.unsubscribe()}}},[i.current]),[o??i.current?.value,i.current]}function Ft({parentStore:t,path:n,branchFactory:r,type:s,placeholder:i}){const[o,a]=jl(t,n,r),l=o.error!==null,u=l?"red.300":"gray.200",h=!!a.$root?.value?.isSubmitting;return e.jsxs(d,{children:[e.jsx(c,{mb:2,fontWeight:"semibold",children:o.title}),e.jsx($e,{type:s,value:o.value,onChange:a.$.setFromEvent,borderColor:u,placeholder:i,disabled:h,opacity:h?.6:1,cursor:h?"not-allowed":"text"}),l&&e.jsx(c,{fontSize:"sm",color:"red.500",mt:1,children:o.error}),h&&e.jsx(c,{fontSize:"sm",color:"blue.500",mt:1,children:"Form is submitting..."})]})}const fr=()=>{const{handleSuccess:t,handleError:n}=Ht(),[r,s]=ye(cl,n,t);return e.jsx(C,{children:e.jsxs(X,{columns:{base:1,lg:2},spacing:6,children:[e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsx(m,{size:"md",children:"Form Fields"}),e.jsx(Ft,{parentStore:s,path:"username",branchFactory:ul,placeholder:"Enter username"}),e.jsx(Ft,{parentStore:s,path:"email",branchFactory:ml,placeholder:"Enter email address"}),e.jsx(Ft,{parentStore:s,path:"age",branchFactory:xl,placeholder:"Enter age"}),e.jsx(x,{spacing:3,align:"stretch",children:e.jsx(O,{colorScheme:"forest",isDisabled:!r.canSubmit,onClick:()=>s.submit(),isLoading:r.isSubmitting,children:"Submit Form"})})]}),e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsx(m,{size:"md",children:"Form State"}),e.jsxs(d,{p:4,bg:"gray.50",borderRadius:"md",fontFamily:"mono",fontSize:"sm",children:[e.jsx(c,{mb:2,fontWeight:"semibold",children:"Current Values:"}),e.jsxs(c,{children:['Username: "',r.username.value,'"']}),e.jsxs(c,{children:['Email: "',r.email.value,'"']}),e.jsxs(c,{children:["Age: ",r.age.value]})]}),e.jsxs(d,{p:4,bg:"gray.50",borderRadius:"md",fontFamily:"mono",fontSize:"sm",children:[e.jsx(c,{mb:2,fontWeight:"semibold",children:"Form Status:"}),e.jsxs($,{children:[e.jsx(c,{children:"Can Submit:"}),e.jsx(w,{colorScheme:r.canSubmit?"green":"orange",children:r.canSubmit?"Yes":"No"})]}),e.jsxs($,{children:[e.jsx(c,{children:"Submitting:"}),e.jsx(w,{colorScheme:r.isSubmitting?"blue":"gray",children:r.isSubmitting?"Yes":"No"})]})]})]})]})})},bl=()=>e.jsx(C,{children:e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsx(m,{size:"lg",children:"Deeper Thoughts - Validation Troubleshooting Guide"}),e.jsx(c,{children:'There are basically two modes of validation - "hard" validation that prevents certain patterns from ever appearing in state and "soft" validation in which errors and gates change based on the validity of certain field(s).'}),e.jsxs(c,{as:"ul",size:"sm",children:[e.jsxs("li",{children:[e.jsx("b",{children:"Hard Validation"})," is managed in three different ways in Forest. Every new value candidate goes through these",e.jsxs("ol",{children:[e.jsxs("li",{children:[e.jsx("code",{children:".pre"}),' - a function that "filters" or fixes bad data; it occurs before tests are ran. It accepts a candidate value and returns a (potentially fixed) value. The purpose of pre is to catch "correctable" errors like data sorting, stringy numbers, or other minor flaws in prospective data. it is not ',e.jsx("i",{children:"technically"}),' a validator but it may prevent "mostly good" changes from being blocked on correctable issues']}),e.jsxs("li",{children:[e.jsx("code",{children:".schema"})," - managed by she schema property in the constructor params, it defines a Zod instance to define a schema that the state must follow; its basically parametric typescript - but unlike TS it is actually an enforced ruleset in React that dynamically blocks bad data from being entered in state."]}),e.jsxs("li",{children:[e.jsx("code",{children:".tests"})," - a function or array of functions that if they return a string or throw, prevent bad data from being saved into state; these test errors will throw to the outer scope; you may want to put catchers around code that might trigger tests. if tests is an array of functions, they are executed in order and any failure blocks subsequent tests from running."]})]})]}),e.jsxs("li",{children:[e.jsx("b",{children:"Soft Validation"}),' is encoded in pre or in actions to assert "annotation" on the state as a whole or specific fields; it is the sort of thing you expect to work with forms where the user is not prevented from entering a bad data, but they are'," ",e.jsx("i",{children:"infrormed"})," about the state of their field or form with error messages. Obviously, for this to work both the bad data and the error message (and potentially an isValid boolean) exist for every field and potentially the form as a whole. there are two ways of doing this - embedding these properties in state or writing actions such as",e.jsxs("code",{children:["isValid(value, fieldName, fieldValue): ","{isValid: boolean, error? string}"," "]}),"or ",e.jsxs("code",{children:["isEmailValid(): ","{isValid: boolean, error? string}"]})]})]}),e.jsxs(d,{layerStyle:"infoBox",bg:"blue.50",children:[e.jsx(m,{size:"sm",children:"🤔 In short:"}),e.jsxs(x,{spacing:2,align:"start",fontSize:"sm",children:[e.jsxs(c,{children:[e.jsx("strong",{children:'Transient ("soft") UI Feedback/ data correction'})," → Use"," ",e.jsx(K,{children:"prep"}),"functions or feedback actions."]}),e.jsxs(c,{children:[e.jsx("strong",{children:"Type Safety, data prefiltering / sanitation?"})," → Use ",e.jsx(K,{children:"Zod"})," ",'schema validation for "dynamic typescript like" format enforcement']}),e.jsxs(c,{children:[e.jsx("strong",{children:"Complex Business Rules?"})," → Use ",e.jsx(K,{children:"tests"})," function(s)"]})]}),e.jsxs(c,{size:"sm",children:["again - data updating occurs ",e.jsx("b",{children:"in this order"}),"; if it matters, for instance, you can trust that your candidates conform to your schema before executing your tests."]})]}),e.jsxs(d,{layerStyle:"infoBox",bg:"gray.50",children:[e.jsx(m,{size:"sm",children:"📚 Complete Example - All Three Layers:"}),e.jsx(c,{fontSize:"sm",mb:3,children:"A shopping cart that uses Zod for structure, tests for business rules, and prep for UI state:"}),e.jsx(M,{snippetName:"shoppingCartValidation",folder:"ValidationSystem"})]}),e.jsxs(d,{layerStyle:"infoBox",bg:"gray.50",children:[e.jsx(m,{size:"sm",children:"Do I have to use Zod?"}),e.jsx(c,{children:"Technically the schema parameter expects an object with a parse(value) method that throws on bad code. If you don't want to pull in Zod you can put any other / a custom parser in to schema as long as it exposes a parse method; if it doesn't create an object and a parse method and enclose your validator inside of it. (FWIW Zod is not bundled with Forestry so this option may appeal if you are fanatic about bundle size reduction.)"})]})]})}),yl=()=>e.jsx(ie,{maxW:"container.xl",py:8,children:e.jsxs(x,{spacing:8,align:"stretch",children:[e.jsxs(d,{children:[e.jsx(m,{size:"xl",mb:4,children:"Validation System"}),e.jsx(c,{fontSize:"lg",color:"gray.600",children:"Learn about Forestry 4's comprehensive validation system with practical examples of schema validation, business logic tests, and UI state management."})]}),e.jsxs(je,{status:"info",children:[e.jsx(be,{}),e.jsxs(c,{fontSize:"sm",children:[e.jsx("strong",{children:"Three-Layer Validation:"})," Use Zod for type safety, test functions for critical business rules, and prep functions for UI state. Each component below demonstrates these patterns in action."]})]}),e.jsx(mr,{}),e.jsx(fr,{}),e.jsx(bl,{})]})}),vl=()=>e.jsx(d,{maxW:"6xl",mx:"auto",p:6,children:e.jsxs(x,{spacing:8,align:"stretch",children:[e.jsxs(d,{textAlign:"center",children:[e.jsx(m,{size:"2xl",mb:4,children:"Schema Validation with Zod"}),e.jsx(c,{fontSize:"xl",color:"gray.600",maxW:"3xl",mx:"auto",children:"Use Zod schemas for runtime type validation and enhanced type safety in Forestry stores. Schemas provide structural validation, constraint enforcement, and clear error messages."})]}),e.jsx(C,{children:e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsx(m,{size:"lg",children:"Why Use Zod Schemas?"}),e.jsxs(X,{columns:{base:1,md:2},spacing:6,children:[e.jsxs(d,{layerStyle:"card",bg:"green.50",children:[e.jsx(m,{size:"md",mb:2,color:"green.700",children:"Runtime Validation"}),e.jsx(c,{fontSize:"sm",children:"Catch invalid state structures at runtime, preventing bugs from malformed data that TypeScript alone cannot detect."})]}),e.jsxs(d,{layerStyle:"card",bg:"blue.50",children:[e.jsx(m,{size:"md",mb:2,color:"blue.700",children:"Type Safety"}),e.jsxs(c,{fontSize:"sm",children:["Generate TypeScript types directly from schemas using ",e.jsx(K,{children:"z.infer"}),", ensuring perfect alignment between runtime and compile-time validation."]})]}),e.jsxs(d,{layerStyle:"card",bg:"purple.50",children:[e.jsx(m,{size:"md",mb:2,color:"purple.700",children:"Constraint Enforcement"}),e.jsx(c,{fontSize:"sm",children:"Define business rules like min/max values, string patterns, and array lengths directly in the schema for automatic validation."})]}),e.jsxs(d,{layerStyle:"card",bg:"orange.50",children:[e.jsx(m,{size:"md",mb:2,color:"orange.700",children:"Clear Error Messages"}),e.jsx(c,{fontSize:"sm",children:"Zod provides detailed, human-readable error messages that help developers quickly identify and fix validation issues."})]})]})]})}),e.jsx(C,{children:e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsx(m,{size:"lg",children:"Basic Schema Setup"}),e.jsxs(c,{color:"gray.600",children:["Define your state schema and use it as the ",e.jsx(K,{children:"schema"})," property in Store constructor. Forestry will automatically validate state changes against this schema."]}),e.jsx(M,{language:"typescript",snippetName:"zodSchemaValidation",folder:"ActionsState"})]})}),e.jsx(C,{children:e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsx(m,{size:"lg",children:"Common Schema Patterns"}),e.jsx(de,{tabs:[{label:"Basic Types",language:"typescript",snippet:"basicTypes",folder:"SchemaValidation"},{label:"Complex Objects",language:"typescript",snippet:"complexObjects",folder:"SchemaValidation"},{label:"Arrays & Validation",language:"typescript",snippet:"arraysValidation",folder:"SchemaValidation"},{label:"Conditional Logic",language:"typescript",snippet:"conditionalLogic",folder:"SchemaValidation"}]})]})}),e.jsx(C,{children:e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsx(m,{size:"lg",children:"Integration with Prep Functions"}),e.jsx(c,{color:"gray.600",children:"While schemas handle structural validation, prep functions handle business logic and user input validation. They work together for comprehensive validation."}),e.jsxs(je,{status:"info",children:[e.jsx(be,{}),e.jsxs(d,{children:[e.jsx(c,{fontWeight:"semibold",children:"Schema vs Prep Validation"}),e.jsxs(Dt,{mt:2,spacing:1,children:[e.jsxs(b,{children:[e.jsx("strong",{children:"Schema:"})," Structure, types, constraints (throws errors)"]}),e.jsxs(b,{children:[e.jsx("strong",{children:"Prep:"})," Business rules, user input (sets quality feedback)"]})]})]})]}),e.jsx(M,{language:"typescript",snippetName:"schemaPrepIntegration",folder:"SchemaValidation"})]})}),e.jsx(C,{children:e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsx(m,{size:"lg",children:"Schema Best Practices"}),e.jsxs(X,{columns:{base:1,lg:2},spacing:6,children:[e.jsxs(d,{children:[e.jsx(m,{size:"md",mb:3,color:"green.600",children:"✅ Do"}),e.jsxs(x,{spacing:3,align:"stretch",children:[e.jsxs(d,{layerStyle:"highlight",bg:"green.50",children:[e.jsx(c,{fontWeight:"semibold",children:"Define schemas at factory level"}),e.jsx(c,{fontSize:"sm",color:"gray.600",children:"Create schemas alongside your factory functions for reusability"})]}),e.jsxs(d,{layerStyle:"highlight",bg:"green.50",children:[e.jsx(c,{fontWeight:"semibold",children:"Use meaningful constraints"}),e.jsx(c,{fontSize:"sm",color:"gray.600",children:"Add min/max, patterns, and business-relevant validation rules"})]}),e.jsxs(d,{layerStyle:"highlight",bg:"green.50",children:[e.jsx(c,{fontWeight:"semibold",children:"Infer TypeScript types"}),e.jsxs(c,{fontSize:"sm",color:"gray.600",children:["Use ",e.jsx(K,{children:"z.infer<typeof Schema>"})," for type safety"]})]})]})]}),e.jsxs(d,{children:[e.jsx(m,{size:"md",mb:3,color:"red.600",children:"❌ Don't"}),e.jsxs(x,{spacing:3,align:"stretch",children:[e.jsxs(d,{layerStyle:"highlight",bg:"red.50",children:[e.jsx(c,{fontWeight:"semibold",children:"Duplicate validation logic"}),e.jsx(c,{fontSize:"sm",color:"gray.600",children:"Don't repeat schema constraints in prep functions"})]}),e.jsxs(d,{layerStyle:"highlight",bg:"red.50",children:[e.jsx(c,{fontWeight:"semibold",children:"Over-constrain schemas"}),e.jsx(c,{fontSize:"sm",color:"gray.600",children:"Keep schemas focused on structure, not business rules"})]}),e.jsxs(d,{layerStyle:"highlight",bg:"red.50",children:[e.jsx(c,{fontWeight:"semibold",children:"Ignore schema errors"}),e.jsx(c,{fontSize:"sm",color:"gray.600",children:"Schema validation errors indicate serious structural issues"})]})]})]})]})]})})]})}),Sl=ge({id:P(),amount:ue(),description:P(),timestamp:ue()}),wl=ge({id:P(),name:P(),balance:ue().min(0,"Account balance cannot be negative")}),zl=ge({productId:P(),name:P(),quantity:ue().min(1),price:ue().min(0)}),kl=ge({id:P(),items:Je(zl),status:qe(["pending","processing","confirmed","failed"]),totalAmount:ue().min(0),processedAt:Qa().optional()}),_l=ge({bankAccounts:_t(P(),wl),bankTransactions:Je(Sl),orders:_t(P(),kl),inventory:_t(P(),ue().min(0)),paymentStatus:qe(["pending","processing","completed","failed"]),migrationStatus:qe(["idle","running","completed","failed"]),migrationProgress:ue().min(0).max(100),migrationError:P().optional(),isProcessing:oe(),lastError:P().optional()});class Al extends he{constructor(){super({name:"transaction-demo-comprehensive",value:{bankAccounts:{checking:{id:"checking",name:"Checking Account",balance:1e3},savings:{id:"savings",name:"Savings Account",balance:5e3}},bankTransactions:[],orders:{},inventory:{laptop:5,mouse:20,keyboard:15},paymentStatus:"pending",migrationStatus:"idle",migrationProgress:0,isProcessing:!1},prep:(n,r)=>{const s=_l.safeParse({...r,...n});if(!s.success)throw new Error(`Invalid state: ${s.error.message}`);return s.data}})}transferFunds(n,r,s){this.$transact({suspendValidation:!0,action:()=>{if(n===r)throw new Error("Cannot transfer to the same account");if(s<=0)throw new Error("Transfer amount must be greater than 0");const i=this.value.bankAccounts[n],o=this.value.bankAccounts[r];if(!i||!o)throw new Error("Invalid account");if(i.balance<s)throw new Error("Insufficient funds");this.mutate(l=>{l.bankAccounts[n].balance-=s}),this.mutate(l=>{l.bankAccounts[r].balance+=s});const a={id:Date.now().toString(),amount:s,description:`Transfer from ${i.name} to ${o.name}`,timestamp:Date.now()};this.mutate(l=>{l.bankTransactions.push(a)})}})}processOrder(n){this.$transact({suspendValidation:!1,action:()=>{const r=`order_${Date.now()}`;this.$transact({suspendValidation:!0,action:()=>{for(const s of n.items){if(this.value.inventory[s.productId]<s.quantity)throw new Error(`Insufficient inventory for ${s.name}`);this.mutate(o=>{o.inventory[s.productId]-=s.quantity})}}}),this.$transact({suspendValidation:!0,action:()=>{this.set("paymentStatus","processing");const s=this.processPayment(n.totalAmount);if(!s.success)throw new Error(`Payment failed: ${s.error}`);this.set("paymentStatus","completed")}}),this.mutate(s=>{s.orders[r]={...n,id:r,status:"confirmed",processedAt:new Date}})}})}processPayment(n){return n<=0?{success:!1,error:"Invalid payment amount"}:Math.random()<.1?{success:!1,error:"Payment gateway error"}:{success:!0}}migrateData(n){try{this.$transact({suspendValidation:!0,action:()=>{this.set("migrationStatus","running"),this.set("migrationProgress",0),this.set("migrationError",void 0);const r=n.steps.length;for(let s=0;s<r;s++){const i=n.steps[s];this.processStep(i);const o=Math.round((s+1)/r*100);this.set("migrationProgress",o)}this.set("migrationStatus","completed")}})}catch(r){throw this.set("migrationStatus","failed"),this.set("migrationError",r.message),r}}processStep(n){if(n.includes("critical")&&Math.random()<.2)throw new Error(`Critical step failed: ${n}`)}batchUpdateInventory(n){this.$transact({suspendValidation:!0,action:()=>{for(const r of n){if(r.quantity<0)throw new Error(`Invalid quantity for ${r.productId}`);this.mutate(s=>{s.inventory[r.productId]=r.quantity})}}})}reset(){this.mutate(n=>{n.bankAccounts={checking:{id:"checking",name:"Checking Account",balance:1e3},savings:{id:"savings",name:"Savings Account",balance:5e3}},n.bankTransactions=[],n.orders={},n.inventory={laptop:5,mouse:20,keyboard:15},n.paymentStatus="pending",n.migrationStatus="idle",n.migrationProgress=0,n.migrationError=void 0,n.isProcessing=!1,n.lastError=void 0})}}const Cl=()=>new Al,xr=()=>{const t=Rt(),[n,r]=ye(Cl),[s,i]=pe.useState("100"),[o,a]=pe.useState("checking"),[l,u]=pe.useState("savings"),h=()=>{if(o===l){t({title:"Invalid Transfer",description:"Cannot transfer to the same account",status:"warning",duration:3e3,isClosable:!0});return}try{r.$.transferFunds(o,l,parseFloat(s)),t({title:"Transfer Successful",description:`Transferred $${s} from ${o} to ${l}`,status:"success",duration:3e3,isClosable:!0})}catch(v){t({title:"Transfer Failed",description:v.message,status:"error",duration:5e3,isClosable:!0})}},z=()=>{try{r.$.performDataMigration(),t({title:"Migration Successful",description:"Data migration completed successfully",status:"success",duration:3e3,isClosable:!0})}catch(v){t({title:"Migration Failed",description:v.message,status:"error",duration:5e3,isClosable:!0})}};return e.jsxs(d,{children:[e.jsxs(X,{columns:{base:1,md:3},spacing:4,mb:6,children:[e.jsxs(St,{children:[e.jsx(wt,{children:"Checking Account"}),e.jsxs(zt,{children:["$",n.bankAccounts.checking.balance.toFixed(2)]}),e.jsx(kt,{children:n.bankAccounts.checking.name})]}),e.jsxs(St,{children:[e.jsx(wt,{children:"Savings Account"}),e.jsxs(zt,{children:["$",n.bankAccounts.savings.balance.toFixed(2)]}),e.jsx(kt,{children:n.bankAccounts.savings.name})]}),e.jsxs(St,{children:[e.jsx(wt,{children:"Total Transactions"}),e.jsx(zt,{children:n.bankTransactions.length}),e.jsx(kt,{children:"Completed transfers"})]})]}),e.jsx(Ne,{mb:6}),e.jsxs(d,{mb:6,children:[e.jsx(c,{fontSize:"md",fontWeight:"semibold",mb:3,children:"Bank Transfer"}),e.jsxs(X,{columns:{base:1,md:4},spacing:3,mb:3,children:[e.jsxs(Ie,{children:[e.jsx(Ze,{fontSize:"sm",children:"From Account"}),e.jsxs(Xt,{value:o,onChange:v=>a(v.target.value),children:[e.jsx("option",{value:"checking",children:"Checking"}),e.jsx("option",{value:"savings",children:"Savings"})]})]}),e.jsxs(Ie,{children:[e.jsx(Ze,{fontSize:"sm",children:"To Account"}),e.jsxs(Xt,{value:l,onChange:v=>u(v.target.value),children:[e.jsx("option",{value:"checking",children:"Checking"}),e.jsx("option",{value:"savings",children:"Savings"})]})]}),e.jsxs(Ie,{children:[e.jsx(Ze,{fontSize:"sm",children:"Amount"}),e.jsx($e,{type:"number",value:s,onChange:v=>i(v.target.value),placeholder:"100"})]}),e.jsx(d,{display:"flex",alignItems:"end",children:e.jsx(O,{colorScheme:"blue",onClick:h,w:"full",isDisabled:o===l||!s||parseFloat(s)<=0,children:"Transfer"})})]}),o===l&&e.jsx(c,{fontSize:"sm",color:"orange.500",mt:2,children:"⚠️ Please select different accounts for transfer"}),s&&parseFloat(s)<=0&&e.jsx(c,{fontSize:"sm",color:"red.500",mt:2,children:"⚠️ Transfer amount must be greater than 0"})]}),e.jsx(Ne,{mb:6}),e.jsxs($,{spacing:4,mb:6,children:[e.jsx(O,{colorScheme:"purple",onClick:z,children:"Run Data Migration"}),e.jsx(O,{colorScheme:"red",variant:"outline",onClick:r.$.reset,children:"Reset Demo"})]}),e.jsx(c,{fontSize:"sm",color:"gray.600",fontStyle:"italic",mb:6,children:"💡 Try transferring more than the available balance to see transaction rollback in action!"}),n.bankTransactions.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Ne,{mt:6,mb:4}),e.jsxs(d,{children:[e.jsx(c,{fontSize:"md",fontWeight:"semibold",mb:3,children:"Transaction History"}),e.jsxs(In,{size:"sm",variant:"simple",children:[e.jsx(Zn,{children:e.jsxs(ae,{children:[e.jsx(ve,{children:"ID"}),e.jsx(ve,{children:"Description"}),e.jsx(ve,{isNumeric:!0,children:"Amount"}),e.jsx(ve,{children:"Time"})]})}),e.jsx(Rn,{children:n.bankTransactions.map(v=>e.jsxs(ae,{children:[e.jsx(k,{children:e.jsxs(w,{colorScheme:"blue",fontSize:"xs",children:["#",v.id.slice(-4)]})}),e.jsx(k,{fontSize:"sm",children:v.description}),e.jsx(k,{isNumeric:!0,children:e.jsxs(c,{color:"green.600",fontWeight:"medium",children:["$",v.amount.toFixed(2)]})}),e.jsx(k,{fontSize:"xs",color:"gray.500",children:new Date(v.timestamp).toLocaleTimeString()})]},v.id))})]})]})]})]})},Fl=()=>(Ht(),e.jsx(ie,{maxW:"container.xl",py:8,children:e.jsxs(x,{spacing:8,align:"stretch",children:[e.jsxs(d,{children:[e.jsx(m,{variant:"page",children:"Transaction System"}),e.jsx(c,{textStyle:"hero",children:"Forestry 4's transaction system provides atomic operations with automatic rollback, optional validation suspension, and nested transaction support for complex business operations. Not only does a transaction ensure complex operations succeed or fail as a unit, it also clamps update notification; subscribers only update after the action completes, so you can do multiple operations inside a transactions function and only output one update to subscribers."})]}),e.jsxs(C,{title:"Core Transaction Concepts",children:[e.jsxs(X,{columns:{base:1,md:2},spacing:6,children:[e.jsxs(d,{children:[e.jsxs(m,{size:"md",mb:3,color:"green.600",children:[e.jsx(Y,{mr:2}),"Atomic Operations"]}),e.jsx(c,{fontSize:"sm",color:"gray.600",mb:3,children:"All operations within a transaction succeed or fail together. No partial updates."}),e.jsxs(se,{spacing:2,fontSize:"sm",children:[e.jsxs(b,{children:[e.jsx(F,{as:Y,color:"green.500"}),"Multiple state changes grouped together"]}),e.jsxs(b,{children:[e.jsx(F,{as:Y,color:"green.500"}),"Automatic rollback on any failure"]}),e.jsxs(b,{children:[e.jsx(F,{as:Y,color:"green.500"}),"Maintains data consistency"]})]})]}),e.jsxs(d,{children:[e.jsxs(m,{size:"md",mb:3,color:"blue.600",children:[e.jsx(tt,{mr:2}),"Validation Suspension"]}),e.jsx(c,{fontSize:"sm",color:"gray.600",mb:3,children:"Temporarily allow invalid intermediate states during complex operations."}),e.jsxs(se,{spacing:2,fontSize:"sm",children:[e.jsxs(b,{children:[e.jsx(F,{as:tt,color:"blue.500"}),"Suspend validation during transaction"]}),e.jsxs(b,{children:[e.jsx(F,{as:tt,color:"blue.500"}),"Final state must still be valid"]}),e.jsxs(b,{children:[e.jsx(F,{as:tt,color:"blue.500"}),"Enables complex multi-step operations"]})]})]})]}),e.jsxs(d,{children:[e.jsxs(m,{size:"md",mb:3,color:"purple.600",children:[e.jsx(ke,{mr:2}),"Nested Transactions"]}),e.jsx(c,{fontSize:"sm",color:"gray.600",mb:3,children:"Transactions can be nested, with inner transactions rolling back to outer transaction boundaries."}),e.jsxs(se,{spacing:2,fontSize:"sm",children:[e.jsxs(b,{children:[e.jsx(F,{as:ke,color:"purple.500"}),"Inner transactions can be caught and handled"]}),e.jsxs(b,{children:[e.jsx(F,{as:ke,color:"purple.500"}),"Outer transaction continues if inner error is caught"]}),e.jsxs(b,{children:[e.jsx(F,{as:ke,color:"purple.500"}),"Uncaught errors bubble up and rollback all levels; use try/catch to interrupt cascading failure"]})]})]})]}),e.jsxs(C,{title:"Live Transaction Demo",children:[e.jsx(c,{color:"gray.600",mb:6,children:"This comprehensive banking demo shows atomic transactions in action. Try different operations to see how transactions ensure data consistency and automatic rollback on failures."}),e.jsx(xr,{})]}),e.jsx(C,{title:"Source Code",children:e.jsx(de,{tabs:[{label:"Demo Component",language:"tsx",snippet:"TransactionDemo-component"},{label:"Store Factory",language:"typescript",snippet:"transactionDemoStoreFactory"},{label:"Unit Tests",language:"typescript",snippet:"transaction-demo-example-tests"}]})}),e.jsx(C,{title:"Transaction API",children:e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsxs(d,{children:[e.jsx(m,{size:"md",mb:3,children:"Basic Transaction Syntax"}),e.jsx(M,{snippetName:"basicTransactionSyntax",folder:"Transactions",language:"typescript"})]}),e.jsxs(d,{children:[e.jsx(m,{size:"md",mb:3,children:"Transaction Parameters"}),e.jsx(d,{p:4,bg:"gray.50",borderRadius:"md",children:e.jsxs(x,{spacing:3,align:"stretch",children:[e.jsxs(G,{title:"suspendValidation: boolean",titleAsCode:!0,language:"typescript",codeTitle:"Validation Suspension Example",snippetName:"suspendValidationExample",snippetFolder:"Transactions",children:["When ",e.jsx(K,{children:"true"}),", validation is suspended during the transaction, allowing temporarily invalid states. Final state must still be valid."]}),e.jsxs(G,{title:"action: (value: DataType) => void",titleAsCode:!0,language:"typescript",codeTitle:"Action Function Example",snippetName:"actionFunctionExample",snippetFolder:"Transactions",children:["The function containing all operations to be executed atomically. Use",e.jsx(K,{children:"this.$"})," to call other actions within the transaction. Actions"," ",e.jsx("i",{children:"cannot be lambdas / arrow functions"})," and must be ",e.jsx("b",{children:"synchronous"}),". Transactional integrity cannot be maintained over async operations, but you can call transactions from inside async functions (as long as the action itself is sync)."]})]})})]}),e.jsxs(d,{children:[e.jsx(m,{size:"md",mb:3,children:"Error Handling & Rollback"}),e.jsx(M,{snippetName:"errorHandlingRollback",folder:"Transactions",language:"typescript"})]})]})}),e.jsx(C,{title:"Best Practices",children:e.jsxs(X,{columns:{base:1,md:2},spacing:6,children:[e.jsx(x,{spacing:4,align:"stretch",children:e.jsxs(d,{children:[e.jsx(m,{size:"sm",color:"green.600",mb:2,children:"✅ Best Practices"}),e.jsxs(se,{spacing:2,fontSize:"sm",children:[e.jsxs(b,{children:[e.jsx(F,{as:Y,color:"green.500"}),"Use transactions for multi-step operations that must succeed or fail together"]}),e.jsxs(b,{children:[e.jsx(F,{as:Y,color:"green.500"}),"Suspend validation when intermediate states may be temporarily invalid"]}),e.jsxs(b,{children:[e.jsx(F,{as:Y,color:"green.500"}),"Handle transaction errors gracefully with try/catch"]})]})]})}),e.jsx(x,{spacing:4,align:"stretch",children:e.jsxs(d,{children:[e.jsx(m,{size:"sm",color:"red.600",mb:2,children:"❌ These won't work"}),e.jsxs(se,{spacing:2,fontSize:"sm",children:[e.jsxs(b,{children:[e.jsx(F,{as:ke,color:"red.500"}),"Don't use transactions for simple single-step operations"]}),e.jsxs(b,{children:[e.jsx(F,{as:ke,color:"red.500"}),"Don't expect suspended transactions to permanently sidestep validation. the suspendValidation only is in effect until the close of the function."]}),e.jsxs(b,{children:[e.jsx(F,{as:ke,color:"red.500"}),"Don't perform async operations inside transaction functions"]}),e.jsxs(b,{children:[e.jsx(F,{as:ke,color:"red.500"}),"action ",e.jsx("b",{children:"must"})," be a function - they are bound to the store instance which does not work for lambdas"]})]})]})})]})}),e.jsx(C,{title:"Troubleshooting",children:e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsxs(d,{children:[e.jsx(m,{size:"md",mb:3,color:"orange.600",children:"Common Issues & Solutions"}),e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsxs(d,{p:4,bg:"orange.50",borderRadius:"md",border:"1px",borderColor:"orange.200",children:[e.jsx(c,{fontWeight:"semibold",color:"orange.800",mb:2,children:'"Transaction failed but state seems unchanged"'}),e.jsx(c,{fontSize:"sm",color:"gray.700",mb:2,children:"This is expected behavior. When a transaction fails, all changes are rolled back automatically."}),e.jsx(M,{snippetName:"transactionErrorCheck",folder:"Transactions",language:"typescript"})]}),e.jsxs(d,{p:4,bg:"red.50",borderRadius:"md",border:"1px",borderColor:"red.200",children:[e.jsx(c,{fontWeight:"semibold",color:"red.800",mb:2,children:'"Validation errors even with suspendValidation: true"'}),e.jsxs(c,{fontSize:"sm",color:"gray.700",mb:2,children:[e.jsx(K,{children:"suspendValidation"})," only suspends validation during the transaction. The final state must still pass all validation rules."]}),e.jsx(M,{snippetName:"validationErrorExample",folder:"Transactions",language:"typescript"})]}),e.jsxs(d,{p:4,bg:"blue.50",borderRadius:"md",border:"1px",borderColor:"blue.200",children:[e.jsx(c,{fontWeight:"semibold",color:"blue.800",mb:2,children:'"Nested transaction behavior is confusing"'}),e.jsx(c,{fontSize:"sm",color:"gray.700",mb:2,children:"Inner transactions can be caught and handled. Only uncaught errors bubble up to outer transactions."}),e.jsx(M,{snippetName:"nestedTransactionExample",folder:"Transactions",language:"typescript"})]})]})]}),e.jsxs(d,{children:[e.jsx(m,{size:"md",mb:3,children:"Debugging Transactions"}),e.jsx(c,{fontSize:"sm",color:"gray.600",mb:3,children:"Use the transaction stack observer to debug complex transaction flows:"}),e.jsx(M,{snippetName:"transactionDebugging",folder:"Transactions",language:"typescript"})]})]})})]})})),Tl=()=>e.jsxs(ie,{maxW:"container.xl",py:8,children:[e.jsxs(m,{size:"xl",mb:4,children:["RxJS Integration",e.jsx(w,{ml:3,colorScheme:"purple",children:"Power Tool"})]}),e.jsx(C,{title:"Leverage RxJS operators and reactive programming patterns with Forestry 4",children:e.jsxs(d,{children:[e.jsxs(c,{mt:4,children:["Every store exposes an rxjs subject. you can observe or ",e.jsx("code",{children:".pipe(...)"}),"a stores' output to throttle it, or conbine or modify store stream(s)."]}),e.jsxs(c,{children:["Stores follow the observable pattern closely; they don't immediately derive from BehaviorSubjects but they do follow the pattern - methods like"," ",e.jsx("code",{children:"next(candidate), complete, subscribe"}),"behave as you would expect for an RxJS Observable."]})]})}),e.jsx(C,{title:"Immer values for consisntly unique values",children:e.jsxs(d,{children:[e.jsxs(c,{fontSize:"lg",children:[e.jsx("a",{href:"https://immerjs.github.io/immer/",children:"Immer"})," enforces immutability and as a side effect unique references in store values"]}),e.jsx(c,{mt:4,children:"Like ReactToolkit, values in states are immutable; this has strong benefits in react ensuring that for instance, every time you add an element to an array or map, its returned as a new array or map every time, triggering updates to dependency lists or components."}),e.jsxs(c,{children:["the ",e.jsx("code",{children:".mutate()"})," method in stores are in fact wrappers for immer providers."]})]})})]}),El=()=>e.jsx(ie,{maxW:"container.xl",py:8,children:e.jsxs(d,{children:[e.jsxs(m,{size:"xl",mb:4,children:["Advanced Patterns",e.jsx(w,{ml:3,colorScheme:"purple",children:"Power Tool"})]}),e.jsx(c,{fontSize:"lg",color:"gray.600",children:"Advanced patterns, debugging techniques, and performance optimization."}),e.jsx(c,{mt:4,color:"gray.500",children:"This page is under construction. Coming soon!"})]})}),$l=()=>e.jsx(d,{children:e.jsxs(Ue,{children:[e.jsx(d,{layerStyle:"sidebar",mt:8,children:e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsx(m,{children:"API"}),e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsxs(d,{children:[e.jsx(c,{fontWeight:"semibold",color:"blue.600",mb:2,children:"Core Classes"}),e.jsx(x,{spacing:1,align:"stretch",pl:2,children:e.jsx(le,{href:"#forest",layerStyle:"navLink",children:"Forest"})})]}),e.jsxs(d,{children:[e.jsx(c,{fontWeight:"semibold",color:"green.600",mb:2,children:"Forest Methods"}),e.jsxs(x,{spacing:1,align:"stretch",pl:2,children:[e.jsx(le,{href:"#forest-constructor",layerStyle:"navLink",children:"Constructor & Properties"}),e.jsx(le,{href:"#forest-core",layerStyle:"navLink",children:"Core"}),e.jsx(le,{href:"#forest-branching",layerStyle:"navLink",children:"Branching"}),e.jsx(le,{href:"#forest-transactions",layerStyle:"navLink",children:"Transaction"}),e.jsx(le,{href:"#forest-validation",layerStyle:"navLink",children:"Validation"})]})]}),e.jsxs(d,{children:[e.jsx(c,{fontWeight:"semibold",color:"orange.600",mb:2,children:"Types"}),e.jsxs(x,{spacing:1,align:"stretch",pl:2,children:[e.jsx(le,{href:"#types-config",layerStyle:"navLink",children:"Configuration Types"}),e.jsx(le,{href:"#types-validation",layerStyle:"navLink",children:"Validation Types"}),e.jsx(le,{href:"#types-utility",layerStyle:"navLink",children:"Utility Types"})]})]})]})]})}),e.jsx(d,{layerStyle:"mainContent",children:e.jsx(ie,{maxW:"container.lg",children:e.jsxs(x,{spacing:12,align:"stretch",children:[e.jsxs(d,{children:[e.jsx(m,{variant:"page",children:"Forest API"}),e.jsx(c,{textStyle:"hero",children:"Complete API documentation for Forest and ForestBranch classes."})]}),e.jsx(C,{title:"Forest class",id:"forest",children:e.jsx(c,{textStyle:"body",children:"The state management class that supports branching and hierarchical state management. Forest includes all core store functionality plus advanced features for managing complex nested data structures. In general you will subclass this class to add custom action / method utility but it can be used directly"})}),e.jsxs(C,{id:"forest-constructor",title:"Construtcor and properties",children:[e.jsx(d,{mb:6,children:e.jsx(G,{title:"new Forest<DataType>(params: StoreParams)",children:"Creates a new Forest instance with the specified data type and actions. In general you will subclass Forest to enable custom methods, but you can instantiate a Forest directly if you only wish to use base methods."})}),e.jsxs(d,{children:[e.jsx(m,{size:"sm",mb:3,children:"Properties"}),e.jsxs(se,{spacing:3,children:[e.jsxs(b,{children:[e.jsx(K,{children:"value: DataType"})," - Current forest value (readonly)"]}),e.jsxs(b,{children:[e.jsx(K,{children:"name: string"})," - Forest identifier"]}),e.jsxs(b,{children:[e.jsx(K,{children:"$: Actions"})," - Exposed ",e.jsx(Q,{to:"/actions'",children:"action"})," methods."]}),e.jsxs(b,{children:[e.jsx(K,{children:"acts: Actions"})," - Alias for $ property"]}),e.jsxs(b,{children:[e.jsx(K,{children:"res: Map<string, any>"})," - container for external resources such as database connectors, DOM references. Changing res entries does not trigger any subscriber updates. Mainly useful for direct Forest instances that need un-storable values (Dom references etc.)"]}),e.jsxs(b,{children:[e.jsx(K,{children:"isActive: boolean"})," - Whether forest accepts updates; set to false when ",e.jsx("code",{children:"complete()"})," is called"]}),e.jsxs(b,{children:[e.jsx(K,{children:"path: Path"})," - the path between this store and its parent; is empty array [] for root Forest"]}),e.jsxs(b,{children:[e.jsx(K,{children:"parent?: StoreBranch"})," - null for root Forest"]}),e.jsxs(b,{children:[e.jsx(K,{children:"isRoot: boolean"})," - whether the branch has a parent or is the root."]}),e.jsxs(b,{children:[e.jsx(K,{children:"root: Forest"})," - Returns self (this) for a root Forest implementation, and topmost forest on a branch"]})]})]})]}),e.jsxs(d,{id:"forest-core",layerStyle:"methodCard",children:[e.jsx(m,{size:"md",mb:4,children:"Core Methods"}),e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsx(G,{title:"next(value: Partial<DataType>): void",snippetName:"nextExample",snippetFolder:"APIReference",codeTitle:"Updating Forest Values",children:"Updates the forest with a new value."}),e.jsx(G,{title:"subscribe(listener: Listener<DataType>): Subscription",snippetName:"subscribeExample",snippetFolder:"APIReference",codeTitle:"Subscribing to Changes",children:"Subscribes to forest changes. Returns RxJS Subscription for cleanup."}),e.jsx(G,{title:"get(path?: Path): any",snippetName:"getPathExample",snippetFolder:"APIReference",codeTitle:"Getting Values by Path",children:"Gets value at specified path. Returns entire value if no path provided."}),e.jsx(G,{title:"set(path: Path, value: unknown): boolean",snippetName:"setValueExample",snippetFolder:"APIReference",codeTitle:"Setting Values Example",children:"Sets value at specified path using Immer for immutable updates. Returns true if successful."}),e.jsx(G,{title:"complete(): DataType",children:"Completes the forest and all branches, preventing further updates. Returns final value. note - branch completions effect only that branch and any sub-branches it spawned; completing the root Forest will terminate the entire forest and all its branches and sub-branches."})]})]}),e.jsxs(d,{id:"forest-branching",layerStyle:"methodCard",children:[e.jsx(m,{size:"md",mb:4,children:"Branching Methods"}),e.jsx(x,{spacing:6,align:"stretch",children:e.jsxs(G,{title:"$branch<Type, Actions>(path: Path, params: StoreParams<Type>): ForestBranch",snippetName:"branchCreationExample",snippetFolder:"APIReference",codeTitle:"Branch Creation Example",children:["Creates a new branch at the specified path with its own actions and validation. The utility of a branch is that it focuses on a subsection of state and can have focused methods that target specific elements of the store.",e.jsx("br",{})," ",e.jsx("br",{}),"The params have an optional parameter ",e.jsx("code",{children:"subclass"})," that defines a class that will be returned by the $branch method. Also, ",e.jsx("code",{children:"value"})," is neither required nor used as a parameter; value is inferred by the path from the parent Forest."]})})]}),e.jsxs(d,{id:"forest-transactions",layerStyle:"methodCard",children:[e.jsxs(m,{size:"md",mb:4,children:["Transaction Methods",e.jsx(Q,{to:"/transactions",style:{marginLeft:"12px"},children:e.jsx(w,{colorScheme:"blue",fontSize:"xs",children:"See detailed guide →"})})]}),e.jsx(x,{spacing:6,align:"stretch",children:e.jsxs(G,{title:"transact(params: TransParams | TransFn, suspendValidation?: boolean): void",snippetName:"transactMethodExamples",snippetFolder:"Transactions",codeTitle:"Transaction Examples",children:["Executes multiple operations as a single atomic transaction across the forest and all branches. All changes within the transaction are applied atomically. It is possible to nest transactions - in which case all subscriptions are suspended until the outermost transactions complete. Any thrown (uncaught) error suspends a transaction and reverts ",e.jsx("i",{children:"all"})," updates made since the beginning of that transaction; in the case of nested transaction, its possible to catch the inner transactions' error in which case the state will be the same as it was before the inner transaction started. ",e.jsx("b",{children:"action must NOT be a lambda/arrow function"}),"."]})})]}),e.jsxs(d,{id:"forest-validation",layerStyle:"methodCard",children:[e.jsxs(m,{size:"md",mb:4,children:["Validation Methods",e.jsx(Q,{to:"/validation",style:{marginLeft:"12px"},children:e.jsx(w,{colorScheme:"green",fontSize:"xs",children:"See detailed guide →"})})]}),e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsx(G,{title:"validate(value: unknown): Validity",snippetName:"validateMethod",snippetFolder:"APIReference",codeTitle:"Validation Examples",children:"Validates a value against schema and tests. Returns validity object with detailed error information. If the current state of the store is under a transaction with suspendValidation, it will always return isValid: true. validate captures any thrown errors from validation functions into the feedback."}),e.jsx(G,{title:"test(value: unknown): Validity",snippetName:"testMethod",snippetFolder:"APIReference",codeTitle:"Test Function Examples",children:"Identical to validate -- however it ignores any transactional / suspendValidation conditions"})]})]}),e.jsxs(d,{children:[e.jsxs($,{mb:4,children:[e.jsx(m,{size:"lg",children:"Type Definitions"}),e.jsx(w,{colorScheme:"orange",children:"Types"})]}),e.jsx(c,{textStyle:"body",children:"Key TypeScript interfaces and types used throughout Forestry 4."})]}),e.jsxs(d,{id:"types-config",layerStyle:"methodCard",children:[e.jsx(m,{size:"md",mb:4,children:"Constructor parameter structure"}),e.jsx(x,{spacing:6,align:"stretch",children:e.jsxs(G,{title:"StoreParams<DataType>",children:["Configuration object for creating Forest instances. Contains:",e.jsxs("ul",{children:[e.jsxs("li",{children:["value ",e.jsx(w,{colorScheme:"red",children:"Required"})," "]}),e.jsx("li",{children:"schema"}),e.jsx("li",{children:"tests"}),e.jsx("li",{children:"prep"}),e.jsx("li",{children:"name"})]})]})})]}),e.jsxs(d,{id:"types-validation",layerStyle:"methodCard",children:[e.jsxs(m,{size:"md",mb:4,children:["Validation Types",e.jsx(Q,{to:"/schemas",style:{marginLeft:"12px"},children:e.jsx(w,{colorScheme:"purple",fontSize:"xs",children:"See Schema guide →"})})]}),e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsx(G,{title:"ValueTestFn<DataType>",children:"Function that tests a value and returns error message or null -- or throws. valid values should return falsy value or not return anything."}),e.jsxs(G,{title:"Validity",children:["Object returned by test and isValid",e.jsxs("ul",{children:[e.jsx("li",{children:"isValid: boolean"}),e.jsx("li",{children:"error?: Error"})]})]}),e.jsx(G,{title:"ValidationResult",children:"String error message or null for valid values."})]})]}),e.jsxs(d,{id:"types-utility",layerStyle:"methodCard",children:[e.jsx(m,{size:"md",mb:4,children:"Utility Types"}),e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsxs(G,{title:"Path",children:["String (",e.jsx("code",{children:"user.id"}),") array (",e.jsx("code",{children:"['user', 'id']"}),") of strings representing object path."]}),e.jsxs(G,{title:"Listener<DataType>",children:["Function that receives store value changes. it can be either a simple one-property function or a structured"," ",e.jsx("a",{href:"https://rxjs.dev/api/index/interface/Observer",children:"Observer"}),"."]}),e.jsx(G,{title:"ResourceMap",children:"Map for storing external resources (DOM, WebGL, etc.)."})]})]})]})})})]})}),Il=()=>{const t=[{title:"Todo App",path:"/examples/todo-app",badge:"Classic example",badgeColor:"green",icon:Y,description:"A fully-featured todo application demonstrating action-based architecture, form handling, and React integration patterns.",features:["Fully dynamic properties","Event Listeners","Reactive feedback from data summary"]},{title:"Shopping Cart",path:"/examples/shopping-cart",badge:"Validation",badgeColor:"purple",icon:Ee,description:"A shopping cart application showcasing Forestry 4's validation system, schema integration, and complex business logic.",features:["Zod Schema Validation","Custom Test Functions","Real-time Validation","Complex State Management"]},{title:"Form Validation",path:"/examples/form-validation",badge:"Form Patterns",badgeColor:"blue",icon:qr,description:"Advanced form validation with field-level validation, cross-field dependencies, and async validation patterns.",features:["Field-Level Validation","Cross-Field Dependencies","Async Validation","Error State Management"]},{title:"Transaction Demo",path:"/examples/transaction-demo",badge:"Atomic mutation",badgeColor:"orange",icon:Gr,description:"Comprehensive transaction system example demonstrating atomic operations, rollback capabilities, and complex state management.",features:["Atomic Operations","Automatic Rollback","Nested Transactions","Performance Optimization"]}];return e.jsx(ie,{maxW:"container.xl",py:8,children:e.jsxs(x,{spacing:8,align:"stretch",children:[e.jsxs(d,{textAlign:"center",children:[e.jsx(m,{variant:"page",children:"Practical Examples"}),e.jsx(c,{fontSize:"lg",color:"gray.600",maxW:"2xl",mx:"auto",children:"Functioning examples demonstrating Forestry 4's capabilities in various scenarios. Each example showcases different aspects of the library with complete, working code."})]}),e.jsx(X,{columns:{base:1,md:2},spacing:6,children:t.map(n=>e.jsx(En,{as:Q,to:n.path,_hover:{transform:"translateY(-2px)",shadow:"lg",textDecoration:"none"},transition:"all 0.2s",cursor:"pointer",children:e.jsx($n,{children:e.jsxs(x,{align:"stretch",spacing:4,children:[e.jsxs($,{justify:"space-between",align:"start",children:[e.jsxs($,{children:[e.jsx(Te,{as:n.icon,color:"forest.500",boxSize:5}),e.jsx(m,{variant:"card",children:n.title})]}),e.jsx(w,{colorScheme:n.badgeColor,variant:"subtle",children:n.badge})]}),e.jsx(c,{color:"gray.600",fontSize:"sm",children:n.description}),e.jsxs(d,{children:[e.jsx(c,{fontSize:"sm",fontWeight:"semibold",mb:2,color:"gray.700",children:"Key Features:"}),e.jsx(x,{align:"stretch",spacing:1,children:n.features.map(r=>e.jsxs($,{spacing:2,children:[e.jsx(Y,{color:"green.500",boxSize:3}),e.jsx(c,{fontSize:"sm",color:"gray.600",children:r})]},r))})]}),e.jsx($,{justify:"flex-end",width:"full",flex:0,children:e.jsx(le,{as:"span",color:"forest.600",fontWeight:"semibold",fontSize:"sm",_hover:{color:"forest.700"},children:e.jsx(O,{colorScheme:"green",size:"lg",children:"View Example"})})})]})})},n.path))}),e.jsx(d,{textAlign:"center",mt:8,children:e.jsx(c,{color:"gray.500",fontSize:"sm",children:"More examples coming soon! Each example includes live demos, complete source code, and detailed explanations of the patterns used."})})]})})},Zl=({title:t,subtitle:n,badge:r,centered:s=!0,maxWidth:i="2xl",children:o})=>{if(!(t||o))return"";const a=typeof r=="string"?r:r?.text,l=typeof r=="object"?r?.colorScheme??"green":"green";return e.jsx(d,{textAlign:s?"center":"left",mb:8,children:e.jsxs(x,{spacing:4,align:s?"center":"flex-start",children:[e.jsx(d,{children:e.jsxs(m,{variant:"page",mb:r?3:0,children:[t??o,a&&e.jsx(w,{ml:3,colorScheme:l,variant:"subtle",children:a})]})}),n&&e.jsx(c,{fontSize:"lg",color:"gray.600",maxW:i,textAlign:s?"center":"left",children:n})]})})};function Rl(t){return Pt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M192 128l128 128-128 128z"},child:[]}]})(t)}function Dl(t){return Pt({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"m7 10 5 5 5-5z"},child:[]}]})(t)}class Pl extends he{constructor(){super({value:{show:!1}})}toggle(){this.mutate(n=>{n.show=!n.show})}}function Ol(){return new Pl}const Tn=({store:t})=>e.jsx(m,{variant:"card",onClick:t.$.toggle,alignSelf:"flex-start",children:e.jsxs($,{gap:"md",children:[e.jsx(c,{size:"lg",children:t.value.show?e.jsx(Dl,{}):e.jsx(Rl,{})}),e.jsx(c,{children:"Architecture Highlights"})]})}),Nl=()=>{const[{show:t},n]=ye(Ol);return e.jsxs(ie,{maxW:"container.xl",py:8,children:[e.jsx(Zl,{children:"Todo App example "}),e.jsxs(x,{layerStyle:"section",spacing:8,children:[e.jsx(d,{textAlign:"center",children:e.jsx(c,{fontSize:"lg",color:"gray.600",maxW:"2xl",children:"The Classic ToDo app with compressed store structure in play."})}),e.jsxs(C,{title:"Live Demo",titleSize:"md",children:[e.jsx(c,{mb:4,color:"gray.600",children:"Try the todo app below. Notice how all interactions are handled through store actions, and the component is purely presentational."}),e.jsx(Bt,{})]}),e.jsx(C,{title:"Implementation",children:e.jsx(de,{tabs:[{label:"Store Structure",language:"typescript",snippet:"createTodoStore"},{label:"Component Usage",language:"tsx",snippet:"TodoApp"}]})}),t?null:e.jsx(Tn,{store:n}),e.jsx(Dr,{in:t,children:e.jsxs(C,{children:[e.jsx(Tn,{store:n}),e.jsx(c,{textStyle:"body",children:"This example demonstrates the ultimate Forestry pattern where the React component is purely declarative JSX with zero business logic."}),e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsxs(d,{children:[e.jsx(m,{variant:"subtle",children:"Pure Component Pattern"}),e.jsx(c,{fontSize:"sm",color:"gray.600",children:"The React component contains no business logic, state management, or event handling code. Everything is delegated to store actions."})]}),e.jsxs(d,{children:[e.jsx(m,{variant:"subtle",children:"Action Categories"}),e.jsxs(se,{spacing:1,fontSize:"sm",children:[e.jsxs(b,{children:[e.jsx("strong",{children:"Data Actions:"})," addTodo, toggleTodo, removeTodo, setFilter, clearCompleted"]}),e.jsxs(b,{children:[e.jsx("strong",{children:"UI Actions:"})," setFilterAll, setFilterActive, setFilterCompleted, handleKeyPress"]}),e.jsxs(b,{children:[e.jsx("strong",{children:"Selector Actions:"})," filteredTodos, completedCount, activeCount, isAddDisabled"]}),e.jsxs(b,{children:[e.jsx("strong",{children:"Factory Actions:"})," createToggleTodo, createRemoveTodo (for parameterized handlers)"]})]})]}),e.jsxs(d,{children:[e.jsx(m,{variant:"subtle",children:"Inline Function Calls"}),e.jsx(c,{fontSize:"sm",color:"gray.600",children:"All computed values and event handlers use direct action references without arrow functions, resulting in cleaner JSX and better performance."})]})]})]})})]})]})},Ml=()=>e.jsx(ie,{maxW:"container.xl",py:8,children:e.jsxs(x,{layerStyle:"section",spacing:8,children:[e.jsxs(d,{textAlign:"center",children:[e.jsxs(m,{size:"xl",mb:4,children:["Shopping Cart Example",e.jsx(w,{ml:3,colorScheme:"purple",children:"Validation Focus"})]}),e.jsx(c,{fontSize:"lg",color:"gray.600",maxW:"2xl",children:"A shopping cart application demonstrating Forestry 4's validation system, schema integration, and complex business logic handling."})]}),e.jsx(mr,{}),e.jsxs(C,{title:"Critical Business Rules",children:[e.jsx(c,{color:"gray.600",children:'This example demonstrates validation for critical business rules that should prevent invalid states from being saved. These are "quantum constraints" and system limits that protect data integrity. Unlike formatting for structure enforced by schema, these are dynamic rules that require code introspection to enforce'}),e.jsxs(Dt,{children:[e.jsxs(b,{children:[e.jsx("strong",{children:"No duplicates"})," - Same product can't appear twice (use quantity instead)"]}),e.jsxs(b,{children:[e.jsx("strong",{children:"No negative quantities"})," - Quantities must be positive integers"]}),e.jsxs(b,{children:[e.jsx("strong",{children:"Stock limits"})," - Cannot exceed available inventory"]}),e.jsxs(b,{children:[e.jsx("strong",{children:"Valid products only"})," - Products must exist in catalog"]}),e.jsxs(b,{children:[e.jsx("strong",{children:"System limits"})," - Maximum 100 total items per cart"]})]})]})]})}),Vl=()=>e.jsxs(ie,{maxW:"container.xl",py:8,children:[e.jsx(m,{variant:"page",children:"Form Validation"}),e.jsx(c,{textStyle:"hero",children:"A comprehensive form validation example demonstrating field-level validation, cross-field dependencies, async validation, and error handling patterns."}),e.jsxs(x,{layerStyle:"section",spacing:8,children:[e.jsxs(C,{title:"Form Demo",layerStyle:"methodCard",w:"full",children:[e.jsx(c,{mb:4,color:"gray.600",children:"Try filling out the form below. Notice how validation provides immediate feedback, handles async operations, and manages complex field dependencies."}),e.jsx(fr,{})]}),e.jsx(C,{title:"Source Code",children:e.jsxs(d,{children:[e.jsx(c,{color:"gray.600",mb:4,children:"Here's how to implement advanced form validation using Forest branches with individual field state management:"}),e.jsx(de,{tabs:[{label:"Form Component",language:"tsx",snippet:"advancedFormComponent",folder:"ValidationSystem"},{label:"Field Branch Component",language:"tsx",snippet:"field-branch-component"},{label:"Branch Configuration",language:"typescript",snippet:"usernameBranchConfig",folder:"ValidationSystem"},{label:"Form State Factory",language:"typescript",snippet:"formStateFactory",folder:"ValidationSystem"}]})]})}),e.jsx(C,{title:"    Features Demonstrated",children:e.jsxs(se,{spacing:2,children:[e.jsxs(b,{children:[e.jsx("strong",{children:"Field-Level Validation:"})," Individual field validation with specific error messages"]}),e.jsxs(b,{children:[e.jsx("strong",{children:"Cross-Field Dependencies:"})," Password confirmation, conditional required fields"]}),e.jsxs(b,{children:[e.jsx("strong",{children:"Async Validation:"})," Username availability, email verification"]}),e.jsxs(b,{children:[e.jsx("strong",{children:"Dynamic Validation Rules:"})," Rules that change based on other field values"]}),e.jsxs(b,{children:[e.jsx("strong",{children:"Error State Management:"})," Field-specific error display and clearing"]}),e.jsxs(b,{children:[e.jsx("strong",{children:"Form Submission Flow:"})," Validation before submission with loading states"]})]})}),e.jsxs(C,{title:"Branched Stores",children:[e.jsx(c,{color:"gray.600",children:"This example showcases Forestry 4's branch system. Each form field is managed by its own branch with independent validation, while the parent forest coordinates overall form state."}),e.jsxs(d,{p:4,bg:"blue.50",borderRadius:"md",children:[e.jsx(c,{fontWeight:"semibold",mb:2,children:"🌿 Branch Benefits:"}),e.jsxs(x,{spacing:1,align:"start",fontSize:"sm",children:[e.jsxs(c,{children:["• ",e.jsx("strong",{children:"Independent validation"})," - Each field has its own validation logic"]}),e.jsxs(c,{children:["• ",e.jsx("strong",{children:"Focused actions"})," - Field-specific actions like setValue()"]}),e.jsxs(c,{children:["• ",e.jsx("strong",{children:"Isolated state"})," - Changes to one field don't affect others"]}),e.jsxs(c,{children:["• ",e.jsx("strong",{children:"Coordinated updates"})," - Parent store sees all field changes"]}),e.jsxs(c,{children:["• ",e.jsx("strong",{children:"Modular design"})," - Easy to add/remove fields without affecting others"]})]})]})]}),e.jsxs(d,{layerStyle:"methodCard",w:"full",children:[e.jsx(m,{size:"md",mb:4,children:"Validation Architecture"}),e.jsxs(je,{status:"info",mb:4,children:[e.jsx(be,{}),"This example demonstrates a multi-layered validation approach with field-level, form-level, and async validation patterns."]}),e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsxs(d,{children:[e.jsx(m,{size:"sm",mb:2,children:"Field-Level Validation"}),e.jsx(c,{fontSize:"sm",color:"gray.600",children:"Each field has its own validation rules that run immediately on change, providing instant feedback to users."})]}),e.jsxs(d,{children:[e.jsx(m,{size:"sm",mb:2,children:"Cross-Field Dependencies"}),e.jsx(c,{fontSize:"sm",color:"gray.600",children:"Some fields depend on others (password confirmation, conditional requirements) and are validated whenever dependent fields change."})]}),e.jsxs(d,{children:[e.jsx(m,{size:"sm",mb:2,children:"Async Validation"}),e.jsx(c,{fontSize:"sm",color:"gray.600",children:"Username and email fields perform server-side validation to check availability and validity, with proper loading states and error handling."})]}),e.jsxs(d,{children:[e.jsx(m,{size:"sm",mb:2,children:"Form-Level Validation"}),e.jsx(c,{fontSize:"sm",color:"gray.600",children:"Overall form validation ensures all fields are valid before allowing submission, with comprehensive error reporting."})]})]})]}),e.jsxs(d,{layerStyle:"methodCard",w:"full",children:[e.jsx(m,{size:"md",mb:4,children:"Validation Schema"}),e.jsx(M,{snippetName:"UserRegistrationSchema",language:"typescript",title:"Form Schema with Complex Rules"})]}),e.jsxs(d,{layerStyle:"methodCard",w:"full",children:[e.jsx(m,{size:"md",mb:4,children:"Store Implementation"}),e.jsx(M,{snippetName:"formValidationStoreFactory",language:"typescript",title:"Form Store with Advanced Validation"})]}),e.jsxs(d,{layerStyle:"methodCard",w:"full",children:[e.jsx(m,{size:"md",mb:4,children:"Form Validation Best Practices"}),e.jsxs(Dt,{children:[e.jsxs(b,{children:[e.jsx("strong",{children:"Immediate Feedback:"})," Validate fields as users type for better UX"]}),e.jsxs(b,{children:[e.jsx("strong",{children:"Progressive Enhancement:"})," Start with basic validation, add async checks"]}),e.jsxs(b,{children:[e.jsx("strong",{children:"Clear Error Messages:"})," Provide specific, actionable error information"]}),e.jsxs(b,{children:[e.jsx("strong",{children:"Loading States:"})," Show progress during async validation and submission"]}),e.jsxs(b,{children:[e.jsx("strong",{children:"Accessibility:"})," Proper ARIA labels and error associations"]}),e.jsxs(b,{children:[e.jsx("strong",{children:"Error Recovery:"})," Allow users to easily correct and retry"]})]})]})]})]}),Ll=()=>e.jsxs(ie,{maxW:"container.xl",py:8,children:[e.jsx(m,{variant:"page",children:" Transaction System Example"}),e.jsxs(x,{layerStyle:"section",spacing:8,children:[e.jsx(c,{fontSize:"lg",color:"gray.600",maxW:"2xl",children:"A comprehensive example demonstrating Forestry 4's transaction system for atomic operations, rollback capabilities, and complex state management scenarios."}),e.jsx(C,{title:"Features Demonstrated",children:e.jsxs(se,{spacing:2,children:[e.jsxs(b,{children:[e.jsx(F,{as:Y,color:"green.500"}),e.jsx("strong",{children:"Atomic Operations:"})," Multi-step operations that succeed or fail as a unit"]}),e.jsxs(b,{children:[e.jsx(F,{as:Y,color:"green.500"}),e.jsx("strong",{children:"Automatic Rollback:"})," State restoration when transactions fail"]}),e.jsxs(b,{children:[e.jsx(F,{as:Y,color:"green.500"}),e.jsx("strong",{children:"Validation Control:"})," Suspend/resume validation during transactions"]}),e.jsxs(b,{children:[e.jsx(F,{as:Y,color:"green.500"}),e.jsx("strong",{children:"Nested Transactions:"})," Complex operations with multiple transaction levels"]}),e.jsxs(b,{children:[e.jsx(F,{as:Y,color:"green.500"}),e.jsx("strong",{children:"Error Handling:"})," Graceful failure handling with detailed error information"]}),e.jsxs(b,{children:[e.jsx(F,{as:Y,color:"green.500"}),e.jsx("strong",{children:"Performance Optimization:"})," Batch operations for better performance"]})]})}),e.jsxs(C,{title:"Live Transaction Demo",children:[e.jsx(c,{color:"gray.600",mb:4,children:"Try the interactive demo below to see transactions in action. Notice how operations are atomic - they either complete successfully or roll back completely."}),e.jsx(xr,{})]}),e.jsxs(C,{title:"Transaction Concepts",children:[e.jsxs(je,{status:"info",mb:4,children:[e.jsx(be,{}),"Transactions ensure data consistency by treating multiple operations as a single, atomic unit that either completes entirely or rolls back completely."]}),e.jsxs(d,{children:[e.jsx(m,{size:"sm",mb:2,children:"Atomicity"}),e.jsx(c,{fontSize:"sm",color:"gray.600",children:"All operations within a transaction succeed together or fail together. No partial updates are left in an inconsistent state."})]}),e.jsxs(d,{children:[e.jsx(m,{size:"sm",mb:2,children:"Rollback Safety"}),e.jsx(c,{fontSize:"sm",color:"gray.600",children:"If any operation fails, the entire transaction is rolled back to the original state before the transaction began."})]}),e.jsxs(d,{children:[e.jsx(m,{size:"sm",mb:2,children:"Validation Control"}),e.jsx(c,{fontSize:"sm",color:"gray.600",children:"Validation can be suspended during transactions to allow intermediate invalid states, then resumed for final validation."})]}),e.jsxs(d,{children:[e.jsx(m,{size:"sm",mb:2,children:"Performance Benefits"}),e.jsx(c,{fontSize:"sm",color:"gray.600",children:"Batch multiple operations together to reduce validation overhead and improve performance for complex state changes."})]})]}),e.jsxs(C,{title:"Source Code",children:[e.jsx(c,{color:"gray.600",mb:4,children:"Here's the complete implementation showing modern Forestry 4.1.x transaction patterns with comprehensive testing:"}),e.jsx(de,{tabs:[{label:"Demo Component",language:"tsx",snippet:"TransactionDemo-component"},{label:"Store Factory",language:"typescript",snippet:"transactionDemoStoreFactory"},{label:"Unit Tests",language:"typescript",snippet:"transaction-demo-example-tests"}]})]}),e.jsxs(d,{layerStyle:"methodCard",w:"full",children:[e.jsx(m,{size:"md",mb:4,children:"Transaction Best Practices"}),e.jsxs(se,{spacing:3,children:[e.jsxs(b,{children:[e.jsx(F,{as:Y,color:"green.500"}),e.jsx("strong",{children:"Use for Multi-Step Operations:"})," Any operation that requires multiple state changes"]}),e.jsxs(b,{children:[e.jsx(F,{as:Y,color:"green.500"}),e.jsx("strong",{children:"Suspend Validation Wisely:"})," Suspend for intermediate states, validate at the end"]}),e.jsxs(b,{children:[e.jsx(F,{as:Y,color:"green.500"}),e.jsx("strong",{children:"Handle Errors Gracefully:"})," Provide meaningful error messages and recovery options"]}),e.jsxs(b,{children:[e.jsx(F,{as:Y,color:"green.500"}),e.jsx("strong",{children:"Keep Transactions Focused:"})," Don't make transactions too large or complex"]}),e.jsxs(b,{children:[e.jsx(F,{as:Y,color:"green.500"}),e.jsx("strong",{children:"Test Rollback Scenarios:"})," Ensure your error handling and rollback logic works"]}),e.jsxs(b,{children:[e.jsx(F,{as:Y,color:"green.500"}),e.jsx("strong",{children:"Use for Performance:"})," Batch operations to reduce validation overhead"]})]})]})]})]});function Wl(){return e.jsxs(d,{minH:"100vh",children:[e.jsx(as,{}),e.jsx(d,{as:"main",pt:"120px",children:e.jsxs(Vr,{children:[e.jsx(re,{path:"/",element:e.jsx(Ic,{})}),e.jsx(re,{path:"/why",element:e.jsx(Mc,{})}),e.jsx(re,{path:"/forest",element:e.jsx(Bc,{})}),e.jsx(re,{path:"/actions",element:e.jsx(Yc,{})}),e.jsx(re,{path:"/react",element:e.jsx(nl,{})}),e.jsx(re,{path:"/validation",element:e.jsx(yl,{})}),e.jsx(re,{path:"/schemas",element:e.jsx(vl,{})}),e.jsx(re,{path:"/transactions",element:e.jsx(Fl,{})}),e.jsx(re,{path:"/rxjs",element:e.jsx(Tl,{})}),e.jsx(re,{path:"/advanced",element:e.jsx(El,{})}),e.jsx(re,{path:"/examples/todo-app",element:e.jsx(Nl,{})}),e.jsx(re,{path:"/examples/shopping-cart",element:e.jsx(Ml,{})}),e.jsx(re,{path:"/examples/form-validation",element:e.jsx(Vl,{})}),e.jsx(re,{path:"/examples/transaction-demo",element:e.jsx(Ll,{})}),e.jsx(re,{path:"/api",element:e.jsx($l,{})}),e.jsx(re,{path:"/examples",element:e.jsx(Il,{})})]})})]})}const Ul=Pr({styles:{global:t=>({body:{bg:t.colorMode==="light"?"tree-light":"gray.800",...t.colorMode==="light"&&{backgroundImage:'url("/img/background-timberline.png")',backgroundRepeat:"repeat-x !important",backgroundAttachment:"scroll",backgroundPosition:"center top",backgroundSize:"80%"}}})},colors:{"tree-light":"hsl(179,80%,89%)",brand:{50:"#e6f7ff",100:"#bae7ff",200:"#91d5ff",300:"#69c0ff",400:"#40a9ff",500:"#1890ff",600:"#096dd9",700:"#0050b3",800:"#003a8c",900:"#002766"},forest:{50:"#f0fff4",100:"#c6f6d5",200:"#9ae6b4",300:"#68d391",400:"#48bb78",500:"#38a169",600:"#2f855a",700:"#276749",800:"#22543d",900:"#1a202c"}},fonts:{heading:`'Urbanist', -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif`,body:`'Poppins', -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif`,mono:"'Fira Sans', 'Monaco', 'Menlo', 'Ubuntu Mono', monospace"},layerStyles:{card:{py:1,px:1,borderRadius:"md",mb:2},highlight:{p:3,borderRadius:"md"},section:{spacing:6,align:"stretch"},infoBox:{p:4,borderRadius:"md"},sidebar:{position:"fixed",left:0,top:0,h:"100vh",w:"280px",bg:"gray.50",borderRight:"1px",borderColor:"gray.200",overflowY:"auto",p:6,zIndex:10},mainContent:{ml:"280px",p:8,maxW:"none"},methodCard:{p:6,borderRadius:"lg",border:"1px",borderColor:"gray.200",mb:6,bg:"white",shadow:"sm"},codeExample:{p:4,bg:"gray.50",borderRadius:"md",border:"1px",borderColor:"gray.200",fontFamily:"mono",fontSize:"sm",overflowX:"auto"},methodSignature:{py:3,borderBottom:"1px solid",borderColor:"red.600",fontFamily:"mono",fontSize:"sm",fontWeight:"semibold",color:"gray.800",display:"block"},navLink:{display:"block",py:2,px:3,borderRadius:"md",fontSize:"sm",color:"gray.700",textDecoration:"none",_hover:{bg:"gray.100",color:"brand.600"}}},textStyles:{body:{color:"gray.600",mb:4},description:{color:"gray.600",fontSize:"sm",mb:3},hero:{fontSize:"xl",color:"gray.600",maxW:"4xl",mx:"auto",mb:3}},components:{Button:{defaultProps:{colorScheme:"brand"}},Code:{baseStyle:{fontSize:"sm",fontFamily:"mono"}},Heading:{baseStyle:{fontWeight:"bold",fontFamily:"heading",lineHeight:"shorter",color:"gray.800"},sizes:{xs:{fontSize:"sm",mb:1,lineHeight:"base"},sm:{fontSize:"md",mb:2,lineHeight:"base"},md:{fontSize:"lg",mb:3,lineHeight:"short"},lg:{fontSize:"xl",mb:4,lineHeight:"short"},xl:{fontSize:"2xl",mb:4,lineHeight:"shorter",fontWeight:"bold"},"2xl":{fontSize:"3xl",mb:6,lineHeight:"shorter",fontWeight:"bold"},"3xl":{fontSize:"4xl",mb:6,lineHeight:"none",fontWeight:"bold"},"4xl":{fontSize:"5xl",mb:8,lineHeight:"none",fontWeight:"bold"}},variants:{section:t=>({...t.theme.components.Heading.sizes.lg,color:"gray.700",fontWeight:"medium"}),card:t=>({...t.theme.components.Heading.sizes.md,color:"gray.800",fontWeight:"semibold"}),page:t=>({...t.theme.components.Heading.sizes["3xl"],color:"gray.900",fontWeight:"bold",textAlign:"center"}),subtle:t=>({...t.theme.components.Heading.sizes.sm,color:"gray.600",fontWeight:"medium"})}}}});Br.createRoot(document.getElementById("root")).render(e.jsx(pe.StrictMode,{children:e.jsx(Or,{theme:Ul,toastOptions:{defaultOptions:{position:"top-right",duration:4e3}},children:e.jsx(Lr,{children:e.jsx(Wl,{})})})}));
