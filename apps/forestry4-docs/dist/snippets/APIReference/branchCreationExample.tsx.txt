// Create a branch for user profile management
const appForest = new Forest({ 
  value: { 
    users: { 
      user1: { name: 'John', email: 'john@example.com' } 
    } 
  } 
})

// Create a branch focused on a specific user
const userBranch = appForest.branch(['users', 'user1'], {
  actions: {
    updateName(value, newName: string) {
      this.next({ ...value, name: newName })
    },
    updateEmail(value, newEmail: string) {
      this.next({ ...value, email: newEmail })
    }
  },
  tests: (user) => {
    if (!user.email.includes('@')) {
      return 'Invalid email format'
    }
    return null
  }
})

// Use the branch
userBranch.$.updateName('Jane')
console.log(appForest.value.users.user1.name) // 'Jane'
