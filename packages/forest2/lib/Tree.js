Object.defineProperty(exports,"__esModule",{value:!0});let Branch_1=require("./Branch");class Tree{constructor(t,o,e){this.forest=t,this.name=o,e&&"initial"in e&&(t=e["initial"],void 0!==t)&&(this.root=new Branch_1.Branch(this,{next:t}),this.top=this.root)}rollback(o,e){if(this.top&&!(this.top.time<o)){let t=this.top;for(;t.prev&&t.prev.time>=o;)t=t.prev;e={time:o,error:e,branch:t},e=(this.offshoots||(this.offshoots=[]),this.offshoots.push(e),t.prev);e?e.next=void 0:(this.root=void 0,this.top=void 0)}}grow(t){t=new Branch_1.Branch(this,t);return this.top?this.top.linkTo(t):(this.top=t,this.root=t),t}get value(){if(this.top)return this.top.value;throw new Error("cannot get the value from an empty tree")}}exports.default=Tree;